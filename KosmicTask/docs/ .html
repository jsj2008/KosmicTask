< html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

  
  
  
  
  
  
    p.p1 {margin: 0.0px 0.0px 15.0px 0.0px; font: 36.0px 'Helvetica Neue'; color: #95b836}
    p.p2 {margin: 0.0px 0.0px 40.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    p.p3 {margin: 0.0px 0.0px 12.0px 0.0px; font: 16.0px 'Helvetica Neue'; color: #95b836}
    p.p4 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    p.p5 {margin: 0.0px 0.0px 12.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #94b736}
    p.p6 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d; min-height: 14.0px}
    p.p7 {margin: 0.0px 0.0px 6.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #95b836}
    p.p8 {margin: 0.0px 0.0px 40.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #95b836}
    p.p9 {margin: 0.0px 0.0px 40.0px 0.0px; font: 16.0px 'Helvetica Neue'; color: #95b836; min-height: 18.0px}
    p.p10 {margin: 0.0px 0.0px 9.0px 0.0px; font: 21.0px 'Helvetica Neue'; color: #95b836}
    p.p12 {margin: 0.0px 0.0px 9.0px 0.0px; font: 16.0px 'Helvetica Neue'; color: #95b836}
    p.p13 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #ff1213}
    p.p14 {margin: 0.0px 0.0px 12.0px 0.0px; font: 21.0px 'Helvetica Neue'; color: #95b836}
    p.p15 {margin: 0.0px 0.0px 12.0px 5.7px; font: 9.0px Monaco; color: #0c59cf}
    p.p16 {margin: 0.0px 0.0px 0.0px 5.7px; font: 9.0px Monaco; color: #0c59cf}
    p.p17 {margin: 0.0px 0.0px 40.0px 5.7px; font: 9.0px Monaco; color: #0c59cf}
    p.p18 {margin: 0.0px 0.0px 40.0px 0.0px; font: 21.0px 'Helvetica Neue'; color: #95b836}
    p.p19 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px Arial; color: #94b736}
    p.p20 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
    p.p21 {margin: 0.0px 0.0px 9.0px 0.0px; text-align: center; font: 14.0px 'Helvetica Neue'}
    p.p22 {margin: 0.0px 0.0px 12.0px 0.0px; text-align: center; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    p.p23 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d; min-height: 15.0px}
    p.p24 {margin: 0.0px 0.0px 40.0px 0.0px; font: 16.0px 'Helvetica Neue'; color: #95b836}
    p.p25 {margin: 0.0px 0.0px 40.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d; min-height: 14.0px}
    p.p27 {margin: 0.0px 0.0px 16.0px 0.0px; font: 21.0px 'Helvetica Neue'; color: #95b836}
    p.p28 {margin: 0.0px 0.0px 9.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #94b736}
    p.p29 {margin: 0.0px 0.0px 12.0px 0.0px; line-height: 21.0px; font: 14.0px 'Helvetica Neue'; color: #202020; min-height: 16.0px}
    p.p30 {margin: 0.0px 0.0px 14.0px 0.0px; line-height: 21.0px; font: 14.0px 'Helvetica Neue'; color: #202020; min-height: 16.0px}
    p.p31 {margin: 0.0px 0.0px 30.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d; min-height: 14.0px}
    p.p32 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #94b736}
    p.p33 {margin: 0.0px 0.0px 30.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    p.p34 {margin: 0.0px 0.0px 12.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #ff1213}
    p.p35 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 21.0px; font: 14.0px 'Helvetica Neue'; color: #1e39f6}
    p.p36 {margin: 0.0px 0.0px 12.0px 0.0px; line-height: 21.0px; font: 14.0px 'Helvetica Neue'; color: #ff1212}
    p.p37 {margin: 0.0px 0.0px 14.0px 0.0px; line-height: 21.0px; font: 14.0px 'Helvetica Neue'; color: #202020}
    p.p38 {margin: 0.0px 0.0px 40.0px 0.0px; line-height: 21.0px; font: 14.0px 'Helvetica Neue'; color: #202020; min-height: 16.0px}
    p.p39 {margin: 0.0px 0.0px 6.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #94b736}
    p.p40 {margin: 0.0px 0.0px 9.0px 0.0px; text-align: right; font: 9.0px 'Helvetica Neue Light'; color: #95b836}
    p.p41 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px 'Helvetica Neue'}
    p.p42 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: right; font: 7.0px 'Helvetica Neue Light'}
    p.p43 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: center; font: 36.0px 'Trebuchet MS'; min-height: 42.0px}
    p.p44 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: center; font: 7.0px 'Helvetica Neue Light'}
    li.li2 {margin: 0.0px 0.0px 40.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    li.li4 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    li.li11 {margin: 0.0px 0.0px 6.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    li.li26 {margin: 0.0px 0.0px 9.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    span.s1 {letter-spacing: 0.0px}
    span.s2 {font: 12.0px 'Helvetica Neue'; letter-spacing: 0.0px color: #4d4d4d}
    span.s3 {font: 16.0px 'Helvetica Neue'; letter-spacing: 0.0px}
    span.s4 {font: 12.0px Arial; letter-spacing: 0.0px color: #94b736}
    span.s5 {font: 12.0px 'Helvetica Neue'; text-decoration: underline ; letter-spacing: 0.0px color: #ff1213}
    span.s6 {letter-spacing: 0.0px color: #4d4d4d}
    span.s7 {text-decoration: underline ; letter-spacing: 0.0px color: #ff1213}
    span.s8 {font: 12.0px 'Helvetica Neue'; text-decoration: underline ; letter-spacing: 0.0px color: #1022a3}
    span.s9 {font: 11.0px 'Helvetica Neue'; letter-spacing: 0.0px}
    span.s10 {text-decoration: underline ; letter-spacing: 0.0px}
    span.s11 {letter-spacing: 0.0px color: #94b736}
    span.s12 {letter-spacing: 0.0px color: #db4918}
    span.s13 {font: 9.0px 'Helvetica Neue'; letter-spacing: 0.0px color: #797979}
    span.s14 {font: 36.0px 'Trebuchet MS'; letter-spacing: 0.0px color: #95b836}
    span.Apple-tab-span {white-space:pre}
    table.t1 {background-color: #ffffff; border-collapse: collapse}
    td.td1 {width: 186.2px; height: 16.0px; background-color: #dbddc4; border-style: solid; border-width: 1.0px 1.0px 0.0px 1.0px; border-color: #929292 #929292 transparent #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td2 {width: 136.2px; height: 16.0px; background-color: #dbddc4; border-style: solid; border-width: 1.0px 1.0px 0.0px 1.0px; border-color: #929292 #929292 transparent #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td3 {width: 236.3px; height: 16.0px; background-color: #dbddc4; border-style: solid; border-width: 1.0px 1.0px 0.0px 1.0px; border-color: #929292 #929292 transparent #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td4 {width: 186.2px; height: 15.0px; border-style: solid; border-width: 0.0px 1.0px 1.0px 1.0px; border-color: transparent #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td5 {width: 136.2px; height: 15.0px; border-style: solid; border-width: 0.0px 1.0px 1.0px 1.0px; border-color: transparent #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td6 {width: 236.3px; height: 15.0px; border-style: solid; border-width: 0.0px 1.0px 1.0px 1.0px; border-color: transparent #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td7 {width: 186.2px; height: 15.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td8 {width: 136.2px; height: 15.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td9 {width: 236.3px; height: 15.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td10 {width: 186.2px; height: 15.0px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td11 {width: 136.2px; height: 15.0px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td12 {width: 236.3px; height: 15.0px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td13 {width: 121.6px; height: 16.0px; background-color: #dbddc4; border-style: solid; border-width: 1.0px 1.0px 0.0px 1.0px; border-color: #929292 #929292 transparent #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td14 {width: 152.8px; height: 16.0px; background-color: #dbddc4; border-style: solid; border-width: 1.0px 1.0px 0.0px 1.0px; border-color: #929292 #929292 transparent #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td15 {width: 153.8px; height: 16.0px; background-color: #dbddc4; border-style: solid; border-width: 1.0px 1.0px 0.0px 1.0px; border-color: #929292 #929292 transparent #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td16 {width: 121.6px; height: 15.0px; border-style: solid; border-width: 0.0px 1.0px 1.0px 1.0px; border-color: transparent #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td17 {width: 152.8px; height: 15.0px; border-style: solid; border-width: 0.0px 1.0px 1.0px 1.0px; border-color: transparent #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td18 {width: 153.8px; height: 15.0px; border-style: solid; border-width: 0.0px 1.0px 1.0px 1.0px; border-color: transparent #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td19 {width: 121.6px; height: 33.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td20 {width: 152.8px; height: 33.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td21 {width: 153.8px; height: 33.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td22 {width: 121.6px; height: 15.0px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td23 {width: 152.8px; height: 15.0px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td24 {width: 153.8px; height: 15.0px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td25 {width: 121.6px; height: 15.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td26 {width: 152.8px; height: 15.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td27 {width: 153.8px; height: 15.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    ol.ol1 {list-style-type: decimal}
  

<body>
<p class="p1">KosmicTask</p>
<p class="p2">The Secure Integrated Scripting Environment for OS X</p>
<p class="p3">Guide</p>
<p class="p4">Updated May 2011</p>
<p class="p4">Copyright Mugginsoft LLP</p>
<p class="p5">Table of Contents</p>
<p class="p6"></p>
<p class="p7">Overview	2</p>
<p class="p7">Quick Introduction and Guides	4</p>
<p class="p7">Introduction	7</p>
<p class="p7">How KosmicTask Works	44</p>
<p class="p8">Getting Started	62</p>
<p class="p9"></p>
<p class="p10">Overview</p>
<p class="p4">KosmicTask is a Secure Integrated Scripting Environment for OS X.</p>
<p class="p4">KosmicTask can create, edit, execute and share script based tasks using a wide range of scripting languages.</p>
<p class="p4">KosmicTask provides the following basic functionality:</p>
<ul>
  <li class="li11">A central repository of script powered tasks.</li>
  <li class="li11">A publishing idiom that allows for public and trusted user access to tasks.</li>
  <li class="li11">A multi-tabbed iTunes like interface.</li>
  <li class="li11">A comprehensive history of task requests and results.</li>
  <li class="li11">Local and remote task editing and configuration.</li>
  <li class="li11">Integrated file transfer capabilities.</li>
  <li class="li11">Flexible representation of task results.</li>
  <li class="li11">Full local and remote search capabilities.</li>
  <li class="li11">Bonjour support for automatic discovery over local networks.</li>
  <li class="li11">Run task server at login functionality.</li>
  <li class="li11">Secure network communication via SSL.</li>
  <li class="li11">Support for task sharing over the Internet.</li>
  <li class="li4">Integrated error console.</li>
</ul>
<p class="p2">KosmicTask is available as a time limited trial. After the trial version expires you will be able to read but not execute any tasks that you have created until a full licence is purchased and installed.</p>
<p class="p12">System Requirements</p>
<ul>
  <li class="li11">Mac OS X 10.6</li>
  <li class="li2">50 MB free hard disk space</li>
</ul>
<p class="p3">Getting Support</p>
<p class="p4">Their are a number of ways to request support for KosmicTask.</p>
<p class="p4">Application. From the application menu select KosmicTask - Feedback and Support...</p>
<p class="p4">Forum. Visit the the support forum at forum.mugginsoft.com</p>
<p class="p13">Website. Visit the support website at www.mugginsoft.com/kosmictask/support</p>
<p class="p4">Email. Send an email request to support@mugginsoft.com</p>
<p class="p14">Quick Introduction and Guides</p>
<p class="p3">Task Based Scripting</p>
<p class="p4">A Task contains a script and a list of the inputs that it requires. When a task is executed the user is queried for the task inputs, the task is executed and the results are returned to the user.</p>
<p class="p2">Tasks may be published, enabling them to be accessed and executed by any other network connected KosmicTask user. In addition, users that are able to authenticate over the network will be able to create, edit and execute tasks on the remote machine.</p>
<p class="p3">Quick Guide to Running Tasks</p>
<p class="p4">To run a task simply select it from the left hand sidebar. Enter any inputs that are required and click either the large green run button or the run button the menu bar. Task results will be displayed in the adjoining pane. To save the task results select File - Save As… from the menu.</p>
<p class="p4">Initially only tasks available to all users will be displayed (this is is the Public task view). To access all tasks on the machine select the User task view above the sidebar.</p>
<p class="p2">To run tasks on another machine simply select the machine name and the required task from the sidebar. To access user tasks on the remote machine you will be asked to authenticate. Enter a valid OS X username and password. By default all exchanges with remote machines are secure.</p>
<p class="p3">Quick Guide to Creating Tasks</p>
<p class="p4">To create a task select the Admin task view and click New on the toolbar.</p>
<p class="p4">Then, in the displayed Edit window:</p>
<ul>
  <li class="li11">Enter task name, script type, group and description in the first pane.</li>
  <li class="li11">If the Task requires inputs click + to add. Enter the input name and select its type.</li>
  <li class="li11">Click Edit button in the toolbar and select a template from the displayed list. Edit the task.</li>
  <li class="li11">Build the task if required (it is optional for some task types).</li>
  <li class="li11">Click the Run button to display the test pane.</li>
  <li class="li11">Run and test the task.</li>
  <li class="li2">Close the Edit window and click Save to save the task.</li>
</ul>
<p class="p3">Quick Usage Guide</p>
<p class="p4">KosmicTask can be used in a wide range of different situations and has features that appeal to various classes of users.</p>
<p class="p4">Home. Use KosmicTask on a single Mac or home network to carry out repetitive administration and automation tasks. Non technical users can easily utilise existing tasks. More technical users will find that there is a wealth of scripts available on the Internet that they can easily adapt to their purpose.</p>
<p class="p4">Business. KosmicTask is an effective tool for sharing business automation tasks with end users. Document processing, file processing and automation based services can all be configured from within the application and shared out to clients on the network.</p>
<p class="p4">Education. KosmicTask provides a great way of introducing students to a wide range of scripting languages. The application comes with a range of both native OS X and embedded scripting languages. Students can develop and test scripts on own machine whilst educators can review and appraise their tasks via the network.</p>
<p class="p4">System Administration. Systems and network administrators will find that the application is a convenient and secure method of providing user scripts and performing script based network maintenance.</p>
<p class="p4">Software Development. Developers can use KosmicTask to quickly prototype code ideas. It is also useful for building and organising a library of executable code samples and snippets.</p>
<p class="p4">Science and Technology. The distributed task model means that the application is ideally suited to data acquisition and processing projects. Tasks can be configured to collect and process data on the remote target before returning the results for further analysis and persistence.</p>
<p class="p14">Introduction</p>
<p class="p4">KosmicTask is a tool for creating and sharing script powered tasks on OS X. </p>
<p class="p4">So what is a task? A task is simply any operation that is required to be carried out repetitively. </p>
<p class="p4">Some simple examples might be:</p>
<ul>
  <li class="li11">Convert a Word document file into HTML.</li>
  <li class="li11">Turn down the volume on a mac playing iTunes in another room.</li>
  <li class="li4">Find out what my router’s IP address is.</li>
</ul>
<p class="p4">Each of these operations can be achieved by issuing commands to OS X.</p>
<p class="p4">A task simply contains a number of such commands. When a task is run KosmicTask prompts the user for any inputs that the task requires. The task then executes its commands and returns any results to the user. </p>
<p class="p4">Simple!</p>
<p class="p2">KosmicTask includes a range of predefined tasks and a wide selection of task templates to get you started. </p>
<p class="p3">Getting Started with Commands</p>
<p class="p4">The simplest way to send commands to your mac is to use the Terminal application. </p>
<p class="p4">So, for example, we can convert a Microsoft Word format document into html by typing the following command into the Terminal:</p>
<p class="p15">textutil -convert html "/Users/Mugginsoft/Documents/My Word Document.doc"</p>
<p class="p4">Executing this command will create an html file called MyWord.html. </p>
<p class="p4">We can automate this operation by saving the above command into a file. Then all we have to do is run the file whenever we want to convert our file. The Terminal application sends commands to the Bash shell by default. The shell accepts the commands and executes them. So the above is an example of a simple Bash script.</p>
<p class="p2">Scripting is an extremely powerful means of controlling your mac and KosmicTask makes it easy to create, organise, execute and share such scripts as tasks.</p>
<p class="p3">Scripting and All That</p>
<p class="p4">The first thing to say about scripting is that it is fun!</p>
<p class="p4">You don’t have to be a programmer to have a go at using KosmicTask to create script powered tasks. There are lots of scripting resources available on the Internet and KosmicTask makes it easy to use an existing script as a starting point.</p>
<p class="p4">Scripts can be very simple, like the one above, or much more complex. OS X also supports a wide range of different scripting languages each of which has different characteristics. KosmicTask also includes a number of additional scripting languages.</p>
<p class="p2">So let’s have a go at creating a task!</p>
<p class="p3">Creating a Task</p>
<p class="p4">The objective of our task is to save an iWork 09 Pages document as HTML. The current version of Pages can export documents as PDF, Word, rich text, plain text and ePub but not as HTML.</p>
<p class="p4">A bit of searching on the Internet reveals that a workable solution is to save the Pages document as a rich text (RTF) file and convert the RTF document to HTML using the textutil OS X command. Now we don't know anything about the textutil command but an Internet search for "textutil" leads us to the Apple manual page for this command. Here we can see what options are available for our command (we can also get to the manual page by typing "man textutil" into the Terminal app).</p>
<p class="p4">We want to convert a file so our basic command looks something like:</p>
<p class="p15">textutil -convert html "/Users/Jonathan/Documents/My Pages document.rtf"</p>
<p class="p4">Note that our file name contains a space. Hence we need to enclose it in quote marks.</p>
<p class="p4">Now that we know what we are doing it's time to create our task:</p>
<ul>
  <li class="li11">First download and install KosmicTask.</li>
  <li class="li11">Open the application and click the Admin button.</li>
  <li class="li4">Click the New button in the toolbar (or menu item File - New Task ⌘N).</li>
</ul>
<p class="p4">A task edit window will open to allow us to define, edit and test our task. </p>
<p class="p4">In general we need to enter at least 4 pieces of information to define our task:</p>
<ul>
  <li class="li11">A Name. "Convert My Text File" sounds good to me.</li>
  <li class="li11">A Script type. In this case we want to select Bash shell.</li>
  <li class="li11">A Group to put our task in. I chose "My File Utilities".</li>
  <li class="li4">A Short Description. Something like "Convert a text file to HTML".</li>
</ul>
<p class="p2">That's it. Time to enter our script.</p>
<p class="p3">Editing the Task Script</p>
<p class="p4">To edit the script for our task click the Edit button in the toolbar. A list of script templates will be displayed.</p>
<p class="p4">KosmicTask includes templates for a wide range of scripting languages. These templates serve as starting points for basic task activities. Because we previously selected Bash shell as our script type we are presented with a list of suitable Bash templates. The simplest of these is called Hello Kosmos. Select it and click OK.</p>
<p class="p4">The selected template contains some comments at the top and a single command which says:</p>
<p class="p15"># send result to stdout
echo "Hello, kosmos!"</p>
<p class="p4">Note: Every line that starts with a # is a comment and won't be interpreted as a command.</p>
<p class="p4">Delete these two lines and replace them with our command like so:</p>
<p class="p15"># convert file to html
textutil -convert html "/Users/Jonathan/Documents/My Pages document.rtf"</p>
<p class="p4">Now, your username probably won't be Jonathan so edit this to replace Jonathan with your username. It will normally be displayed in the top right hand corner of your screen. Alternatively you can open up the finder and navigate to your Documents folder. The Path Bar at the bottom will show the full path to your Documents folder.</p>
<p class="p4">So now our script should look like:</p>
<p class="p15"># convert file to html
textutil -convert html "/Users/&lt; MY USERNAME HERE ! &gt;/Documents/My Pages document.rtf"</p>
<p class="p2">That's it. Our script is ready to go!</p>
<p class="p3">Testing Our Task</p>
<p class="p4">To test out our new task click the square Run button.</p>
<p class="p4">Now our task expects to find a file named "My Pages document.rtf" in our Documents folder. So let's create one (if you don't have Pages installed either download the iWork trial or see below).</p>
<ol class="ol1">
  <li class="li4">Open Pages and create a new document.</li>
  <li class="li4">Type "I once was a Pages document!".</li>
  <li class="li4">Select the text and change the font size to 24 and the colour to green (I chose the Fern crayon).</li>
  <li class="li4">Save the document to your Documents folder as "My Pages Document".</li>
  <li class="li4">Select menu File - Export and export as RTF to your Documents folder.</li>
</ol>
<p class="p4">To run the task click the Play button in the toolbar or the large blue Play icon. </p>
<p class="p4">If you see something like the following then the task cannot find the required file:</p>
<p class="p15">STDERR output:
Error reading /Users/Jonathan/Documents/My Pages Document.rtf. The file doesn’t exist.</p>
<p class="p4">If the above occurs use the Finder to verify that the file is named correctly and is in the Documents folder. Then try and run the task again.</p>
<p class="p4">If you don't get an error message but simply a blank result in the right hand panel then the task succeeded. Open the Finder and navigate to you Documents folder. Double click on "My Pages document.html" to open the file in your browser.</p>
<p class="p2">Okay, our task works so we better save it. Select menu File - Save ⌘S.</p>
<p class="p3">Improving Our Task </p>
<p class="p4">So we have achieved our basic goal but things are not as good as they could be. For instance it would be a lot better if a successful task execution produced a better output than a blank screen.</p>
<p class="p4">So we will edit our task script to display a message when the task succeeds. Click the Edit button to go back to the edit view and change our script to read:</p>
<p class="p15"># convert file to html
textutil -convert html "/Users/Jonathan/Documents/My Pages Document.rtf"
echo "HTML file saved to Documents folder"</p>
<p class="p4">Remember, change Jonathan to your username in the above example!</p>
<p class="p4">Our improvement is to simply to print a helpful message. To do this we use the bash "echo" command. By Default KosmicTask returns all a task's printed output as part of the task results. So to return text to the user, in any of the supported scripting languages, all we do is print the text to the screen (or to be precise, send the text to stdout).</p>
<p class="p4">Now run the task again. Instead of a blank screen we now get a message informing us that the converted file is available in our Documents folder. This is definitely an improvement.</p>
<p class="p2">However there are still some problems. Notable amongst these are that we are only able to convert a single named file within our Documents folder. It would be much better if we could specify which file we wanted to convert when the file was run. That way we can use our task to convert any RTF file to HTML. This will be our next improvement.</p>
<p class="p3">Defining a Task Input</p>
<p class="p4">To define a task input first click the Task button to display the task input view. Then click the + button labelled Task Inputs. A new task input pane will appear.</p>
<p class="p4">A task can accept a number of inputs of various types. When the task is run the inputs' values are passed to the task and can be accessed by the task script. The input types that are supported include Text, Numbers, List items, Dates and File Contents.</p>
<p class="p4">To create an input we need to define at least two or three things:</p>
<ul>
  <li class="li11">A Name. I chose "Text file".</li>
  <li class="li11">An input Type. In this case we want to select File Contents.</li>
  <li class="li4">A Description. Something like "Text file to be converted" will do.</li>
</ul>
<p class="p4">That's it for the input. Now we need to adjust the task script so click the Edit button and change the script to the following:</p>
<p class="p15"># convert file to html
textutil -convert html "$1"
echo "HTML file saved to Documents folder"</p>
<p class="p4">Now enter the Run edit view again. Note that this time the left panel contains a file input panel. Click the Select button and choose our test RTF file again. Now when the task is run whatever RTF file we select gets converted to HTML.</p>
<p class="p4">We have modified our script to convert a file called $1. When a bash script is run it can can accept a list of N inputs which are numbered $1 to $N. KosmicTask takes our input file name and passes it into the script as $1. All of the scripting languages supported by KosmicTask can accept task inputs. Each of them accesses arguments in their own way but the principle is always the same.</p>
<p class="p2">Now we can convert RTF files of any type to HTML. This is apparently another improvement. However, there is a problem! If we delete the existing converted HTML file from our Documents folder and run the task we will find that even though the task succeeds the converted file does not appear. In order to understand why we need to think a bit more about how KosmicTask handles files as inputs and results.</p>
<p class="p3">Handling Files</p>
<p class="p4">As well as creating and running tasks KosmicTask allows us to share tasks. This means that we can allow other KosmicTask users to run tasks that we have created. This is a powerful idea. The task that I create to convert Pages documents to HTML can now be used by any other KosmicTask user on the local network to convert their Pages documents to HTML too.</p>
<p class="p4">So lets say that Barbara wants to convert a file using a task on Alice's computer. The contents of the file will obviously have to be sent to Alice's computer where they can be converted by Alice's task. There is no point just leaving the converted file on Alice's computer where Barbara cannot access it so Alice needs to return the converted file to Barbara. Barbara can then save the converted file on her own computer. The way that KosmicTask handles files has been designed to keep both Alice and Barbara happy.</p>
<p class="p4">When we created our task input recall that the input was called File Contents. Even when we are just running a task that exists on our local computer this input sends the contents of the file, not its path, to the task. When the task receives the file contents it saves them temporarily and passes that temporary path into the script. We can demonstrate this by modifying our task script like so:</p>
<p class="p15"># convert file to html
textutil -convert html "$1"
echo "file path = $1"</p>
<p class="p4">If we run the task with this script we should see something like:</p>
<p class="p15">file path = /Users/Jonathan/Library/Caches/com.mugginsoft.kosmictaskserver.files/xX4cVMVdKa-KosmicTempFile-.My Pages Document.rtf</p>
<p class="p4">This reveals where our temporary copy of our input file is stored. This happens regardless of wether the input file already exists on the local computer or has been sent from another machine on the local network. It also explains why we don't see our converted file appearing in our Documents folder. By default the textutil command creates the converted file in the same folder as the input file. This is not what we want. What we want is to return the converted file to the task user. KosmicTask makes this easy.</p>
<p class="p4">To return the converted file as a task result we modify the task script like so:</p>
<p class="p16"># convert file to html
textutil -convert html -output result.html "$1"</p>
<p class="p15">echo "---"
echo "{KosmicFile: result.html}"</p>
<p class="p4">See the next section for an explanation of how this works. Note that we have an extra option to the textutil command to save our converted file as result.html.</p>
<p class="p2">Now when we run the task and select our RTF document the task result consists of an HTML file icon. Double clicking the icon will display a preview of the file content. The file can be saved by selecting menu File - Save "result.html" As...</p>
<p class="p3">KosmicTask Result Handling</p>
<p class="p4">Many tasks can return results simply by printing (or echo'ing in the case of out example). If the required result is simply a piece of text or a number then nothing further is required. In order to handle more complex results such as files and lists of objects KosmicTask uses a standard syntax to identify the structure of the result. The syntax used is called YAML and is easy for a task to generate and for you to read. You can read a lot more about result handling in the KosmicTask Guide.</p>
<p class="p4">In order to return a structured result we simply need to print the the structure using our YAML syntax and make use of a number of keywords.</p>
<p class="p4">When returning a structured result in this way we first print the YAML document marker:</p>
<p class="p15">echo "---"</p>
<p class="p4">This identifies the result as a structured result and KosmicTask will attempt to interpret the result so. If there is an error anywhere in the printed result then KosmicTask will simply return the result string and will not attempt to decode it further.</p>
<p class="p4">Next we make use of the KosmicFile keyword. This informs KosmicTask that the value associated with the keyword is a file to be returned as part of the task result.</p>
<p class="p15">echo "{KosmicFile: result.html}"</p>
<p class="p2">The curly braces are YAML syntax for associating a value with a key. When KosmicTask scans such a result it notes the presence of the KosmicFile key and returns the contents of the indicated file as part of the task result.</p>
<p class="p3">Result File Handling</p>
<p class="p4">In our example we simply chose result.html as our file name and you might think, well, what happens if this file already exists? In this case KosmicTask has created a temporary, initially empty, working directory for us so we can confidently create new files without worrying about old files.</p>
<p class="p4">Another question might be, well if I share my task over the network and everyone starts using it won't I soon accumulate lots of copies of their converted files? The answer is no. When a task completes KosmicTask deletes all the files that were created in the tasks working directory. All other files created by a task in other directories remain untouched.</p>
<p class="p4">In fact the different scripting languages supported by KosmicTask handle the temporary files created by tasks in different ways depending on their requirements. The same principal applies that if the file is created in the recommended manner it will be automatically deleted when the task completes.</p>
<p class="p2">For any particular scripting language the best way to find out how to create task result files is to open the Resource Browser (menu Window - Resource Browser). Each language defines a File template that demonstrates how to correctly create result files. In addition you can refer to the usage document that is included in the browser for each scripting language (select the Documents item for your scripting language with the Resource Browser left hand pane). </p>
<p class="p3">Improving Our Task - Part 2</p>
<p class="p4">Now our task is genuinely useful. We can convert a selected RTF file into HTML and we can even share our task over the network. However we still have to launch Pages, open our Pages document, export our document as RTF and then convert it using KosmicTask. It would certainly be better if our task could achieve all this too.</p>
<p class="p4">Many applications on OS X are scriptable. This means that our task can send a scriptable application specific commands and queries. Using this approach we can construct a task that talks to Pages and converts our file as required.</p>
<p class="p4">Not all applications are scriptable however. A simple way to determine if an application can be automated in this way is to search the Internet for examples. A more exact way is to open the AppleScript Editor application and choose menu File - Open Dictionary... to display a browsable list of scriptable applications. Each scriptable application maintains a dictionary of the commands that it responds to. If your target application appears in the displayed list then you can automate it. Pages does provide a command dictionary (or terminology as it is commonly known) and selecting it in the browser displays a list of all the commands that it accepts.</p>
<p class="p2">Now all we have to do is figure out how to make Pages dance.</p>
<p class="p3">Automation Basics</p>
<p class="p4">There are number of ways that we can follow to automate Pages. Unfortunately none of them involve using a bash script! This means that we will have to adopt another scripting language in order to further enhance our script. This is a common occurrence when writing tasks. However, KosmicTask supports a wide range of scripting languages and this makes it easy to rework a task. In this case we will rework our task as an AppleScript powered task.</p>
<p class="p4">AppleScript is an OS X scripting language that is ideally suited for automating applications. The commands sent to our application are composed of discrete packets of information known as AppleEvents and AppleScript is one of the most popular ways of generating and sending these events. Note that there other ways of automating applications and we will explore these later.</p>
<p class="p2">Rather than modifying our original bash task lets work on a copy. So close the edit window and save our task when prompted. In the main application window make sure our conversion task is selected and click the Duplicate button in the toolbar.</p>
<p class="p3">Moving from Bash to AppleScript</p>
<p class="p4">The first thing we need to do is to rework our bash script into AppleScript. The easiest way to accomplish this is to use one of the existing AppleScript templates. Select the script edit view and click the Template button in the toolbar. In the left hand resource browser select AppleScript - Application - Templates to display all the available AppleScript templates. Select the File template. Our bash script will be replaced and our script type changed to AppleScript.</p>
<p class="p4">One notable difference between our bash script and AppleScript is that our AppleScript task will have to be built before we run it. Click the Build button in the toolbar. If there are any errors in the script you will have to fix them before the task can be run. For some supported scripting languages there is no build stage, for others it is optional and for some required.</p>
<p class="p4">The default AppleScript File template we have selected looks something like this:</p>
<p class="p15">on KosmicTask()
  try
    -- get a result file object from KosmicTask.
    -- the file will be automatically deleted when the task ends.
    tell application "KosmicTask"
      set resultFile to result file with name "capture.png"
    end tell

    -- the shell script below will expect a POSIX path
    set picPosixPath to POSIX path of file resultFile

    -- do screen capture via shell
    do shell script "screencapture -t png " &amp; quoted form of picPosixPath

    -- return file contents and message
    return {kosmicFile:resultFile, kosmicInfo:"file returned"}
  on error errorMessage number errorNumber
    return {kosmicError:errorMessage}
  end try
end KosmicTask</p>
<p class="p4">This script doesn't convert a file (it takes a screenshot instead) but it does execute an external command and it does return a file so it should serve as a good starting point for our conversion task. There are some things to note though before we proceed:</p>
<p class="p4">Firstly the way we create a temporary result file is completely different.</p>
<p class="p15">  -- get a result file object from KosmicTask.
  -- the file will be automatically deleted when the task ends.
  tell application "KosmicTask"
    set resultFile to result file with name "capture.png"
  end tell</p>
<p class="p4">In this case we ask the KosmicTask application itself to create a file object us for us. KosmicTask will delete this file as we require when our task exists.</p>
<p class="p4">Secondly the script makes use of some additional result keywords to send additional information back to the user. So if an error occurs we use the KosmicError keyword to return an error message:</p>
<p class="p17">  on error errorMessage number errorNumber
    return {kosmicError:errorMessage}
  end try</p>
<p class="p3">A First AppleScript Task</p>
<p class="p4">Now that we have our template in place we can modify it to re-implement our RTF to HTML file conversion task.</p>
<p class="p16">on KosmicTask(filePath)
  try</p>
<p class="p15">
    -- get a result file object from KosmicTask.
    -- the file will be automatically deleted when the task ends.
    tell application "KosmicTask"
      set resultFile to result file with name "result.html"
    end tell

    -- the shell script below will expect a POSIX path
    set posixPath to POSIX path of file resultFile

    -- build our command
    set command to "textutil -convert html -output " &amp; quoted form of posixPath
    set command to command &amp; " " &amp; quoted form of filePath

    -- do command via shell
    do shell script command

    -- return file contents and message
    return {kosmicFile:resultFile, kosmicInfo:"file returned"}

  on error errorMessage number errorNumber
    return {kosmicError:errorMessage}
  end try
end KosmicTask</p>
<p class="p4">This task behaves just like its bash based predecessor.</p>
<p class="p4">The main point to note is that our task is implemented as a function called KosmicTask and that this function takes a single argument which is the path to our input file. Many of the supported scripting languages support the use of functions in this way while others (usually those derived from command line interfaces) do not.</p>
<p class="p4">As ever, the Usage document that can be accessed in the Resource Browser is a good place to find out how various features are implemented in each of the supported languages.</p>
<p class="p2">Now that we have our task implemented in AppleScript we can move on to automating Pages itself.</p>
<p class="p3">Automating Pages</p>
<p class="p4">So we know that Pages is scriptable and we can view its dictionary of commands in the AppleScript Editor dictionary browser. We want to export our document so we search the dictionary for "export" and find nothing. This might lead us to conclude that Pages does not allow us to automate the exporting of documents. However, the first rule of everything is don't give up just yet.</p>
<p class="p4">The sorry truth is that the scripting dictionaries for many applications, even major ones like Pages, often lack the sort of informational detail that we really require. This can make them difficult to interpret. Anyhow, we are not alone and search the Internet for "iwork pages applescript export". In this case insight comes from a posting at macscripter.net (which is a good source of user submitted AppleScript solutions). The insight is that the export functionality we seek is actually implemented by the application save command rather than an explicit export command.</p>
<p class="p4">Armed with this insight we are able, after some experimentation, to produce the following function script:</p>
<p class="p16">on KosmicTask(pagesDocFilePath)
  try
    -- we need a path to save our RTF document file into.
    -- the easy way is simply to append .rtf to our existing file path
    set rtfDocFilePath to pagesDocFilePath &amp; ".rtf"

    -- save our pages document as RTF
    tell application "Pages"
      set my doc to open pagesDocFilePath
      save myDoc as "SLDocumentTypeRichText" in rtfDocFilePath
      close myDoc saving no
    end tell</p>
<p class="p15">
    -- get a result file object from KosmicTask.
    -- the file will be automatically deleted when the task ends.
    tell application "KosmicTask"
      set resultFile to result file with name "result.html"
    end tell

    -- the shell script below will expect a POSIX path
    set posixPath to POSIX path of file resultFile

    -- build our command
    set command to "textutil -convert html -output " &amp; quoted form of posixPath
    set command to command &amp; " " &amp; quoted form of rtfDocFilePath

    -- do command via shell
    do shell script command

    -- return file contents and message
    return {kosmicFile:resultFile, kosmicInfo:"file returned"}

  on error errorMessage number errorNumber
    return {kosmicError:errorMessage}
  end try
end KosmicTask</p>
<p class="p4">The major change is telling Pages to open our document and save it as Rich Text. After that our script is pretty much as it was before.</p>
<p class="p15">  -- save our pages document as RTF
  tell application "Pages"
    set myDoc to open pagesDocFilePath
    save myDoc as "SLDocumentTypeRichText" in rtfDocFilePath
    close myDoc saving no
  end tell</p>
<p class="p4">That's our task complete. If we build and run the task we can successfully convert any Pages document to HTML. Furthermore we can share this task over the network and let other users convert their Pages documents too.</p>
<p class="p2">The only real problem that we might have with this task is the AppleScript language itself. AppleScript makes simple automation tasks relatively easy to accomplish but the syntax is entirely idiosyncratic and often non intuitive. The language is also rather dated and unsupported on other platforms. Indeed, programmers often used AppleScript despite its obvious deficiencies simple because it was the only way to achieve certain sorts of automation. Thankfully there are now other powerful ways of automating applications on the mac. So let's rework our task again, this time in something a lot more popular and contemporary, Ruby.</p>
<p class="p3">Automation with Ruby</p>
<p class="p4">OS X automation is achieved by sending AppleEvents to an application. A combination of technologies now makes application automation possible from a wide range of scripting languages (you can read more about these technologies - Cocoa bridging and the ScriptingBridge - in the KosmicTask guide).</p>
<p class="p4">Ruby is a modern object orientated language that can also be used to power automation tasks. The KosmicTask Resource Browser contains a Ruby template, the File template, that demonstrates the basics of returning a file from a Ruby Task. Another Ruby template, the Automate app with Scripting Bridge template, demonstrates how to connect to an application in order to automate it. By combining these two templates we can quickly replicate our AppleScript powered Pages task as a Ruby powered task.</p>
<p class="p15">require 'osx/cocoa'
include OSX
OSX.require_framework 'ScriptingBridge'

# get application reference - see the Ruby Usage document for more info
app = OSX::SBApplication.applicationWithBundleIdentifier_("com.apple.iWork.pages")
pagesDocFilePath = ARGV[0]
rtfDocFilePath = pagesDocFilePath + ".rtf"

# open pages
myDoc = app.open_(pagesDocFilePath)

# save document
myDoc.saveAs_in_("SLDocumentTypeRichText", rtfDocFilePath)

# close document
myDoc.closeSaving_savingIn(false, nil)

# define our result file
resultFile = "result.html"

# convert our file
system "textutil -convert html -output \"#{resultFile}\" \"#{rtfDocFilePath}\""

# return our result file
puts "---"
puts "{kosmicFile: #{resultFile}, kosmicInfo: file returned}"</p>
<p class="p4">There are quite a few details here that are worth noting.</p>
<p class="p6"></p>
<p class="p4">First we require the Cocoa, OS X and ScriptingBridge components to be loaded. This is essential.</p>
<p class="p4">Secondly we connect to the application we wish to automate by using its bundle identifier, which is written in reverse-DNS notation (aka a back to front URL). </p>
<p class="p4">Thirdly we communicate with our target application using standard Ruby syntax to call the required methods. The method names used are obviously derived from their AppleScript equivalents.</p>
<p class="p2">Apart from that its easy to see the correspondence between the AppleScript version and the Ruby implementation.</p>
<p class="p3">Automation with Python</p>
<p class="p4">Now that we have seen that automation is possible from Ruby there is going to be no stopping us.</p>
<p class="p4">The following example implements our Pages task in Python. The approach is exactly the same as in the Ruby implementation.</p>
<p class="p15">import ScriptingBridge
import os
import sys

# get application - for more information see the Python Usage document
app = ScriptingBridge.SBApplication.applicationWithBundleIdentifier_("com.apple.iWork.pages")

pagesDocFilePath = sys.argv[1]
rtfDocFilePath = pagesDocFilePath + ".rtf"

# open pages
myDoc = app.open_(pagesDocFilePath)

# save document
myDoc.saveAs_in_("SLDocumentTypeRichText", rtfDocFilePath)

# close document
myDoc.closeSaving_savingIn_(False, None)

# define our result file
resultFile = "result.html"

# convert our file
command = "textutil -convert html -output \"%s\" \"%s\"" % (resultFile, rtfDocFilePath)
os.system(command)

# return a YAML inline format dictionary with filename
print "--- {kosmicFile: %s, kosmicInfo: file returned}" % resultFile</p>
<p class="p4">This Python implementation performs just like all our other versions.</p>
<p class="p2">Again, note that we explicitly import the ScriptingBridge.</p>
<p class="p3">Automation with JavaScript Cocoa</p>
<p class="p4">The Ruby and Python examples above make it clear that the ScriptingBridge framework is critical in allowing us to create a connection to the application that we wish to automate. What is less clear is the importance of the Cocoa bridge.</p>
<p class="p4">The Cocoa bridge enables out scripts to communicate with the OS X Cocoa framework and its essential objects and methods. Indeed, it is only because the Cocoa bridge exists that we can get to the scripting bridge object, SBApplication, in the first place.</p>
<p class="p4">This connection to the Cocoa bridge and what it entails becomes a bit clearer if we consider JavaScript. KosmicTask includes support for two variants of JavaScript, namely JavaScript itself and JavaScript Cocoa.</p>
<p class="p4">The first variant, JavaScript, supports just the range of functionality that we would expect of the language. If we look at the list of available JavaScript templates in the Resource Browser we see that the selection is quite restrictive. We cannot return files as results, we cannot automate other applications and we cannot import other frameworks.</p>
<p class="p4">The second variant, JavaScript Cocoa, is a Cocoa bridged version of JavaScript that greatly extends the capabilities of the language. With the bridge in place JavaScript powered tasks can now access all the capabilities of the Cocoa framework including access to the ScriptingBridge.</p>
<p class="p4">So here is a JavaScript Cocoa implementation of our Pages task. As usual it behaves just like all our previous examples of this task.</p>
<p class="p16">// load the ScriptingBridge framework
loadFramework("ScriptingBridge")
</p>
<p class="p15">function kosmicTask(pagesDocFilePath)
{
  // use the ScriptingBridge framework to access the application
  var app = SBApplication.applicationWithBundleIdentifier('com.apple.iWork.pages')

  // rtf file path
  var rtfDocFilePath = pagesDocFilePath + ".rtf"

  // open pages
  var myDoc = app.open(pagesDocFilePath)

  // save document
  myDoc.saveAs_in("SLDocumentTypeRichText", rtfDocFilePath)

  // save document
  myDoc.closeSaving_savingIn(false, null)

  // form our file result path
   // this file will be automatically deleted when the task ends.
  var resultFile = KosmicTaskController.resultFileWithName('result.html')

  // run external task using a Cocoa NSTask object !
  var args = ['-convert', 'html', '-output', resultFile, rtfDocFilePath]
  var task = NSTask.launchedTaskWithLaunchPath_arguments('/usr/bin/textutil', args)
  task.waitUntilExit;

  // form result dictionary 
  return {kosmicFile: resultFile};
}</p>
<p class="p4">Note that the Cocoa bridge code has added a function, loadFramework(), that allows us to load in the ScriptingBridge framework that we need to get our automation object reference.</p>
<p class="p4">Another standout feature is the use of NSTask, a Cocoa class, to run our external command. Native JavaScript, unlike all our previous examples, provides no way of initiating an external task (mainly to prevent malicious Internet browser scripts from wreaking havoc) . This example demonstrates clearly how a Cocoa bridge can enhance a language's overall functionality and usefulness.</p>
<p class="p2">An additional detail is the use of the KosmicTaskController object to retrieve a result file path. This utility object is automatically made available to all JavaScript Cocoa tasks. In fact KosmicTask makes a KosmicTaskController object available for many of the languages that it supports. This provides a simple way for KosmicTask to expose utility and support functions to the task. See the usage documents in the Resource Browser for further details</p>
<p class="p3">Automation with Lua Cocoa</p>
<p class="p4">All of the previous examples were coded in scripting languages that ship as part of OS X. KosmicTask uses a plug-in architecture to implement its language support enabling it to encompass a wide range of different language types and configurations. In the case of those languages that are included as part of OS X the KosmicTask language plugin merely exposes the underlying language to the application. But KosmicTask also supports scripting in languages that come embedded in the language plug-in itself.</p>
<p class="p4">Lua is a powerful, fast, lightweight scripting language. As in the case of JavaScript KosmicTask includes support for two variants of Lua. In both of these cases language support is embedded in the relevant plug-in.</p>
<p class="p4">The first variant, Lua, supports all the features of standard Lua and KosmicTask includes a standard range of useful templates.</p>
<p class="p4">The second variant, LuaCocoa, is a Cocoa bridge. Hence we should be able to rework our Pages task in Lua. </p>
<p class="p15">LuaCocoa.import("ScriptingBridge")

function kosmicTask(pagesDocFilePath)

  -- use the ScriptingBridge framework to access the application
  local app = SBApplication:applicationWithBundleIdentifier_("com.apple.iWork.pages")
  local rtfDocFilePath = pagesDocFilePath .. ".rtf"

  -- open pages
  local myDoc = app:open_(pagesDocFilePath)

  -- save document
  myDoc:saveAs_in_("SLDocumentTypeRichText", rtfDocFilePath)

  -- close document
  myDoc:closeSaving_savingIn_(false, nil)

  -- get the kosmicTaskController class
  local taskController = NSClassFromString("KosmicTaskController")

  -- get our result file path
   -- this file will be automatically deleted when the task ends.
  local resultFile = taskController:resultFileWithName_('result.html')
  resultFile = tostring(resultFile) -- get a native lua string

  -- convert our file
  local cmd = string.format("textutil -convert html -output \"%s\" \"%s\"", resultFile, rtfDocFilePath)
  os.execute(cmd)

  -- return file content in native Lua dictionary
  local result = {}
  result.kosmicFile = resultFile

  return result
end</p>
<p class="p4">As in the case of JavaScript Cocoa we use the KosmicTaskController to retrieve a result file name. The object is not automatically available but is retrieved using the Cocoa framework function NSClassFromString(). This approach is used in several of the Cocoa bridges and is demonstrated where appropriate in the usage documents and templates.</p>
<p class="p2">This example also makes use of another feature of Cocoa bridging - the ability to return native scripting language objects as results. Previously we had either printed our YAML formatted results directly or returned them as the result of calling the task function. With the Cocoa bridge in place we can form our result in a native data structure, a dictionary in this case, and return that as our result. This means that the task can manipulate its result as an object which makes returning results with a complex structure easy.</p>
<p class="p3">Automation with F-Script Cocoa</p>
<p class="p4">Our previous examples have focussed on using the various Cocoa bridges support by KosmicTask. F-Script is not so much a Cocoa bridge as a Cocoa scripting language in its own right. It is written in Cocoa and its distinct syntax has been designed to allow quick and easy manipulation of Cocoa objects. If you want to create complex tasks that manipulate a lot of Cocoa objects then F-Script is a great choice.</p>
<p class="p4">No surprise then that we can recompose our Pages task in F-Script.</p>
<p class="p15">[:pagesDocFilePath |

  "load the ScriptingBridge framework"
  (NSBundle bundleWithPath:'/System/Library/Frameworks/ScriptingBridge.framework') load.

  " use the ScriptingBridge framework to access the application "
  app := SBApplication applicationWithBundleIdentifier:'com.apple.iWork.pages'.
  rtfDocFilePath := pagesDocFilePath ++ '.rtf'.

  "open pages"
  myDoc := app open:pagesDocFilePath.

  "save document"
  myDoc saveAs:'SLDocumentTypeRichText' in:rtfDocFilePath.

  "close document"
  myDoc closeSaving:(NSNumber numberWithBool:NO) savingIn:nil.

  " get our kosmicTaskController "
  taskController := KosmicTaskController.

   " form our file result path"
   " this file will be automatically deleted when the task ends."
  resultFile := taskController resultFileWithName: 'result.html'.

  " convert our file "
  args := {'-convert', 'html', '-output', resultFile, rtfDocFilePath}.
  task := NSTask launchedTaskWithLaunchPath:'/usr/bin/textutil' arguments:args.
  task waitUntilExit.

  " return result dictionary "
  #{'kosmicFile' -&gt; resultFile}.
]</p>
<p class="p6"></p>
<p class="p4">F-Script executes blocks as opposed to functions. In the example our task block is defined by the enclosing square braces [ ... ]. This outermost block accepts a single argument - pagesDocFilePath.</p>
<p class="p4">As in our other examples we start by loading the ScriptingBridge framework except this time we use the Cocoa NSBundle class as the loader.</p>
<p class="p4">The KosmicTaskController object is also referenced in order to obtain our result file path.</p>
<p class="p2">F-Script implements a shorthand literal notation for arrays and dictionaries. F-script functions return the value of the last statement evaluated in the enclosing block. In this case its the literal dictionary returning our result file. </p>
<p class="p3">Automation with AppleScript Cocoa</p>
<p class="p4">We began our series of automation examples with AppleScript and this example:</p>
<p class="p16">-- KosmicTask controller
property taskController : class "KosmicTaskController"

script KosmicTask
  property parent : class "NSObject"
  property NSTask : class "NSTask"

  on KosmicTask(pagesDocFilePath)
    try
      -- we need a path to save our RTF document file into.
      -- the easy way is simply to append .rtf to our existing file path
      set rtfDocFilePath to pagesDocFilePath &amp; ".rtf"

      -- save our pages document as RTF
      tell application "Pages"
        set myDoc to open pagesDocFilePath
        save myDoc as "SLDocumentTypeRichText" in rtfDocFilePath
        close myDoc saving no
      end tell

      -- get result file path
      set resultFile to (taskController's resultFileWithName_("result.html")) as string

      -- build our command
      set theArgs to {"-convert", "html", "-output", resultFile, rtfDocFilePath}

      -- run task
      set theTask to NSTask's launchedTaskWithLaunchPath_arguments_("/usr/bin/textutil", theArgs)
      theTask's waitUntilExit()
</p>
<p class="p17">      -- return file result
      return {kosmicFile:resultFile, kosmicInfo:"file returned"}

    on error errorMessage number errorNumber
      return {kosmicError:errorMessage}
    end try
  end KosmicTask
end script</p>
<p class="p3">Automation with AppScript</p>
<p class="p4">So far we have automated our application with the help of AppleScript and the ScriptingBridge framework. KosmicTask also supports another very capable means of achieving automation - appscript. Appscript is supported by both Ruby and Python and makes a compelling alternative to the ScriptingBridge. </p>
<p class="p13">http://www.cocoadev.com/index.pl?ScriptingBridgeCriticisms</p>
<p class="p4">A good question would be why should I use appscript when the ScriptingBridge is already available? The simple answer is that appscript more accurately represents the un (). This often makes it easy to turn the terminology displayed in an applications's dictionary into a working script. The ScriptingBridge, though useful and moderately efficient, obscures some of the detail of () and this can make () more difficult.</p>
<p class="p4">The obvious point about both Ruby appscript and Python appscript is that the () is much more closely aligned with AppleScript. </p>
<p class="p4">So here is our Ruby powered Pages task using rb-appscript for automation:</p>
<p class="p15"># ruby
require 'appscript'

# get application - for more information see the Ruby Usage document
app = Appscript.app('Pages')

pagesDocFilePath = ARGV[0]
rtfDocFilePath = pagesDocFilePath + ".rtf"

# open pages
myDoc = app.open(pagesDocFilePath)

# save document
app.save(myDoc, {:as =&gt; "SLDocumentTypeRichText", :in =&gt; rtfDocFilePath})

# close document
app.close(myDoc, {:saving =&gt; false})

# define our result file
resultFile = "result.html"

# convert our file
system "textutil -convert html -output \"#{resultFile}\" \"#{rtfDocFilePath}\""

# return our result file
puts "---"
puts "{kosmicFile: #{resultFile}, kosmicInfo: file returned}"</p>
<p class="p4">Each automation command we send is represented by a single Apple Event. These low level events take one default parameter and a number of often optional named parameters. When saving a document the document itself is the default parameter (aka the direct object). The required format (as) and the location (in) are the named parameters. In Ruby appscript exposes our command (save) as a function that takes a single object as the default parameter (myDoc document) and a hash of named parameters (as, in). Appscript requires that the named parameter hash keys be Ruby symbols rather than strings hence the colon prefixes to the key names. </p>
<p class="p15"># ruby
# save document
app.save(myDoc, {:as =&gt; "SLDocumentTypeRichText", :in =&gt; rtfDocFilePath})</p>
<p class="p4">And here is the Python powered variant using py-appscript:</p>
<p class="p15"># python
import os
import sys
import appscript

# get application - for more information see the Python Usage document
app = appscript.app('Pages')
pagesDocFilePath = sys.argv[1]
rtfDocFilePath = pagesDocFilePath + ".rtf"

# open pages
myDoc = app.open(pagesDocFilePath)

# save document, note we use as_ and in_ to avoid keyword collision
app.save(myDoc, as_="SLDocumentTypeRichText", in_=rtfDocFilePath)

# close document
app.close(myDoc, saving=False)

# define our result file
resultFile = "result.html"

# convert our file
command = "textutil -convert html -output \"%s\" \"%s\"" % (resultFile, rtfDocFilePath)
os.system(command)

# return a YAML inline format dictionary with filename
print "--- {kosmicFile: %s, kosmicInfo: file returned}" % resultFile</p>
<p class="p4">Note the following syntactical detail when saving our document:</p>
<p class="p15"># python
# save document, note we use as_ and in_ to avoid keyword collision
app.save(myDoc, as_="SLDocumentTypeRichText", in_=rtfDocFilePath)</p>
<p class="p4">As before () but this time we are able to make use of Pythons support for named optional arguments rather than using a dictionary.</p>
<p class="p4">It turns out that 'as' and 'in' are both Python keywords and therefore cannot be used as named arguments. Hence appscript accepts 'as_' and 'in_' as equivalents.</p>
<p class="p18">How KosmicTask Works</p>
<p class="p3">Application Architecture</p>
<p class="p4">KosmicTask is implemented using a multi tier architecture:</p>
<p class="p4">Tier 1: KosmicTask Client User Interface</p>
<p class="p4">Tier 2: KosmicTask Server</p>
<p class="p4">Tier 3: KosmicTask Task Runner</p>
<p class="p4">Tier 4: Script Language Executable</p>
<p class="p4">The interaction between the tiers is as follows;</p>
<ul>
  <li class="li11">Users interact with the application at Tier 1 to create, edit and execute tasks.</li>
  <li class="li11">The server in Tier 2 receives requests from clients on Tier 1 (both local and remote) to create and execute tasks.</li>
  <li class="li11">Each supported scripting language has an associated Task Runner. When a task is executed the appropriate TaskRunner is launched along with a copy of the script to be executed. This behaviour ensures that each script runs in its own process in Tier 3 and cannot bring down the server in Tier 2.</li>
  <li class="li4">KosmicTask supports both in and out of process scripting. Those scripts that run in process (such as AppleScript and the Cocoa bridge components detailed below) are loaded and executed with the Task Runner in Tier 3. Scripts that are run out of process, such as the majority of the command line derived scripting components, are executed in Tier 4 as instances of individual scripting subsystems.</li>
</ul>
<p class="p4">When a task execution is requested information is passed down through the tiers, the task is executed in the relevant task runner, and the task results are then returned to the user.</p>
<p class="p2">KosmicTask can be configured to load just the server component when a user logs in so that other network users always have access.</p>
<p class="p3">Application Tasks and User Tasks</p>
<p class="p4">KosmicTask comes preinstalled with a number of general utility tasks known as Application Tasks. The majority of these are written in AppleScript. Application Tasks cannot be edited or deleted but they can be duplicated.</p>
<p class="p2">Tasks created by the user are identified as User Tasks. These can be created, edited and deleted by the user.</p>
<p class="p3">Resource Browser</p>
<p class="p4">In KosmicTask each scripting language is implemented as a separate plug-in bundle. The application Resource Browser provides access to the resources supplied by each language plug-in. These resources include:</p>
<ul>
  <li class="li11">A number of task templates (see below).</li>
  <li class="li11">A number of informational documents.</li>
  <li class="li4">A default list of property settings.</li>
</ul>
<p class="p4">The informational documents generally provide links to web based sources of information for the represented language. A usage document provides an overview of how to accomplish basic tasks using the language. This document is intended to accompany and expand upon the information contained with the individual templates. </p>
<p class="p2">Each language also defines a default set of property settings. Most of these are read only and define the specific properties of the language plug-in. Several read-write properties also exist, such as the path to OS X scripting subsystems and task function and class names. These read-write properties can be overridden for individual templates and tasks. Selecting a property from the property list will display a short explanation of its purpose below the list.</p>
<p class="p3">Template Support</p>
<p class="p4">In order to aid user task creation a number of task templates are available through the application Resource Browser. These templates serve to indicate the basic syntax required in each scripting language to achieve a particular objective. In general, all of the distinctive features of KosmicTask are available as a template in each scripting language. Each template includes the script code, the settings necessary to configure the script and an informational document.</p>
<p class="p4">Often the best way to find out how to accomplish a particular task is to examine the available templates. The simplest template - Hello Kosmos - simple returns Hello Kosmos! to the user. Other templates indicate how to return complex objects and files as results while others detail features such as class creation and application automation.</p>
<p class="p2">In addition to the templates that are supplied with the application (the Application Templates) the user may define any number of additional templates.</p>
<p class="p3">Task Inputs</p>
<p class="p4">KosmicTask provides a number of plugin based inputs that provide an effective means of acquiring the input to a task. Any number and selection of input types can be defined to provide the parameters for a given task. </p>
<p class="p4">The standard input types are:</p>
<p class="p4">Date. TODO.</p>
<p class="p4">File. TODO.</p>
<p class="p19">File Path. TODO.</p>
<p class="p19">List Item. TODO.</p>
<p class="p4">Number. TODO</p>
<p class="p2">Text. TODO</p>
<p class="p3">Task Results</p>
<p class="p4">When a task completes it may generate a result that is returned to the user. Task results may consist of simple object such as text string or a number. More complex results containing data such as arrays and dictionaries (aka associative arrays or hashes or maps) can also be returned.</p>
<p class="p4">Complex results also permit the returning of the contents of a file or files as all or part of a result. Complex results retain their structure when presented to the user and thus can be navigated using an outline controller. More importantly, the results can be saved as external XML files or property lists that maintain the result content and structure.</p>
<p class="p2">In addition, CSS based style commands can be embedded in complex results in order to provide result styling.</p>
<p class="p3">Complex Task Results</p>
<p class="p4">Complex task results are generally returned as YAML formatted strings. YAML (YAML Ain't Markup Language or Yet Another Markup Language) is a straight forward human readable way of representing complex data types containing strings, scalars, arrays and dictionaries. Its simple syntax makes it easy for traditional command line scripting languages like Bash to generate complex results simply by printing YAML formatted strings to their standard output.</p>
<p class="p4">YAML is a popular method of representing data relationships and bindings exist for many scripting languages. KosmicTask makes use of these bindings for Java, JavaScript, Perl, Php, Python and Ruby within application defined controller objects. These controller objects handle the translation between the scripts native data structure and YAML. Thus the task produces its result as a native data structure and then passes it over to the controller for formatting. This YAML formatted result is then returned to the user.</p>
<p class="p2">See below for the even simpler way in which Cocoa based tasks can return complex results.</p>
<p class="p3">Application Defined Scripting Resources</p>
<p class="p4">A scripting language plugin can define additional resources to assist with script building and task control.</p>
<p class="p4">Most scripting languages provide some means of validating a script prior to its execution. This functionality is invoked by KosmicTask whenever a task build is requested. Some languages lack this integrated facility and rely on additional tools to provide external validation. A language plugin may optionally include such a tool and invoke it during the build stage.</p>
<p class="p4">Scripts that run in-process with their task runner normally have access to a KosmicTask supplied controller object. This object is designed to allow the task to interface with the task runner. The controller is generally an object written in the target scripting language. In some cases the task will have to explicitly create a reference to or an instance of the controller object. In other cases the controller object will be pre -defined with the tasks scope.</p>
<p class="p2">A language plugin can also provide access to additional scripting facilities. This is the case with appscript which is supplied with the Ruby and Python plug-ins to provide an additional automation interface.</p>
<p class="p3">Task File Handling</p>
<p class="p4">KosmicTask permits the contents of any number of files to be passed as inputs and/or returned as results. File contents are passed as inputs using the File Contents input type. When the task is executed the file contents are transferred to the target machine and temporarily stored. The path to this temporary file as passed as the actual task input parameter enabling the task to access the file data.</p>
<p class="p2">File contents are returned as results by returning a dictionary type result that contains a kosmicFile key defining the file or files whose contents are to be returned to the user.</p>
<p class="p3">Temporary File Handling</p>
<p class="p4">A task may return the contents of a pre existing file as a result or it may wish to return the contents of a temporary file that has been generated by the task. To assist with this KosmicTask provides a number of ways of requesting temporary file storage. File storage allocated in these way will only exist for the lifetime of the task and will be deleted from the host machine when the task terminates.</p>
<p class="p4">A path to a temporary file or files may be requested in three different ways dependent on the nature of the scripting language plugin.</p>
<ul>
  <li class="li11">Command line based scripting languages simply need to create files in the task's initial working directory.</li>
  <li class="li11">Most in process tasks can call the resultFileWithName function on a KosmicTask supplier controller object.</li>
  <li class="li4">Scripts which send Apple events can send the "result file with name &lt;basename&gt;" command to the KosmicTask application object.</li>
</ul>
<p class="p2">The easiest way to determine what method to use for a particular scripting language is to examine the 'file' or 'files' template or read the usage document in the Resource Browser.</p>
<p class="p3">Scripting Language Support</p>
<p class="p4">KosmicTask uses an extensible plug-in architecture to support a wide range of scripting languages. By design support is included for all the scripting languages that are present as part of a standard OS X 10.6 installation. When such a task is executed its script is passed to the local scripting subsystem for execution.</p>
<p class="p4">In addition, KosmicTask includes a number of additional scripting languages. Support for these languages is wholly embedded in the application bundle and nothing is installed outside of the application itself.</p>
<p class="p4">KosmicTask supports both interpreted scripting languages (such as Php and Perl) and those that are compiled (such as AppleScript and Java).</p>
<p class="p4">Support is also included for a number of Cocoa bridges. These bridges are extremely powerful and enable scripts to access all the power and functionality of the OS X Cocoa framework. </p>
<p class="p4">KosmicTask supports the scripting of tasks in the following languages:</p>
<p class="p20"></p>
<p class="p20"></p>

  
    
      
        <p class="p21">Script</p>
      
      
        <p class="p21">Embedded</p>
      
      
        <p class="p21">Description</p>
      
    
    
      
        <p class="p4">AppleScript</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">Apple event scripting component</p>
      
    
    
      
        <p class="p4">Bash shell</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">OS X shell</p>
      
    
    
      
        <p class="p4">C shell</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">OS X shell</p>
      
    
    
      
        <p class="p4">C</p>
      
      
        <p class="p22">yes</p>
      
      
        <p class="p4">Interpreter</p>
      
    
    
      
        <p class="p4">C++</p>
      
      
        <p class="p22">yes</p>
      
      
        <p class="p4">Interpreter</p>
      
    
    
      
        <p class="p4">Java</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">Runtime</p>
      
    
    
      
        <p class="p4">Javascript</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">Interpreter</p>
      
    
    
      
        <p class="p4">Perl</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">OS X scripting component</p>
      
    
    
      
        <p class="p4">PHP</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">OS X scripting component</p>
      
    
    
      
        <p class="p4">Python</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">OS X scripting component</p>
      
    
    
      
        <p class="p4">Ruby</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">OS X scripting component</p>
      
    
    
      
        <p class="p4">Tcl</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">OS X scripting component</p>
      
    
    
      
        <p class="p4">Tenex C shell</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">OS X shell</p>
      
    
    
      
        <p class="p4">Z shell</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">OS X shell</p>
      
    
  

<p class="p20"></p>
<p class="p23"></p>
<p class="p4">C and C++ interpreted scripting support is provided by CINT</p>
<p class="p4">KosmicTask supports Cocoa framework scripting using the following bridges and components:</p>
<p class="p20"></p>
<p class="p20"></p>

  
    
      
        <p class="p21">Script</p>
      
      
        <p class="p21">Embedded</p>
      
      
        <p class="p21">Description</p>
      
      
        <p class="p21">KosmicTask Alias</p>
      
    
    
      
        <p class="p4">AppleScriptObjC</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">AppleScript bridge</p>
      
      
        <p class="p4">AppleScript Cocoa</p>
      
    
    
      
        <p class="p4">F-Script</p>
      
      
        <p class="p22">yes</p>
      
      
        <p class="p4">F-Script Cocoa scripting environment</p>
      
      
        <p class="p4">F-Script Cocoa</p>
      
    
    
      
        <p class="p4">JSCocoa</p>
      
      
        <p class="p22">yes</p>
      
      
        <p class="p4">JavaScript bridge</p>
      
      
        <p class="p4">JavaScript Cocoa</p>
      
    
    
      
        <p class="p4">LuaCocoa</p>
      
      
        <p class="p22">yes</p>
      
      
        <p class="p4">Lua bridge</p>
      
      
        <p class="p4">Lua Cocoa</p>
      
    
    
      
        <p class="p4">PyObjC</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">Python bridge</p>
      
      
        <p class="p4">Python Cocoa</p>
      
    
    
      
        <p class="p4">RubyCocoa</p>
      
      
        <p class="p22">no</p>
      
      
        <p class="p4">Ruby bridge</p>
      
      
        <p class="p4">Ruby Cocoa</p>
      
    
  

<p class="p20"></p>
<p class="p6"></p>
<p class="p2">Within KosmicTask the various Cocoa components are identified by the alias given in the above table. </p>
<p class="p3">Cocoa Based Tasks</p>
<p class="p4">Cocoa based tasks have a great advantage when it comes to generating task results in that they can returned native data structures. KosmicTask will receive the result via the bridge and return it to the user.</p>
<p class="p2">Thus, Cocoa based tasks can generate complex results using the relevant scripting language native data structures such as arrays and dictionaries. Native dictionaries can be used to provide a fast and efficient way of returning the contents of files as results.</p>
<p class="p3">Cocoa Based Application Tasks</p>
<p class="p4">Tasks which utilise the Cocoa framework are run as fully fledged Cocoa applications. </p>
<p class="p2">Many Cocoa components require the existence of a run loop in order to be utilised to their full potential. Normally, application tasks exit when the function that launches them exists. Cocoa based tasks, however, can request that they be allowed to continue running in order to receive further input from runloop sources. When the task determines that it is complete it terminates itself and the task results are returned to the user.</p>
<p class="p3">Comparing Standard and Cocoa Based Language Implementations</p>
<p class="p4">The differences between the standard and Cocoa variants of any scripting language can be summarised as follows:</p>
<ul>
  <li class="li11">Most standard scripting components run as external command line based process (though the likes of JavaScript does not).</li>
  <li class="li11">The standard scripting components are less complex and will load faster than the Cocoa variants.</li>
  <li class="li11">The Cocoa based scripting components run in process with their task runner.</li>
  <li class="li4">The Cocoa based scripting components will generally use more system resources than the standard components. </li>
</ul>
<p class="p4">We can take the examples of Ruby and RubyCocoa to illustrate the above points.</p>
<p class="p4">When a standard Ruby task is executed an instance of the KosmicTaskRubyRunner program is launched (this will be visible in the Activity Monitor application). This program receives the task request from the KosmicTask server component and launches a separate instance of the Ruby command line system (also visible in the Activity Monitor). The task runner passes the task inputs to Ruby and waits for the task results to be returned. When the Ruby instance terminates the task runner formats the task results and returns them to the server component which then transfers them via the network to the user.</p>
<p class="p2">When a RubyCocoa task is executed an instance of the KosmicTaskRubyCocoaRunner program is launched. This program executes as a fully fledged Cocoa application complete with runloop. Once successfully launched the task runner loads the Cocoa task into its own process space and executes the designated run function on the designated run class. When the initial run function returns the task runner checks the status of the KosmicTaskController keepTaskAlive property. If the task requests that it be kept alive then the task is allowed to continue executing until it calls the KosmicTaskController stopTask: method. If the task does not request to be kept alive then the task run loop is stopped immediately.</p>
<p class="p3">Automation Support and System-wide Scripting</p>
<p class="p4">OS X provides a powerful mechanism for automating and controlling system resources and applications using Apple events. AppleScript has been the traditional means of achieving this but now there are other powerful and more intuitive alternatives.</p>
<p class="p4">OS X includes a technology called Scripting Bridge which allows Cocoa based applications to automate other services by sending Apple events. All of the Cocoa capable scripting components supported by KosmicTask can utilise this technology to achieve automation. Scripting Bridge therefore means that automation can be achieved by a much wider range of scripting languages than was previously possible.</p>
<p class="p4">But there is another alternative…</p>
<p class="p2">Apple events are complex and the desired interaction between the controlling script and the targeted application or service can sometimes be difficult to achieve. The appscript component, which is available to the Python and Ruby scripting components, provides an alternative means of generating, sending and interpreting Apple events.</p>
<p class="p3">Security</p>
<p class="p4">KosmicTask uses Transport Layer Security (the successor to SSL) to provide secure network communication. The OS X keychain is used for secure password storage and retrieval.</p>
<p class="p24">KosmicTask Help v1.0.1</p>
<p class="p3">Main Window Layout</p>
<p class="p4">The main KosmicTask window contains the toolbar and four distinct panes.</p>
<p class="p6"></p>
<p class="p25"></p>
<p class="p3">Browser Pane - Top</p>
<p class="p4">The browser mode control at the top of the pane determines the browser contents.</p>
<p class="p4">Browser hide. Hides the browser pane.</p>
<p class="p4">Tasks. Displays a list of available tasks</p>
<p class="p4">Search. Displays a list of search results.</p>
<p class="p2">Sharing. Displays network sharing information.</p>
<p class="p3">Task Pane - Middle</p>
<p class="p4">The task pane displays the current task and results.</p>
<p class="p5">Tabs</p>
<p class="p4">Each task has its own tab containing a task view. The task view displays task input on the left and results on the right.</p>
<ul>
  <li class="li11">To create a new tab click the + button. To close click x.</li>
  <li class="li11">To open a particular task in a new tab command-click the task in the browser.</li>
  <li class="li11">To open a task in a new window use alt-click. Alternatively use the task browser context menu.</li>
  <li class="li26">Drag the tabs to reorder.</li>
</ul>
<p class="p5">Task Navigation Bar</p>
<p class="p4">Provides navigation functionality within the task tab.</p>
<p class="p5">Task View - Left</p>
<p class="p4">Displays the detail of the currently selected task along with any inputs.</p>
<p class="p5">Result View - Right</p>
<p class="p4">Displays the results of task execution. If no task has been executed then the view will display "ready". When a task is executing the view will display "running".</p>
<p class="p5">Task Status - Lower</p>
<p class="p4">Displays the current execution status of the task. While a task is running it will display the elapsed time and network/file transfer activity. If an error occurs during task execution it will be reported here.</p>
<p class="p5">Detail Pane - Bottom</p>
<p class="p4">The detail mode buttons below the pane determine the browser contents.</p>
<p class="p5">Hide</p>
<p class="p4">Hides the detail panel.</p>
<p class="p5">Task History</p>
<p class="p4">Displays a history list of all past task execution requests. The history also retains the values of any task inputs.</p>
<p class="p5">Task Script</p>
<p class="p2">Displays the script associated with the selected task. The script will only be visible to trusted users.</p>
<p class="p3">Sidebar - Left</p>
<p class="p4">The sidebar displays a list of available instances of KosmicTask. You may hide or reveal the view using the Sidebar toolbar button.</p>
<p class="p5">Home</p>
<p class="p4">Represents the instance of KosmicTask on your local machine. It should always be available.</p>
<p class="p5">Shared</p>
<p class="p4">Lists the instances of KosmicTask available on the network. Local network instances will be discovered automatically. You may also connect manually to external networks.</p>
<p class="p27">Getting Started</p>
<p class="p4">KosmicTask uses a publishing idiom to control who has access to particular tasks. When a new task is created it is initially accessible only to trusted users. To make a task available to all users it must be published.</p>
<p class="p4">KosmicTask operates in three different modes, selectable via the task mode control in the tool bar.</p>
<p class="p5">Public Task Mode</p>
<p class="p4">Allows access to published tasks. By default all instances of KosmicTask, both local and remote, can access public tasks. This is the default task mode.</p>
<p class="p5">Trusted User Task Mode</p>
<p class="p4">In order to access all tasks, on either a local or remote instance of KosmicTask, select the trusted user task mode. KosmicTask prompts for a valid username and password and on successful authentication provides access to all tasks.</p>
<p class="p5">Configuration Mode</p>
<p class="p2">In order to create, edit, delete, publish and unpublish tasks select the configuration task mode. As in the case of the trusted user mode you will be required to authenticate.</p>
<p class="p3">Running a Task</p>
<p class="p4">Select a task from the browser.</p>
<p class="p4">If the task has inputs they will be displayed below the task name in the left task view. Enter any required values.</p>
<p class="p4">Click the run toolbar button or select menu item Task - Run (command-R).</p>
<p class="p4">The task will execute and the results will be displayed in the right task pane.</p>
<p class="p2">The task may be paused or stopped prematurely as required.</p>
<p class="p3">Viewing Task Results</p>
<p class="p4">The results for a task will be displayed in the right hand task view. Results may be displayed in a number of different formats using the navigation bar format controls:</p>
<p class="p4">Document. Displays results as a document. A popup control enables formatting as text, XML, or plist.</p>
<p class="p4">Icon. Displays a representative image of file results. A QuickLook preview will often be available.</p>
<p class="p4">List. Displays results as a hierarchical list.</p>
<p class="p4">Script. Displays results as returned by the script.</p>
<p class="p2">It may not be possible to display some or all of a particular result set in every format. KosmicTask will display whatever portion of the results are compatible with the selected format.</p>
<p class="p3">Saving Task Results</p>
<p class="p4">Results may be saved to disk or sent directly to another application. Select the gear icon in the bottom left corner below the results view. Alternatively right (or ctrl-left) click in the results view to display the results menu.</p>
<p class="p4">Save Result. Save the result text as plain text, PDF, RTF, property list or XML.</p>
<p class="p4">Save Result Files. Save any files returned by the task.</p>
<p class="p4">Send Result To. Send the result text to either Excel, Mail, Pages, TextEdit or Word.</p>
<p class="p2">These results processing features are implemented as a series of extensible plug-ins.</p>
<p class="p3">Publishing a Task</p>
<p class="p4">You may publish a task to make it visible to all users or un-publish it to restrict access only to trusted users who can authenticate.</p>
<ul>
  <li class="li11">Select the configuration task mode and enter password and user name if required.</li>
  <li class="li11">In the task browser check the checkbox next to a task name to publish it.</li>
  <li class="li11">Clear the checkbox to un-publish a task.</li>
  <li class="li11">You may publish/un-publish groups of tasks using the Group table checkboxes.</li>
  <li class="li2">Leave configuration mode by selecting either public or trusted user mode. You will be prompted to either save or discard your configuration changes.</li>
</ul>
<p class="p3">Working with Tasks and Results</p>
<p class="p2">KosmicTask provides flexible management of your tasks and results with the aim of providing an efficient workflow that makes it easy to manage multiple tasks and numerous result sets. Features are provided to enable the results of one task to be easily retrieved as input for another.</p>
<p class="p3">Tasks</p>
<p class="p4">A task runs within a tabbed instance of the task pane. You may run multiple tasks at once, either locally or remotely, and each task will run in its own tabbed task pane. Each tab also maintains a history of the tasks that were run within it and the results that were returned.</p>
<p class="p4">When a task is selected in the task browser it will replace the task in the current task view except in the following cases:</p>
<p class="p4">Task already exists in another view. The existing task will be selected.</p>
<p class="p19">Current task view is running a task. A new task view will be created.</p>
<p class="p4">Current task view is pinned. Pinning prevents a task from being replaced. A new task view will be created.</p>
<p class="p2">The above behaviour may be modified using the task browser context menu. Alternatively use command-click to open the task in a new tab and option-click to open in a separate task window. A task window is merely a detached instance of a task view. You may also detach a task view as a separate window using the task navigation bar.</p>
<p class="p3">Results</p>
<p class="p4">Many tasks will produce displayable results though some may not. In these cases an informational message will be displayed.</p>
<p class="p4">KosmicTask includes an integrated file transfer capability that it makes it easy to return the contents of a file as a result.</p>
<p class="p4">Results may consist of two types of data: textual data and file data</p>
<p class="p5">Text result type</p>
<p class="p4">The task returns data that can de displayed as text. The script may have returned a string, number, alias, list or record. KosmicTask will attempt to display all the available data as text.</p>
<p class="p5">File result type</p>
<p class="p4">The task returns data that is to be interpreted as the contents of a file. KosmicTask will display an icon representing the file contents in its icon view and use QuickLook to display the actual contents if possible.</p>
<p class="p2">A script may return a result that contains both textual data and file data. In addition the script may return multiple instances of file data representing multiple files and file types.</p>
<p class="p3">Navigation Bars</p>
<p class="p4">The navigation bars appears along the top of each task view. There is one for the input view and one for the results view.</p>
<p class="p28">Input View Navigation Bar</p>
<p class="p29"></p>
<p class="p4">Pin task. Keep task permanently in view. Task cannot be replaced by another.</p>
<p class="p4">Detach task view as window. Detach the task view tab (inputs and results) and display as a window.</p>
<p class="p4">Task name and list. Name of the currently displayed task. Click to display list of all tasks that have been run in the view. Select ready to clear existing results.</p>
<p class="p4">Prev/next task. Select previous/next task in task name list.</p>
<p class="p4">Match results to task. Match displayed results to current task. Result list will be displayed in red if results do not match.</p>
<p class="p4">Task number and count. The current position of the task within the task list and the total number of tasks run.</p>
<p class="p2">Drag thumb. Task split view drag thumb.</p>
<p class="p12">Results View Navigation Bar</p>
<p class="p29"></p>
<p class="p4">Pin results to task. When pinned the task and results always correspond. Un-pin to allow independent display of tab tasks and results. This is useful when using the results of one task as input to another.</p>
<p class="p4">Detach results as window. Detach a copy of the task results view and display as a window</p>
<p class="p4">Task results name list. Name of the currently displayed task results. Click to display list of all results that have been obtained in the view. Select ready to clear.</p>
<p class="p4">Prev/next results. Select previous/next results in the list.</p>
<p class="p4">Match task to results. Match displayed task to current results. Results list will be displayed in red if displayed task does not match displayed results.</p>
<p class="p4">Results number and count. The current position of the results within the results list and the total number of results obtained.</p>
<p class="p4">Document. Format results as a text document.</p>
<p class="p4">Icon. Format results as icon or image. Only applies to files returned within the results. If a QuickLook preview of the files contents is available then it will be displayed. Otherwise a generic icon will be used.</p>
<p class="p4">List. Format results as a hierarchical list.</p>
<p class="p2">Script. Format results as they were returned by the script. This is useful if you want to incorporate the results directly into another script.</p>
<p class="p3">Task Status View</p>
<p class="p4">The task status view displays the progress of the task's execution. Each task will progress through several stages:</p>
<p class="p6"></p>
<p class="p4">Ready. The task has yet to be run.</p>
<p class="p4">Started. The task has been requested to run.</p>
<p class="p4">Sending. The task request is being sent along with its input data. If the input contains file data then the contents of the file(s) are sent. Transfer progress is displayed.</p>
<p class="p4">Sent. The task request was successfully sent and acknowledged.</p>
<p class="p4">Running. The task is currently running.</p>
<p class="p4">Run (complete). The task has finished running and will send back its results.</p>
<p class="p4">Receiving. The task response is being received along with any results data. If the results contain file data then the contents of the file(s) are sent. Transfer progress is displayed.</p>
<p class="p4">Received. The task results have been received.</p>
<p class="p4">Processing. The task results are being processed.</p>
<p class="p4">Processed. The task results have been processed.</p>
<p class="p4">Finished. The task has finished without errors.</p>
<p class="p2">If an error is encountered then a warning status alert will be displayed and the task will be stopped. To find out more about the error condition open the console using menu item Window - Console (or Command-L).</p>
<p class="p3">Task History View</p>
<p class="p4">The task history displays a list of all the tasks that have been requested on both local and remote machines.</p>
<ul>
  <li class="li11">To run a previous task select it from the history list.</li>
  <li class="li11">If the task has inputs they will also be retrieved from the history.</li>
  <li class="li11">Results are not saved into the history.</li>
  <li class="li2">Tasks that were requested on machines that are not currently available will display a greyed out icon</li>
</ul>
<p class="p3">Task Script View</p>
<p class="p4">The task script view displays the actual script text that will be executed for a given task.</p>
<ul>
  <li class="li11">Script text will only be displayed for trusted users. Enter trusted user task mode in order to enable script viewing.</li>
  <li class="li2">Scripts are read only. To modify the script enter configuration task mode and select edit from the toolbar.</li>
</ul>
<p class="p3">Searching</p>
<p class="p4">Spotlight powered task searching is available for both local and remote instances of KosmicTask. Enter a search term into the Search toolbar control and press Enter to begin the search. The browser pane will display the task search results view. To run a task select it from the search results.</p>
<p class="p6"></p>
<p class="p4">Search view options:</p>
<p class="p4">This Mac. Search the local machine only.</p>
<p class="p4">Machine 1, Machine 2, ... Search a named remote machine.</p>
<p class="p4">Shared. Search all remote machines.</p>
<p class="p4">Contents. Search all the contents of the task.</p>
<p class="p4">Script. Search for script keywords only in the task.</p>
<p class="p4">The search facility depends upon Spotlight being enabled on all machines. Searching on Internet connected machines is fully supported.</p>
<p class="p2">The returned search results always correspond to the prevailing task mode. So only publicly available task matches will be returned when public task mode is selected. If more matches are available in trusted user mode then a + will be appended to the reported number of search results found. So 0 Found + means that 0 public task matches were found but that some matches were found for trusted user mode.</p>
<p class="p3">Networking and Communications</p>
<p class="p4">Tasks are utilised and managed on remote instances of KosmicTask in the same way as local tasks. The sidebar lists:</p>
<ul>
  <li class="li11">All the currently reachable instances of KosmicTask.</li>
  <li class="li11">The current task mode (displays task mode icon except for public mode which is left blank).</li>
  <li class="li11">The number of available tasks (colour coded to the task mode).</li>
  <li class="li2">Connectivity problems. Alert symbol displayed. See the application console log for detail.</li>
</ul>
<p class="p3">Managing Connections</p>
<p class="p4">Bonjour is used to achieve automatic discovery of local network instances of KosmicTask. Should you wish to connect to a local instance that does not have Bonjour configured or to a remote IP or Internet based instance then click the + button at the foot of the sidebar.</p>
<p class="p6"></p>
<p class="p4">Connect to. Domain name or IP address to connect to. Connection will only succeed if the target machine is accessible at the port specified below and is running a copy of KosmicTask.</p>
<p class="p4">Port number. KosmicTask defaults to using registered TCP port number 7742.</p>
<p class="p4">Display name. Friendly name for IP connections.</p>
<p class="p4">Secure connection (SSL). The connection uses secure transport. Selection must match setting on connection target machine.</p>
<p class="p4">Reconnect on start-up. The manual connection will be reinstated on start-up if the connection is added to the favourites list.</p>
<p class="p4">Favorite Kosmic Task Locations. A persistent list of favorite locations.</p>
<p class="p2">To disconnect from a manually established connection click the - button at the foot of the sidebar</p>
<p class="p3">Internet Sharing</p>
<p class="p4">An integrated port mapper is included to facilitate easy access to KosmicTask from the Internet. By default Internet sharing is disabled. The current Internet sharing status is displayed in the bottom right hand corner of the application window.</p>
<p class="p4">When enabling Internet sharing you should be aware that all public scripts will be available to any user who connects via the Internet. If in doubt about this un-publish all of your tasks so that users are forced to authenticate. Always ensure that SSL encryption is selected when enabling Internet sharing (see application Preferences - Security).</p>
<p class="p4">To enable Internet sharing click the Internet status display or select the Internet tab in the preferences panel at KosmicTask - Preferences. Note that the automatic sharing facility requires a UPnP or NAT-PMP compliant router. In the absence of this a manual router configuration will be required in order to accept incoming external requests.</p>
<p class="p30"></p>
<p class="p4">Allow other users to connect via the Internet. Enable external users to connect via the Internet. Click Start to begin sharing and Stop to end. If the operation is successful the sharing indicator will turn green. Otherwise an error condition will be reported.</p>
<p class="p4">External port number. The TCP port number on which the router should accept external connections. By default all instances of KosmicTask use this port for local and remote network communication.</p>
<p class="p4">External IP address. The external IP address of your router. Remote KosmicTask users wishing to connect should enter this IP address into the Connect to field of the connections panel.</p>
<p class="p4">Gateway name. Router/gateway name as reported by router.</p>
<p class="p4">Automatically start Internet sharing. Internet sharing will start automatically whenever KosmicTask is launched. Defaults to off</p>
<p class="p2">Manual Router Configuration. Consult your router documentation to determine how to open an external port (7742) and direct it to the local IP of your machine on port 7742. Should you need to obtain your local network IP address you can consult System Preferences-Network (select the connected interface - Airport, Built-in Ethernet etc).</p>
<p class="p3">Security</p>
<p class="p4">By default all communications to and from KosmicTask are encrypted using SSL (TLS v1) to ensure privacy. This applies to local, remote and Internet based communication. If the application is being used in a single user or trusted environment then the encryption can be disabled if performance/network throughput has to be maximised. A closed padlock icon in the top right of the application windows indicates that a secure connection is currently in use.</p>
<p class="p4">Note: A KosmicTask hosted script has the capability to obtain data from many application and operating system sources. This data may be of a personal or sensitive nature. It is therefore important that the SSL encryption remains enabled so that data transmitted over public networks cannot be observed. Only disable the encryption if you are using KosmicTask in a private or secure network environment.</p>
<p class="p4">Security settings can be found on the Preferences - Security tab.</p>
<p class="p31"></p>
<p class="p32">Disclose your username to other KosmicTask users</p>
<p class="p33">By default your user name will not be visible to other KosmicTask users in the sharing information browser view. You may optionally disclose your user name only to local users or to all users. When logging in to remote instances of KosmicTask a valid user name and password combination may be required.</p>
<p class="p32">Keep your information secure</p>
<p class="p33">SSL encryption is enabled by default and is the recommended configuration.</p>
<p class="p32">Show SSL Certificate</p>
<p class="p33">SSL encryption requires a digital certificate in order to establish a secure connection and to maintain the integrity of that connection. By default KosmicTask will generate a suitable self signed root certificate and store it in the Keychain for future use. The fact that the certificate reports "This root certificate is not trusted" is not indicative of an error or problem. It merely highlights the fact that the certificate is a self signed root and was not issued by a root authority such as Thawte, VeriSign or Comodo. KosmicTask uses the certificate solely to enable encryption not to establish a trust relationship.</p>
<p class="p32">Password Security</p>
<p class="p2">All entered user passwords, for either the local or remote instances of KosmicTask, may be saved into the system Keychain for secure storage and easy retrieval. KosmicTask relies upon SSL encryption being enabled in order to maintain password security over the network. If you disable the default encryption then your password may be retrievable from the network data stream.</p>
<p class="p3">Managing Tasks</p>
<p class="p4">Enter configuration mode in order to create, edit and manage tasks. You may configure and manage both local and remote instances of KosmicTask in the same manner.</p>
<p class="p4">Configuration mode functionality:</p>
<ul>
  <li class="li11">Publish a task</li>
  <li class="li11">Un-publish a task</li>
  <li class="li11">Create a task</li>
  <li class="li11">Edit, compile and test a task</li>
  <li class="li11">Duplicate a task</li>
  <li class="li11">Delete a task</li>
  <li class="li11">Manage task groups</li>
  <li class="li11">Assign task ratings</li>
  <li class="li2">Assign task labels</li>
</ul>
<p class="p3">Task Types</p>
<p class="p4">There are two types of tasks:</p>
<p class="p4">Applications Tasks. Tasks provided by default and intended to serve as example material and as templates for user tasks. Application tasks cannot be directly edited or deleted. Duplicate an application task to create an editable user copy.</p>
<p class="p4">User Tasks. User defined and created tasks.</p>
<p class="p2">The task type icon precedes the task name in the task browser.</p>
<p class="p12">Task Operations</p>
<p class="p30"></p>
<p class="p4">Create a task. Select New from the tool bar or menu item File - New (command-N). The task edit window will open.</p>
<p class="p4">Edit a task. Select Edit from the tool bar or menu item File - Edit... (command-E). The task edit window will open. A duplication prompt sheet will be displayed if an application task is selected for editing.</p>
<p class="p4">Duplicate a task. Select Duplicate from the tool bar or menu item File - Duplicate (command-D). The Task edit window will open containing a mutable copy of the selected task.</p>
<p class="p2">Delete a task. Select Delete from the tool bar or menu item File - Duplicate (command-delete).</p>
<p class="p3">Task Names and Groups</p>
<p class="p4">Tasks may be assigned to groups for easy management and browsing. To assign or modify the icon associated with a group right click on the group name and select Group Icon... from the context menu. Groups may be published and unpublished as a whole.</p>
<p class="p2">Each task requires a name but there is no requirement that this name be unique throughout the application. When a task is duplicated an identifying tag is appended to the task name. The duplicated task name can be modified as required.</p>
<p class="p3">Task Ratings and Labels</p>
<p class="p4">Tasks may be rated and labelled to assist with classification and identification. Right click in the task browser to display the context menu.</p>
<p class="p4">Rating. A value from none to 5 stars.</p>
<p class="p2">Label. A finder style coloured label.</p>
<p class="p3">How Task Scripting Works</p>
<p class="p4">KosmicTask subdivides the process of creating and editing tasks into three different stages.</p>
<ul>
  <li class="li11">Defining the task's configuration and parameters.</li>
  <li class="li11">Editing and compiling the task.</li>
  <li class="li4">Testing the task.</li>
</ul>
<p class="p2">Once you have finished defining, editing and testing your task you will be prompted to save it, at which point it will be added to the task browser list. You can create, edit, compile and test tasks on both the local and remote machines.</p>
<p class="p3">Defining the Task</p>
<p class="p4">Create or edit an existing task. The task edit window will open.</p>
<p class="p4">Task Detail: the left hand view.</p>
<p class="p4">Your task needs to have a name and it needs to belong to a group. Note that the task name does not have to be unique. You may also enter a short and long description for your task. This information will be visible to the user when the task is run. You may also enter additional information about the task's author.</p>
<p class="p4">Script Detail: the right hand view.</p>
<p class="p4">Each task has an associated script. When the task is run a routine (or handler) within the script is called. KosmicTask supports 4 handler definitions:</p>
<p class="p4">run script. Calls the implicit run handler or explicit run handler of the form on run. This definition does not support parameters.</p>
<p class="p4">run script with parameters. Calls the explicit run handler of the form on run{}. This definition supports optional parameters. Note the use of { }.</p>
<p class="p4">call default handler. Calls the default application handler of the form on kosmicTask(). This definition supports optional parameters.</p>
<p class="p4">call user defined handler. Calls a user defined handler. This definition supports optional parameters.</p>
<p class="p4">Simple scripts, such as the following, may make use of the implicit run handler when no script parameters are required. In this case no actual entry handler is defined within the script and execution begins at the outermost statement.</p>
<p class="p15">display dialog "Implicit run handler called"</p>
<p class="p4">You may alternatively define an explicit run handler with optional arguments:</p>
<p class="p15">on run{}
    display dialog "Explicit run handler called"
end run</p>
<p class="p4">KosmicTask defaults to using a handler named kosmicTask. The use of this handler makes it explicit within the script where KosmicTask execution will begin.</p>
<p class="p15">on kosmicTask()
  display dialog "Default run handler called"
end kosmicTask</p>
<p class="p4">Lastly you may define a custom handler.</p>
<p class="p15">on myHandler()
    display dialog "Custom run handler called"
end myHandler</p>
<p class="p4">Some tasks do not require any additional user input. For example, a task to empty the trash may not need any additional input information. But a task that is going to merge two images together certainly will.</p>
<p class="p4">To add or remove input parameters to your task select the + and - buttons.</p>
<p class="p4">Each input requires a name and a description. Again, this information is used to provide feedback to the user when the task is run.</p>
<p class="p4">Each input also requires a type. KosmicTask provides support for the following input parameter types:</p>
<ul>
  <li class="li11">Text - sends text to your task.</li>
  <li class="li11">Number - sends a number to your task.</li>
  <li class="li11">Date - sends a date to your task.</li>
  <li class="li11">List - select an item from a list and send it to your task.</li>
  <li class="li4">File - select a file and send its content to your task.</li>
</ul>
<p class="p4">You may add as many inputs of whatever type to your task as you required. Each input can be generally configured with an initial value. KosmicTask implements these inputs as loadable bundles so that different input types can be added as required.</p>
<p class="p4">Once the task handler and parameters have been defined enter your script in the Edit Task Script view. In order for the script to be callable by the task it must contain the handler routine that you previously defined.</p>
<p class="p4">Once you have edited you script text click the compile button. You should be aware that you can readily edit and compile your scripts from another networked machine. In such a case your script is sent over the network, compiled and the result returned. You do not need to target the remote machine in your script as the script will be executed remotely. Once the script is complete and compiles correctly you can test it in the Run Task view.</p>
<p class="p2">Note that although you can run and test your task in the Run Task view like any other script it has not yet been saved and will not display in the task browser. To save the task select menu item File - Save (command-S) or close the edit window.</p>
<p class="p3">Task Results</p>
<p class="p4">Your task script may return one of the following AppleScript data types and KosmicTask will display it appropriately.</p>
<ul>
  <li class="li11">Boolean</li>
  <li class="li11">Integer</li>
  <li class="li11">Real</li>
  <li class="li11">Date</li>
  <li class="li11">String</li>
  <li class="li11">File</li>
  <li class="li11">List</li>
  <li class="li4">Record</li>
</ul>
<p class="p4">If you need to return more than one value use either a list or record.</p>
<p class="p15">return {message:"done", time:1.5}Returning the Contents of a File</p>
<p class="p4">In some situations you may wish to return the actual contents of a file rather than a string data containing a file path name. This can be achieved by returning a record type containing an item named kosmicFile. So if you have a file whose path is stored as myFilePath you can simply return the contents of that file with:</p>
<p class="p15">return { kosmicFile:myFilePath}</p>
<p class="p4">If you want to return the contents of more than one file simply return a list of file paths:</p>
<p class="p15">return { kosmicFile:{myFilePath, anotherFilePath}}</p>
<p class="p4">If you want to return value data along with the file contents then simple define other record items:</p>
<p class="p17">return { kosmicFile:{myFilePath, anotherFilePath}, info:"2 files"}</p>
<p class="p3">Styling Results</p>
<p class="p4">KosmicTask supports the styling of results using standard CSS properties and values. We identify the data to be styled using the kosmicData record name and define the CSS styling string using the kosmicStyle record name.</p>
<p class="p15">return {kosmicData:"Make me big and red", kosmicStyle:"color:red;font-size:120%"}</p>
<p class="p4">Which will result in:</p>
<p class="p34">Make me big and red</p>
<p class="p4">Styling can be applied to all data types. In the case of lists and records the styling will cascade down to any enclosed types unless it is overridden by another kosmicStyle item.</p>
<p class="p15">set theRebel to {kosmicData:"Not me, I want to be red", kosmicStyle:"color:red"}

set myResult to {"I want to be blue", "Me too", "True blue", theRebel}

return {kosmicData:myResult, kosmicStyle:"color:blue"}</p>
<p class="p4">Which will result in:</p>
<p class="p35">I want to be blue</p>
<p class="p35">Me too</p>
<p class="p35">True blue</p>
<p class="p36">Not me, I want to be red</p>
<p class="p2">To view all tasks that use styling enter "kosmicStyle" into the application search field.</p>
<p class="p12">CSS Styling Properties</p>
<p class="p37">The following CSS properties and values are supported within kosmicStyle named value strings:</p>
<p class="p4">color, background-color. named colors (white, black, aqua, blue, gray, green, fuchsia, lime, maroon, navy, olive, purple, red, silver, teal, yellow), color hex eg: #FFFFFF, color rgb eg: rgb(255,255,255)</p>
<p class="p19">font-size, line-height. pt, px, em, %</p>
<p class="p4">font-weight. normal, bold.</p>
<p class="p4">font-style. normal, italic.</p>
<p class="p2">text-decoration. none, underline.</p>
<p class="p3">Creating and Editing Tasks</p>
<p class="p4">Task edit window layout:</p>
<p class="p6"></p>
<p class="p4">The task edit window supports three different views as selected by the edit workflow control.</p>
<p class="p4">Configure Task. Configure the task detail and define the script handler and any required input parameters.</p>
<p class="p4">Edit Task Script. Edit and compile the task script.</p>
<p class="p4">Run Task. Run and test the task.</p>
<p class="p38"></p>
<p class="p3">Configure Task Detail</p>
<p class="p4">Configure task definition and descriptive information.</p>
<p class="p39">Definition</p>
<ul>
  <li class="li11">Name: the task name as displayed in the task browser.</li>
  <li class="li11">Type: the script type. Currently AppleScript only.</li>
  <li class="li26">Group: the task's container group. Select an existing group or enter a new group name.</li>
</ul>
<p class="p39">Description</p>
<ul>
  <li class="li11">Short Description: short description as displayed in task view.</li>
  <li class="li26">Long Description: long description. Supports attributed text. Images may be dragged and dropped. Useful for more complex tasks were comprehensive instruction needs to be provided to the user.</li>
</ul>
<p class="p39">Info</p>
<ul>
  <li class="li11">Author: Task author.</li>
  <li class="li11">Note: Author note. Original script source, references etc.</li>
  <li class="li11">Created: Task created date.</li>
  <li class="li11">Modified: Task modified date.</li>
  <li class="li26">Version: Task version. Can increment automatically with each save.</li>
</ul>
<p class="p39">Options</p>
<ul>
  <li class="li2">Task must complete in specified time: Set task timeout. If task does not complete in specified time it will be automatically terminated.</li>
</ul>
<p class="p3">Configure Script Detail</p>
<p class="p4">Configure script handler and optional parameters.</p>
<p class="p39">Script Handler</p>
<ul>
  <li class="li11">On run task: the name of the script subroutine or handler to be called when the task is run.</li>
  <li class="li11">Script handler name: the name selected above.</li>
  <li class="li11">Script parameters: the number of parameters to be passed to the script.</li>
  <li class="li26">Copy: copy the script name and parameter list. This can be pasted directly into the script.</li>
</ul>
<p class="p5">Script Parameters</p>
<p class="p2">A list of defined parameters, types and defaults. Use the + and - buttons to add and remove parameters. Parameters may also be deleted using the x button in the parameter title bar.</p>
<p class="p3">Edit Task Script</p>
<p class="p4">Edit task script window layout:</p>
<p class="p6"></p>
<p class="p4">Compile. Compile the script. Scripts for remote machines will be dispatched for compilation on the remote machine.</p>
<p class="p4">Dictionary. Display dictionaries for applications on the local machine. Dictionaries for remote machines are not available.</p>
<p class="p5">Run Task</p>
<p class="p2">A task view in which to run and test the task.</p>
<p class="p3">Preferences, Feedback and the Console</p>
<p class="p4">To display the preferences panel select the application menu item KosmicTask - Preferences...</p>
<p class="p5">General Preferences</p>
<p class="p4">Publish my tasks when I log in. The KosmicTask server agent will start as soon as you log in so that your tasks become available over the network. The main KosmicTask application and window will not start.</p>
<p class="p4">Check for application updates at startup. The application will check for updates at startup. If an update is found you will be prompted to install it. You may check for updates manually using the application menu item KosmicTask - Check for Updates...</p>
<p class="p5">Tabs Preferences</p>
<p class="p4">Command-click opens a task in a new tab. Enables click opening of tasks in new tabs.</p>
<p class="p4">Alt-click opens a task in a new tab. Enables click opening of tasks in new windows.</p>
<p class="p19">Confirm when closing multiple tabs. Enable confirmation message.</p>
<p class="p2">The Security and Internet preferences are discussed in the sections above.</p>
<p class="p3">Feedback and Support</p>
<p class="p4">We welcome all feedback and comments with regard to KosmicTask. Good or bad, we would like to know!</p>
<p class="p4">To display the feedback panel select the blue feedback icon in the top right hand corner of the title bar or select the application menu item KosmicTask - Feedback and support...</p>
<p class="p4">Using the feedback panel you can:</p>
<ul>
  <li class="li11">Ask a support question.</li>
  <li class="li11">Send us an application feature request.</li>
  <li class="li4">Send us a bug report.</li>
</ul>
<p class="p2">You may optionally include your email address if you require a reply. The feedback is sent directly to Mugginsoft and does not utilise email.</p>
<p class="p3">The Console</p>
<p class="p4">To display the console window select menu item Window - Console or keyboard shortcut command-L.</p>
<p class="p6"></p>
<p class="p4">Errors. Displays a list of application errors including the error source and code. More information on a particular error may be available in the log.</p>
<p class="p4">Log. Displays a real time log of informational, diagnostic and error messages relating to KosmicTask.</p>
<p class="p4">Clear. Clears both the error list and the log.</p>
<p class="p2">Send. Sends the contents of the console window to Mugginsoft support via email. Use this facility to report bugs and problems. Alternatively copy and paste the log contents into the feedback panel.</p>
<p class="p3">Licensing</p>
<p class="p4">To display the Licences panel click application menu item KosmicTask - Licences...</p>
<p class="p4">KosmicTask ships with a default trial licence file that provides limited functionality for application appraisal purposes. A full licence must be installed to enable all application features.</p>
<p class="p4">Available Licences. Lists the currently installed licences.</p>
<p class="p4">Licence Details. Lists the information contained within the licence.</p>
<p class="p4">Buy Licences. Buy licences from the Mugginsoft website.</p>
<p class="p4">Remove Licence. Remove selected licence. If all full licences are removed the application will revert to trial functionality.</p>
<p class="p4">Add Licence. Select a licence file to install it. KosmicTask licence files end with the extension .ktlic. Aternatively, you may install a licence by double clicking the licence file in the finder.</p>
<p class="p20"></p>
<p class="p40">12</p>
<p class="p41">KosmicTask Guide</p>
<p class="p42">KosmicTask GuideMugginsoftMugginsoftMugginsoftmugginsoft</p>
<p class="p43"></p>
<p class="p44">MugginsoftMugginsoft</p>
</body>
</html>
