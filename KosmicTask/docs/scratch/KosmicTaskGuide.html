<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1038.32">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px 'Helvetica Neue Light'; min-height: 11.0px}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px 'Helvetica Neue Light'; color: #5f5e5f; min-height: 11.0px}
    p.p3 {margin: 0.0px 0.0px 15.0px 0.0px; font: 36.0px 'Trebuchet MS'; color: #95b836}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Arial}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Arial; min-height: 14.0px}
    p.p6 {margin: 0.0px 0.0px 15.0px 0.0px; font: 18.0px 'Trebuchet MS'; color: #95b836}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.0px Arial}
    p.p8 {margin: 0.0px 0.0px 40.0px 0.0px; font: 13.0px 'Helvetica Neue'; color: #95b836}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.0px Arial; min-height: 11.0px}
    p.p10 {margin: 0.0px 0.0px 40.0px 0.0px; font: 10.0px Arial; color: #5f5e5f}
    p.p11 {margin: 0.0px 0.0px 9.0px 0.0px; font: 13.0px 'Helvetica Neue'; color: #95b836}
    p.p12 {margin: 0.0px 0.0px 40.0px 0.0px; font: 10.0px Arial}
    p.p13 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.0px Arial; color: #1022a3}
    p.p14 {margin: 0.0px 0.0px 40.0px 0.0px; font: 10.0px Arial; min-height: 11.0px}
    p.p15 {margin: 0.0px 0.0px 9.0px 0.0px; text-align: right; font: 9.0px 'Helvetica Neue Light'; color: #95b836}
    p.p16 {margin: 0.0px 0.0px 0.0px 0.0px; font: 7.0px 'Helvetica Neue Light'}
    p.p17 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: center; font: 36.0px 'Trebuchet MS'; min-height: 42.0px}
    p.p18 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: center; font: 7.0px 'Helvetica Neue Light'}
    li.li7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.0px Arial}
    li.li12 {margin: 0.0px 0.0px 40.0px 0.0px; font: 10.0px Arial}
    span.s1 {letter-spacing: 0.0px}
    span.s2 {letter-spacing: 2.1px}
    span.s3 {letter-spacing: 1.1px}
    span.s4 {font: 10.0px Arial; letter-spacing: 0.0px color: #000000}
    span.s5 {letter-spacing: 0.0px color: #95b836}
    span.s6 {font: 10.0px Arial; text-decoration: underline ; letter-spacing: 0.0px color: #1022a3}
    span.s7 {letter-spacing: 0.0px color: #000000}
    span.s8 {text-decoration: underline ; letter-spacing: 0.0px}
    span.s9 {font: 9.0px Arial; letter-spacing: 0.0px}
    span.s10 {font: 36.0px 'Trebuchet MS'; letter-spacing: 0.0px color: #95b836}
    span.Apple-tab-span {white-space:pre}
    ol.ol1 {list-style-type: decimal}
    ul.ul1 {list-style-type: disc}
  </style>
</head>
<body>
<p class="p1"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"></span><br></p>
<p class="p3"><span class="s2"><b>KosmicTask</b></span></p>
<p class="p4"><span class="s1">The Secure Integrated Scripting Environment for OS X</span></p>
<p class="p5"><span class="s1"></span><br></p>
<p class="p6"><span class="s3"><b>Guide</b></span></p>
<p class="p7"><span class="s1">Updated March 2011</span></p>
<p class="p8"><span class="s4"></span><span class="s1"><b>Overview</b></span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">KosmicTask is a Secure Integrated Scripting Environment for OS X.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">KosmicTask can create, edit, execute and share script based tasks using a wide range of scripting languages.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p10"><span class="s1">KosmicTask is available as time limited trial. After the trial version expires you will be able to read but not execute any tasks that you have created until a full licence is purchased and installed.</span></p>
<p class="p11"><span class="s1"><b>System Requirements</b></span></p>
<ul class="ul1">
  <li class="li7"><span class="s1">Mac OS X 10.6</span></li>
  <li class="li12"><span class="s1">50 MB free hard disk space</span></li>
</ul>
<p class="p11"><span class="s1"><b>Getting Support</b></span></p>
<p class="p7"><span class="s1">Their are a number of ways to request support for KosmicTask.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><b>Application.</b></span><span class="s1"> From the application menu select <b>KosmicTask - Feedback and Support...</b></span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><b>Forum</b></span><span class="s1">. Visit the the support forum at <a href="http://forum.mugginsoft.com"><span class="s6">forum.mugginsoft.com</span></a></span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p13"><span class="s5"><b>Website.</b></span><span class="s7"> Visit the support website at <a href="http://www.mugginsoft.com/kosmictask/support"><span class="s8">www.mugginsoft.com/kosmictask/support</span></a></span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s5"><b>Email.</b></span><span class="s1"> Send an email request to <a href="mailto:support@mugginsoft.com"><span class="s6">support@mugginsoft.com</span></a></span></p>
<p class="p11"><span class="s1"><b>Task Based Scripting</b></span></p>
<p class="p7"><span class="s1">A Task contains a script and a list of the inputs that it requires. When a task is executed the user is queried for the task inputs, the task is executed and the results are returned to the user.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">Tasks may be published, enabling them to be accessed and executed by any other network connected KosmicTask user. In addition, users that are able to authenticate over the network will be able to create, edit and execute tasks on the remote machine.</span></p>
<p class="p11"><span class="s1"><b>Quick Guide to Running Tasks</b></span></p>
<p class="p7"><span class="s1">To run a task simply select it from the left hand sidebar. Enter any inputs that are required and click either the large green run button or the run button the menu bar. Task results will be displayed in the adjoining pane. To save the task results select <b>File</b> - <b>Save</b> <b>As</b>… from the menu.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">Initially only tasks available to all users will be displayed (this is is the <b>Public</b> task view). To access all tasks on the machine select the <b>User</b> task view above the sidebar.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">To run tasks on another machine simply select the machine name and the required task from the sidebar. To access user tasks on the remote machine you will be asked to authenticate. Enter a valid OS X username and password. By default all exchanges with remote machines are secure.</span></p>
<p class="p11"><span class="s1"><b>Quick Guide to Creating Tasks</b></span></p>
<p class="p7"><span class="s1">To create a task select the <b>Admin</b> task view and click <b>New</b> on the toolbar.</span></p>
<p class="p7"><span class="s1">Then, in the displayed <b>Edit</b> window:</span></p>
<p class="p9"><span class="s1"></span><br></p>
<ol class="ol1">
  <li class="li7"><span class="s1">Enter task name, script type, group and description in the first pane.</span></li>
  <li class="li7"><span class="s1">If the Task requires inputs click + to add. Enter the input name and select its type.</span></li>
  <li class="li7"><span class="s1">Click Edit button in the toolbar and select a template from the displayed list. Edit the task.</span></li>
  <li class="li7"><span class="s1">Build the task if required (it is optional for some task types).</span></li>
  <li class="li7"><span class="s1">Click the Run button to display the test pane.</span></li>
  <li class="li7"><span class="s1">Run and test the task.</span></li>
  <li class="li12"><span class="s1">Close the Edit window and click Save to save the task.</span></li>
</ol>
<p class="p11"><span class="s1"><b>Quick Usage Guide</b></span></p>
<p class="p7"><span class="s1">KosmicTask can be sued in a wide range of different situations and has features that appeal to various classes of users.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><b>Home. </b></span><span class="s1">Use KosmicTask on a single Mac or home network to carry out repetitive administration and automation tasks. Non technical users can easily utilise existing tasks. More technical users will find that there is a wealth of scripts available on the Internet that they can easily adapt to their purpose.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><b>Business</b>.</span><span class="s1"> KosmicTask is an effective tool for sharing business automation tasks with end users. Document processing, file processing and automation based services can all be configured from within the application and shared out to clients on the network.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><b>Education</b></span><span class="s1">. KosmicTask provides a great way of introducing students to a wide range of scripting languages. The application comes with a range of both native OS X and embedded scripting languages. Students can develop and test scripts on own machine whilst educators can review and appraise their tasks via the network.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><b>System Administration.</b></span><span class="s1"> Systems and network administrators will find that the application is a convenient and secure method of providing user scripts and performing script based network maintenance.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><b>Software Development.</b></span><span class="s1"> Developers can use KosmicTask to quickly prototype code ideas. It is also useful for building and organizing a library of executable code samples and snippets.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s5"><b>Science and Technology.</b></span><span class="s1"> The distributed task model means that the application is ideally suited to data acquisition and processing projects. Tasks can be configured to collect and process data on the remote target before returning the results for further analysis and persistence.</span></p>
<p class="p11"><span class="s1"><b>Application Architecture</b></span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">KosmicTask is implemented using a multi tier architecture:</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><b>Tier 1:</b></span><span class="s1"> KosmicTask Client User Interface</span></p>
<p class="p7"><span class="s5"><b>Tier 2:</b></span><span class="s1"> KosmicTask Server</span></p>
<p class="p7"><span class="s5"><b>Tier 3:</b></span><span class="s1"> KosmicTask Task Runner</span></p>
<p class="p7"><span class="s5"><b>Tier 4:</b></span><span class="s1"> Script Language Executable</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">The interaction between the tier is as follows;<br>
</span></p>
<ol class="ol1">
  <li class="li7"><span class="s1">Users interact with the application at <b>Tier 1</b> to create, edit and execute tasks.</span></li>
  <li class="li7"><span class="s1">The server in <b>Tier 2</b> receives requests from clients on <b>Tier 1</b> (both local and remote) to create and execute tasks.</span></li>
  <li class="li7"><span class="s1">Each supported scripting language has an associated Task Runner. When a task is executed the appropriate TaskRunner is launched along with a copy of the script to be executed. This behaviour ensures that each script runs in its own process in <b>Tier 3</b> and cannot bring down the server in <b>Tier 2</b>.</span></li>
  <li class="li7"><span class="s1">KosmicTask supports both in and out of process scripting. Those scripts that run in process (such as AppleScript and the Cocoa bridge components detailed below) are loaded and executed with the Task Runner in <b>Tier 3</b>. Scripts that are run out of process, such as the majority of the command line derived scripting components, are executed in <b>Tier 4</b> as instances of individual scripting subsystems.</span></li>
</ol>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">When a task execution is requested information is passed down through the tiers, the task is executed in the relevant task runner, and the task results are then returned to the user.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">KosmicTask can be configured to load just the server component when a user logs in so that other network users always have access.</span></p>
<p class="p14"><span class="s1"></span><br></p>
<p class="p11"><span class="s1"><b>Application Tasks and User Tasks</b></span></p>
<p class="p7"><span class="s1">KosmicTask comes preinstalled with a number of general utility tasks known as <b>Application Task</b>s. The majority of these are written in AppleScript. <b>Application Tasks</b> cannot be edited or deleted but they can be duplicated.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">Tasks created by the user are identified as <b>User Tasks</b>. These can be created, edited and deleted by the user.</span></p>
<p class="p11"><span class="s1"><b>Resource Browser</b></span></p>
<p class="p7"><span class="s1">In KosmicTask each scripting language is implemented as a separate plug-in bundle. The application <b>Resource Browser</b> provides access to the resources supplied by each language plug-in. These resources include:</span></p>
<p class="p9"><span class="s1"></span><br></p>
<ol class="ol1">
  <li class="li7"><span class="s1">A number of task templates (see below).</span></li>
  <li class="li7"><span class="s1">A number of informational documents.</span></li>
  <li class="li7"><span class="s1">A default list of property settings.</span></li>
</ol>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">The informational documents generally provide links to web based sources of information for the represented language. A usage document provides an overview of how to accomplish basic tasks using the language. This document is intended to accompany and expand upon the information contained with the individual templates.<span class="Apple-converted-space"> </span></span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">Each language also defines a default set of property settings. Most of these are read only and define the specific properties of the language plug-in. Several read-write properties also exist, such as the path to OS X scripting subsystems and task function and class names. These read-write properties can be overridden for individual templates and tasks. Selecting a property from the property list will display a short explanation of its purpose below the list.</span></p>
<p class="p11"><span class="s1"><b>Template Support</b></span></p>
<p class="p7"><span class="s1">In order to aid user task creation a number of task templates are available through the application Resource Browser. These templates serve to indicate the basic syntax required in each scripting language to achieve a particular objective. In general, all of the distinctive features of KosmicTask are available as a template in each scripting language. Each template includes the script code, the settings necessary to configure the script and an informational document.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">Often the best way to find out how to accomplish a particular task is to examine the available templates. The simplest template - Hello Kosmos - simple returns Hello Kosmos! to the user. Other templates indicate how to return complex objects and files as results while others detail features such as class creation and application automation.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">In addition to the templates that are supplied with the application (the Application Templates) the user may define any number of additional templates.</span></p>
<p class="p11"><span class="s1"><b>Task Inputs</b></span></p>
<p class="p7"><span class="s1">KosmicTask provides a number of plugin based inputs that provide an effective means of acquiring the input to a task. Any number and selection of input types can be defined to provide the parameters for a given task.<span class="Apple-converted-space"> </span></span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">The standard input types are:</span></p>
<p class="p9"><span class="s1"></span><br></p>
<ul>
  <li class="li7"><span class="s1">Date</span></li>
  <li class="li7"><span class="s1">File Contents</span></li>
  <li class="li7"><span class="s1">List Item</span></li>
  <li class="li7"><span class="s1">Number</span></li>
  <li class="li12"><span class="s1">Text</span></li>
</ul>
<p class="p11"><span class="s1"><b>Task Results</b></span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">When a task completes it may generate a result that is returned to the user. Task results may consist of simple object such as text string or a number. More complex results containing data such as arrays and dictionaries (aka associative arrays or hashes or maps) can also be returned.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">Complex results also permit the returning of the contents of a file or files as all or part of a result. Complex results retain their structure when presented to the user and thus can be navigated using an outline controller. More importantly, the results can be saved as external XML files or property lists that maintain the result content and structure.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">In addition, CSS based style commands can be embedded in complex results in order to provide result styling.</span></p>
<p class="p11"><span class="s1"><b>Complex Task Results</b></span></p>
<p class="p7"><span class="s1">Complex task results are generally returned as YAML formatted strings. YAML (YAML Ain't Markup Language or Yet Another Markup Language) is a straight forward human readable way of representing complex data types containing strings, scalars, arrays and dictionaries. Its simple syntax makes it easy for traditional command line scripting languages like Bash to generate complex results simply by printing YAML formatted strings to their standard output.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">YAML is a popular method of representing data relationships and bindings exist for many scripting languages. KosmicTask makes use of these bindings for Java, JavaScript, Perl, Php, Python and Ruby within application defined controller objects. These controller objects handle the translation between the scripts native data structure and YAML. Thus the task produces its result as a native data structure and then passes it over to the controller for formatting. This YAML formatted result is then returned to the user.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">See below for the even simpler way in which Cocoa based tasks can return complex results.</span></p>
<p class="p11"><span class="s1"><b>Application Defined Scripting Resources</b></span></p>
<p class="p7"><span class="s1">A scripting language plugin can define additional resources to assist with script building and task control.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">Most scripting languages provide some means of validating a script prior to its execution. This functionality is invoked by KosmicTask whenever a task build is requested. Some languages lack this integrated facility and rely on additional tools to provide external validation. A language plugin may optionally include such a tool and invoke it during the build stage. <span class="Apple-converted-space"> </span></span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">Scripts that run in-process with their task runner normally have access to a KosmicTask supplied controller object. This object is designed to allow the task to interface with the task runner. The controller is generally an object written in the target scripting language. In some cases the task will have to explicitly create a reference to or an instance of the controller object. In other cases the controller object will be pre -defined with the tasks scope.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">A language plugin can also provide access to additional scripting facilities. This is the case with appscript which is supplied with the Ruby and Python plug-ins to provide an additional automation interface.</span></p>
<p class="p11"><span class="s1"><b>Task File Handling</b></span></p>
<p class="p7"><span class="s1">KosmicTask permits the contents of any number of files to be passed as inputs and/or returned as results. File contents are passed as inputs using the File Contents input type. When the task is executed the file contents are transferred to the target machine and temporarily stored. The path to this temporary file as passed as the actual task input parameter enabling the task to access the file data.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">File contents are returned as results by returning a dictionary type result that contains a kosmicFile key defining the file or files whose contents are to be returned to the user.</span></p>
<p class="p11"><span class="s1"><b>Temporary File Handling</b></span></p>
<p class="p7"><span class="s1">A task may return the contents of a pre existing file as a result or it may wish to return the contents of a temporary file that has been generated by the task. To assist with this KosmicTask provides a number of ways of requesting temporary file storage. File storage allocated in these way will only exist for the lifetime of the task and will be deleted from the host machine when the task terminates.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">A path to a temporary file or files may be requested in three different ways dependent on the nature of the scripting language plugin.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">1. Command line based scripting languages simply need to create files in the task's initial working directory.</span></p>
<p class="p7"><span class="s1">2. Most in process tasks can call the resultFileWithName function on a KosmicTask supplier controller object.</span></p>
<p class="p7"><span class="s1">3. Scripts which send Apple events can send the "result file with name &lt;basename&gt;" command to the KosmicTask application object.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">The easiest way to determine what method to use for a particular scripting language is to examine the 'file' or 'files' template or read the usage document in the Resource Browser.</span></p>
<p class="p11"><span class="s1"><b>Scripting Language Support</b></span></p>
<p class="p7"><span class="s1">KosmicTask uses an extensible plug architecture to support a wide range of scripting languages. By design support is included for all the scripting languages that are present as part of a standard OS X 10.6 installation. When such a task is executed its script is passed to the local scripting subsystem for execution.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">In addition, KosmicTask includes a number of additional scripting languages. Support for these languages is wholly embedded in the application bundle and nothing is installed outside of the application itself.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">KosmicTask supports both interpreted scripting languages (such as Php and Perl) and those that are compiled (such as AppleScript and Java).</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">Support is also included for a number of Cocoa bridges. These bridges are extremely powerful and enable scripts to access all the power and functionality of the OS X Cocoa framework.<span class="Apple-converted-space"> </span></span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">KosmicTask supports the scripting of tasks in the following languages:</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1"><b>AppleScript</b></span></p>
<p class="p7"><span class="s1"><b>Bash</b> shell</span></p>
<p class="p7"><span class="s1"><b>C</b> shell</span></p>
<p class="p7"><span class="s1"><b>C</b> (embedded)</span></p>
<p class="p7"><span class="s1"><b>C++</b> (embedded)</span></p>
<p class="p7"><span class="s1"><b>Java</b></span></p>
<p class="p7"><span class="s1"><b>Javascript</b></span></p>
<p class="p7"><span class="s1"><b>Korn</b> shell</span></p>
<p class="p7"><span class="s1"><b>Lua</b> (embedded)</span></p>
<p class="p7"><span class="s1"><b>Perl</b></span></p>
<p class="p7"><span class="s1"><b>PHP</b></span></p>
<p class="p7"><span class="s1"><b>Python</b></span></p>
<p class="p7"><span class="s1"><b>Ruby</b></span></p>
<p class="p7"><span class="s1"><b>Tcl</b></span></p>
<p class="p7"><span class="s1"><b>Tenex</b> C shell</span></p>
<p class="p7"><span class="s1"><b>Z</b> shell</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">(C and C++ interpreted scripting support is provided by CINT)</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">KosmicTask supports Cocoa framework scripting using the following bridges and components:</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1"><b>AppleScriptObjC</b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>AppleScript bridge</span></p>
<p class="p7"><span class="s1"><b>F-Script</b> (embedded)<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>F-Script Cocoa scripting environment</span></p>
<p class="p7"><span class="s1"><b>JSCocoa</b> (embedded)<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>JavaScript bridge</span></p>
<p class="p7"><span class="s1"><b>LuaCocoa</b> (embedded)<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Lua bridge</span></p>
<p class="p7"><span class="s1"><b>PyObjC</b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Python bridge</span></p>
<p class="p7"><span class="s1"><b>RubyCocoa</b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Ruby bridge</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">Within KosmicTask these components are represented by the following standardised names (in the order as listed above):</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1"><b>AppleScript Cocoa</b></span></p>
<p class="p7"><span class="s1"><b>F-Script Cocoa</b></span></p>
<p class="p7"><span class="s1"><b>JavaScript Cocoa</b></span></p>
<p class="p7"><span class="s1"><b>Lua Cocoa</b></span></p>
<p class="p7"><span class="s1"><b>Python Cocoa</b></span></p>
<p class="p7"><span class="s1"><b>Ruby Cocoa</b></span></p>
<p class="p14"><span class="s1"><b></b></span><br></p>
<p class="p11"><span class="s1"><b>Cocoa Based Tasks</b></span></p>
<p class="p7"><span class="s1">Cocoa based tasks have a great advantage when it comes to generating task results in that they can returned native data structures. KosmicTask will receive the result via the bridge and return it to the user.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">Thus, Cocoa based tasks can generate complex results using the relevant scripting language native data structures such as arrays and dictionaries. Native dictionaries can be used to provide a fast and efficient way of returning the contents of files as results.</span></p>
<p class="p11"><span class="s1"><b>Cocoa Based Application Tasks</b></span></p>
<p class="p7"><span class="s1">Tasks which utilise the Cocoa framework are run as fully fledged Cocoa applications.<span class="Apple-converted-space"> </span></span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">Many Cocoa components require the existence of a run loop in order to be utilised to their full potential. Normally, application tasks exit when the function that launches them exists. Cocoa based tasks, however, can request that they be allowed to continue running in order to receive further input from runloop sources. When the task determines that it is complete it terminates itself and the task results are returned to the user.</span></p>
<p class="p11"><span class="s1"><b>Comparing Standard and Cocoa Based Language Implementations</b></span></p>
<p class="p7"><span class="s1">The differences between the standard and Cocoa variants of any scripting language can be summarised as follows:</span></p>
<p class="p9"><span class="s1"></span><br></p>
<ol class="ol1">
  <li class="li7"><span class="s1">Most standard scripting components run as external command line based process (though the likes of JavaScript does not).</span></li>
  <li class="li7"><span class="s1">The standard scripting components are less complex and will load faster than the Cocoa variants.</span></li>
  <li class="li7"><span class="s1">The Cocoa based scripting components run in process with their task runner.</span></li>
  <li class="li7"><span class="s1">The Cocoa based scripting components will generally use more system resources than the standard components.<span class="Apple-converted-space"> </span></span></li>
</ol>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">We can take the examples of Ruby and RubyCocoa to illustrate the above points.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">When a standard Ruby task is executed an instance of the KosmicTaskRubyRunner program is launched (this will be visible in the Activity Monitor application). This program receives the task request from the KosmicTask server component and launches a separate instance of the Ruby command line system (also visible in the Activity Monitor). The task runner passes the task inputs to Ruby and waits for the task results to be returned. When the Ruby instance terminates the task runner formats the task results and returns them to the server component which then transfers them via the network to the user.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">When a RubyCocoa task is executed an instance of the KosmicTaskRubyCocoaRunner program is launched. This program executes as a fully fledged Cocoa application complete with runloop. Once successfully launched the task runner loads the Cocoa task into its own process space and executes the designated run function on the designated run class. When the initial run function returns the task runner checks the status of the KosmicTaskController keepTaskAlive property. If the task requests that it be kept alive then the task is allowed to continue executing until it calls the KosmicTaskController stopTask: method. If the task does not request to be kept alive then the task run loop is stopped immediately.</span></p>
<p class="p11"><span class="s1"><b>Automation Support and System-wide Scripting</b></span></p>
<p class="p7"><span class="s1">OS X provides a powerful mechanism for automating and controlling system resources and applications using Apple events. AppleScript has been the traditional means of achieving this but now there are other powerful and more intuitive alternatives.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">OS X includes a technology called Scripting Bridge which allows Cocoa based applications to automate other services by sending Apple events. All of the Cocoa capable scripting components supported by KosmicTask can utilise this technology to achieve automation. Scripting Bridge therefore means that automation can be achieved by a much wider range of scripting languages than was previously possible.</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">But there is another alternative…</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p12"><span class="s1">Apple events are complex and the desired interaction between the controlling script and the targeted application or service can sometimes be difficult to achieve. The appscript component, which is available to the Python and Ruby scripting components, provides an alternative means of generating, sending and interpreting Apple events.</span></p>
<p class="p11"><span class="s1"><b>Security</b></span></p>
<p class="p7"><span class="s1">KosmicTask uses Transport Layer Security (the successor to SSL) to provide secure network communication. The OS X keychain is used for secure password storage and retrieval.</span></p>
<p class="p15"><span class="s1">13</span></p>
<p class="p16"><span class="s9">Copyright Mugginsoft LLP 2011</span><span class="s1">MugginsoftMugginsoftMugginsoft</span><span class="s10">mugginsoft</span></p>
<p class="p17"><span class="s1"></span><br></p>
<p class="p18"><span class="s1">MugginsoftMugginsoftMugginsoft</span></p>
</body>
</html>
