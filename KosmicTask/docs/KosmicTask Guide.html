<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1038.35">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 15.0px 0.0px; font: 36.0px 'Helvetica Neue'; color: #95b836}
    p.p2 {margin: 0.0px 0.0px 40.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    p.p3 {margin: 0.0px 0.0px 12.0px 0.0px; font: 16.0px 'Helvetica Neue'; color: #95b836}
    p.p4 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    p.p5 {margin: 0.0px 0.0px 12.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #94b736}
    p.p6 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d; min-height: 14.0px}
    p.p7 {margin: 0.0px 0.0px 6.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #95b836}
    p.p8 {margin: 0.0px 0.0px 40.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #95b836}
    p.p9 {margin: 0.0px 0.0px 40.0px 0.0px; font: 16.0px 'Helvetica Neue'; color: #95b836; min-height: 18.0px}
    p.p10 {margin: 0.0px 0.0px 9.0px 0.0px; font: 21.0px 'Helvetica Neue'; color: #95b836}
    p.p12 {margin: 0.0px 0.0px 9.0px 0.0px; font: 16.0px 'Helvetica Neue'; color: #95b836}
    p.p13 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #ff1213}
    p.p14 {margin: 0.0px 0.0px 12.0px 0.0px; font: 21.0px 'Helvetica Neue'; color: #95b836}
    p.p15 {margin: 0.0px 0.0px 12.0px 5.7px; font: 9.0px Monaco; color: #0c59cf}
    p.p16 {margin: 0.0px 0.0px 0.0px 5.7px; font: 9.0px Monaco; color: #0c59cf}
    p.p17 {margin: 0.0px 0.0px 40.0px 5.7px; font: 9.0px Monaco; color: #0c59cf}
    p.p18 {margin: 0.0px 0.0px 40.0px 0.0px; font: 21.0px 'Helvetica Neue'; color: #95b836}
    p.p19 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px Arial; color: #94b736}
    p.p20 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
    p.p21 {margin: 0.0px 0.0px 9.0px 0.0px; text-align: center; font: 14.0px 'Helvetica Neue'}
    p.p22 {margin: 0.0px 0.0px 12.0px 0.0px; text-align: center; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    p.p23 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d; min-height: 15.0px}
    p.p24 {margin: 0.0px 0.0px 40.0px 0.0px; font: 16.0px 'Helvetica Neue'; color: #95b836}
    p.p25 {margin: 0.0px 0.0px 40.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d; min-height: 14.0px}
    p.p27 {margin: 0.0px 0.0px 16.0px 0.0px; font: 21.0px 'Helvetica Neue'; color: #95b836}
    p.p28 {margin: 0.0px 0.0px 9.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #94b736}
    p.p29 {margin: 0.0px 0.0px 12.0px 0.0px; line-height: 21.0px; font: 14.0px 'Helvetica Neue'; color: #202020; min-height: 16.0px}
    p.p30 {margin: 0.0px 0.0px 14.0px 0.0px; line-height: 21.0px; font: 14.0px 'Helvetica Neue'; color: #202020; min-height: 16.0px}
    p.p31 {margin: 0.0px 0.0px 30.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d; min-height: 14.0px}
    p.p32 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #94b736}
    p.p33 {margin: 0.0px 0.0px 30.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    p.p34 {margin: 0.0px 0.0px 12.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #ff1213}
    p.p35 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 21.0px; font: 14.0px 'Helvetica Neue'; color: #1e39f6}
    p.p36 {margin: 0.0px 0.0px 12.0px 0.0px; line-height: 21.0px; font: 14.0px 'Helvetica Neue'; color: #ff1212}
    p.p37 {margin: 0.0px 0.0px 14.0px 0.0px; line-height: 21.0px; font: 14.0px 'Helvetica Neue'; color: #202020}
    p.p38 {margin: 0.0px 0.0px 40.0px 0.0px; line-height: 21.0px; font: 14.0px 'Helvetica Neue'; color: #202020; min-height: 16.0px}
    p.p39 {margin: 0.0px 0.0px 6.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #94b736}
    p.p40 {margin: 0.0px 0.0px 9.0px 0.0px; text-align: right; font: 9.0px 'Helvetica Neue Light'; color: #95b836}
    p.p41 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px 'Helvetica Neue'}
    p.p42 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: right; font: 7.0px 'Helvetica Neue Light'}
    p.p43 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: center; font: 36.0px 'Trebuchet MS'; min-height: 42.0px}
    p.p44 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: center; font: 7.0px 'Helvetica Neue Light'}
    li.li2 {margin: 0.0px 0.0px 40.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    li.li4 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    li.li11 {margin: 0.0px 0.0px 6.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    li.li26 {margin: 0.0px 0.0px 9.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #4d4d4d}
    span.s1 {letter-spacing: 0.0px}
    span.s2 {font: 12.0px 'Helvetica Neue'; letter-spacing: 0.0px color: #4d4d4d}
    span.s3 {font: 16.0px 'Helvetica Neue'; letter-spacing: 0.0px}
    span.s4 {font: 12.0px Arial; letter-spacing: 0.0px color: #94b736}
    span.s5 {font: 12.0px 'Helvetica Neue'; text-decoration: underline ; letter-spacing: 0.0px color: #ff1213}
    span.s6 {letter-spacing: 0.0px color: #4d4d4d}
    span.s7 {text-decoration: underline ; letter-spacing: 0.0px color: #ff1213}
    span.s8 {font: 12.0px 'Helvetica Neue'; text-decoration: underline ; letter-spacing: 0.0px color: #1022a3}
    span.s9 {font: 11.0px 'Helvetica Neue'; letter-spacing: 0.0px}
    span.s10 {text-decoration: underline ; letter-spacing: 0.0px}
    span.s11 {letter-spacing: 0.0px color: #94b736}
    span.s12 {letter-spacing: 0.0px color: #db4918}
    span.s13 {font: 9.0px 'Helvetica Neue'; letter-spacing: 0.0px color: #797979}
    span.s14 {font: 36.0px 'Trebuchet MS'; letter-spacing: 0.0px color: #95b836}
    span.Apple-tab-span {white-space:pre}
    table.t1 {background-color: #ffffff; border-collapse: collapse}
    td.td1 {width: 186.2px; height: 16.0px; background-color: #dbddc4; border-style: solid; border-width: 1.0px 1.0px 0.0px 1.0px; border-color: #929292 #929292 transparent #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td2 {width: 136.2px; height: 16.0px; background-color: #dbddc4; border-style: solid; border-width: 1.0px 1.0px 0.0px 1.0px; border-color: #929292 #929292 transparent #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td3 {width: 236.3px; height: 16.0px; background-color: #dbddc4; border-style: solid; border-width: 1.0px 1.0px 0.0px 1.0px; border-color: #929292 #929292 transparent #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td4 {width: 186.2px; height: 15.0px; border-style: solid; border-width: 0.0px 1.0px 1.0px 1.0px; border-color: transparent #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td5 {width: 136.2px; height: 15.0px; border-style: solid; border-width: 0.0px 1.0px 1.0px 1.0px; border-color: transparent #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td6 {width: 236.3px; height: 15.0px; border-style: solid; border-width: 0.0px 1.0px 1.0px 1.0px; border-color: transparent #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td7 {width: 186.2px; height: 15.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td8 {width: 136.2px; height: 15.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td9 {width: 236.3px; height: 15.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td10 {width: 186.2px; height: 15.0px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td11 {width: 136.2px; height: 15.0px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td12 {width: 236.3px; height: 15.0px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td13 {width: 121.6px; height: 16.0px; background-color: #dbddc4; border-style: solid; border-width: 1.0px 1.0px 0.0px 1.0px; border-color: #929292 #929292 transparent #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td14 {width: 152.8px; height: 16.0px; background-color: #dbddc4; border-style: solid; border-width: 1.0px 1.0px 0.0px 1.0px; border-color: #929292 #929292 transparent #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td15 {width: 153.8px; height: 16.0px; background-color: #dbddc4; border-style: solid; border-width: 1.0px 1.0px 0.0px 1.0px; border-color: #929292 #929292 transparent #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td16 {width: 121.6px; height: 15.0px; border-style: solid; border-width: 0.0px 1.0px 1.0px 1.0px; border-color: transparent #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td17 {width: 152.8px; height: 15.0px; border-style: solid; border-width: 0.0px 1.0px 1.0px 1.0px; border-color: transparent #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td18 {width: 153.8px; height: 15.0px; border-style: solid; border-width: 0.0px 1.0px 1.0px 1.0px; border-color: transparent #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td19 {width: 121.6px; height: 33.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td20 {width: 152.8px; height: 33.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td21 {width: 153.8px; height: 33.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td22 {width: 121.6px; height: 15.0px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td23 {width: 152.8px; height: 15.0px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td24 {width: 153.8px; height: 15.0px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td25 {width: 121.6px; height: 15.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td26 {width: 152.8px; height: 15.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    td.td27 {width: 153.8px; height: 15.0px; background-color: #f5f3ea; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #929292 #929292 #929292 #929292; padding: 4.0px 4.0px 4.0px 4.0px}
    ol.ol1 {list-style-type: decimal}
  </style>
</head>
<body>
<p class="p1"><span class="s1">KosmicTask</span></p>
<p class="p2"><span class="s1">The Secure Integrated Scripting Environment for OS X</span></p>
<p class="p3"><span class="s1">Guide</span></p>
<p class="p4"><span class="s1">Updated May 2011</span></p>
<p class="p4"><span class="s1">Copyright Mugginsoft LLP</span></p>
<p class="p5"><span class="s2"></span><span class="s1">Table of Contents</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">Overview<span class="Apple-tab-span">	</span>2</span></p>
<p class="p7"><span class="s1">Quick Introduction and Guides<span class="Apple-tab-span">	</span>4</span></p>
<p class="p7"><span class="s1">Introduction<span class="Apple-tab-span">	</span>7</span></p>
<p class="p7"><span class="s1">How KosmicTask Works<span class="Apple-tab-span">	</span>44</span></p>
<p class="p8"><span class="s1">Getting Started<span class="Apple-tab-span">	</span>62</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p10"><span class="s3"></span><span class="s1">Overview</span></p>
<p class="p4"><span class="s1">KosmicTask is a Secure Integrated Scripting Environment for OS X.</span></p>
<p class="p4"><span class="s1">KosmicTask can create, edit, execute and share script based tasks using a wide range of scripting languages.</span></p>
<p class="p4"><span class="s1">KosmicTask provides the following basic functionality:</span></p>
<ul>
  <li class="li11"><span class="s1">A central repository of script powered tasks.</span></li>
  <li class="li11"><span class="s1">A publishing idiom that allows for public and trusted user access to tasks.</span></li>
  <li class="li11"><span class="s1">A multi-tabbed iTunes like interface.</span></li>
  <li class="li11"><span class="s1">A comprehensive history of task requests and results.</span></li>
  <li class="li11"><span class="s1">Local and remote task editing and configuration.</span></li>
  <li class="li11"><span class="s1">Integrated file transfer capabilities.</span></li>
  <li class="li11"><span class="s1">Flexible representation of task results.</span></li>
  <li class="li11"><span class="s1">Full local and remote search capabilities.</span></li>
  <li class="li11"><span class="s1">Bonjour support for automatic discovery over local networks.</span></li>
  <li class="li11"><span class="s1">Run task server at login functionality.</span></li>
  <li class="li11"><span class="s1">Secure network communication via SSL.</span></li>
  <li class="li11"><span class="s1">Support for task sharing over the Internet.</span></li>
  <li class="li4"><span class="s1">Integrated error console.</span></li>
</ul>
<p class="p2"><span class="s1">KosmicTask is available as a time limited trial. After the trial version expires you will be able to read but not execute any tasks that you have created until a full licence is purchased and installed.</span></p>
<p class="p12"><span class="s1">System Requirements</span></p>
<ul>
  <li class="li11"><span class="s1">Mac OS X 10.6</span></li>
  <li class="li2"><span class="s1">50 MB free hard disk space</span></li>
</ul>
<p class="p3"><span class="s1">Getting Support</span></p>
<p class="p4"><span class="s1">Their are a number of ways to request support for KosmicTask.</span></p>
<p class="p4"><span class="s4"><b>Application.</b></span><span class="s1"> From the application menu select <b>KosmicTask - Feedback and Support...</b></span></p>
<p class="p4"><span class="s4"><b>Forum</b></span><span class="s1">. Visit the the support forum at <a href="http://forum.mugginsoft.com"><span class="s5">forum.mugginsoft.com</span></a></span></p>
<p class="p13"><span class="s4"><b>Website.</b></span><span class="s6"> Visit the support website at <a href="http://www.mugginsoft.com/kosmictask/support"><span class="s7">www.mugginsoft.com/kosmictask/support</span></a></span></p>
<p class="p4"><span class="s4"><b>Email.</b></span><span class="s1"> Send an email request to <a href="mailto:support@mugginsoft.com"><span class="s5">support@mugginsoft.com</span></a></span></p>
<p class="p14"><span class="s2"></span><span class="s1">Quick Introduction and Guides</span></p>
<p class="p3"><span class="s1">Task Based Scripting</span></p>
<p class="p4"><span class="s1">A Task contains a script and a list of the inputs that it requires. When a task is executed the user is queried for the task inputs, the task is executed and the results are returned to the user.</span></p>
<p class="p2"><span class="s1">Tasks may be published, enabling them to be accessed and executed by any other network connected KosmicTask user. In addition, users that are able to authenticate over the network will be able to create, edit and execute tasks on the remote machine.</span></p>
<p class="p3"><span class="s1">Quick Guide to Running Tasks</span></p>
<p class="p4"><span class="s1">To run a task simply select it from the left hand sidebar. Enter any inputs that are required and click either the large green run button or the run button the menu bar. Task results will be displayed in the adjoining pane. To save the task results select <b>File</b> - <b>Save</b> <b>As</b>… from the menu.</span></p>
<p class="p4"><span class="s1">Initially only tasks available to all users will be displayed (this is is the <b>Public</b> task view). To access all tasks on the machine select the <b>User</b> task view above the sidebar.</span></p>
<p class="p2"><span class="s1">To run tasks on another machine simply select the machine name and the required task from the sidebar. To access user tasks on the remote machine you will be asked to authenticate. Enter a valid OS X username and password. By default all exchanges with remote machines are secure.</span></p>
<p class="p3"><span class="s1">Quick Guide to Creating Tasks</span></p>
<p class="p4"><span class="s1">To create a task select the <b>Admin</b> task view and click <b>New</b> on the toolbar.</span></p>
<p class="p4"><span class="s1">Then, in the displayed <b>Edit</b> window:</span></p>
<ul>
  <li class="li11"><span class="s1">Enter task name, script type, group and description in the first pane.</span></li>
  <li class="li11"><span class="s1">If the Task requires inputs click + to add. Enter the input name and select its type.</span></li>
  <li class="li11"><span class="s1">Click Edit button in the toolbar and select a template from the displayed list. Edit the task.</span></li>
  <li class="li11"><span class="s1">Build the task if required (it is optional for some task types).</span></li>
  <li class="li11"><span class="s1">Click the Run button to display the test pane.</span></li>
  <li class="li11"><span class="s1">Run and test the task.</span></li>
  <li class="li2"><span class="s1">Close the Edit window and click Save to save the task.</span></li>
</ul>
<p class="p3"><span class="s1">Quick Usage Guide</span></p>
<p class="p4"><span class="s1">KosmicTask can be used in a wide range of different situations and has features that appeal to various classes of users.</span></p>
<p class="p4"><span class="s4"><b>Home</b></span><span class="s1">. Use KosmicTask on a single Mac or home network to carry out repetitive administration and automation tasks. Non technical users can easily utilise existing tasks. More technical users will find that there is a wealth of scripts available on the Internet that they can easily adapt to their purpose.</span></p>
<p class="p4"><span class="s4"><b>Business</b></span><span class="s1">. KosmicTask is an effective tool for sharing business automation tasks with end users. Document processing, file processing and automation based services can all be configured from within the application and shared out to clients on the network.</span></p>
<p class="p4"><span class="s4"><b>Education</b></span><span class="s1">. KosmicTask provides a great way of introducing students to a wide range of scripting languages. The application comes with a range of both native OS X and embedded scripting languages. Students can develop and test scripts on own machine whilst educators can review and appraise their tasks via the network.</span></p>
<p class="p4"><span class="s4"><b>System Administration</b></span><span class="s1">. Systems and network administrators will find that the application is a convenient and secure method of providing user scripts and performing script based network maintenance.</span></p>
<p class="p4"><span class="s4"><b>Software Development</b></span><span class="s1">. Developers can use KosmicTask to quickly prototype code ideas. It is also useful for building and organising a library of executable code samples and snippets.</span></p>
<p class="p4"><span class="s4"><b>Science and Technology</b></span><span class="s1">. The distributed task model means that the application is ideally suited to data acquisition and processing projects. Tasks can be configured to collect and process data on the remote target before returning the results for further analysis and persistence.</span></p>
<p class="p14"><span class="s2"></span><span class="s1">Introduction</span></p>
<p class="p4"><span class="s1">KosmicTask is a tool for creating and sharing script powered tasks on OS X.<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">So what is a task? A task is simply any operation that is required to be carried out repetitively.<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">Some simple examples might be:</span></p>
<ul>
  <li class="li11"><span class="s1">Convert a Word document file into HTML.</span></li>
  <li class="li11"><span class="s1">Turn down the volume on a mac playing iTunes in another room.</span></li>
  <li class="li4"><span class="s1">Find out what my router’s IP address is.</span></li>
</ul>
<p class="p4"><span class="s1">Each of these operations can be achieved by issuing commands to OS X.</span></p>
<p class="p4"><span class="s1">A task simply contains a number of such commands. When a task is run KosmicTask prompts the user for any inputs that the task requires. The task then executes its commands and returns any results to the user.<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">Simple!</span></p>
<p class="p2"><span class="s1">KosmicTask includes a range of predefined tasks and a wide selection of task templates to get you started.<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1">Getting Started with Commands</span></p>
<p class="p4"><span class="s1">The simplest way to send commands to your mac is to use the Terminal application.<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">So, for example, we can convert a Microsoft Word format document into html by typing the following command into the Terminal:</span></p>
<p class="p15"><span class="s1">textutil -convert html "/Users/Mugginsoft/Documents/My Word Document.doc"</span></p>
<p class="p4"><span class="s1">Executing this command will create an html file called MyWord.html.<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">We can automate this operation by saving the above command into a file. Then all we have to do is run the file whenever we want to convert our file. The Terminal application sends commands to the Bash shell by default. The shell accepts the commands and executes them. So the above is an example of a simple Bash script.</span></p>
<p class="p2"><span class="s1">Scripting is an extremely powerful means of controlling your mac and KosmicTask makes it easy to create, organise, execute and share such scripts as tasks.</span></p>
<p class="p3"><span class="s1">Scripting and All That</span></p>
<p class="p4"><span class="s1">The first thing to say about scripting is that it is fun!</span></p>
<p class="p4"><span class="s1">You don’t have to be a programmer to have a go at using KosmicTask to create script powered tasks. There are lots of scripting resources available on the Internet and KosmicTask makes it easy to use an existing script as a starting point.</span></p>
<p class="p4"><span class="s1">Scripts can be very simple, like the one above, or much more complex. OS X also supports a wide range of different scripting languages each of which has different characteristics. KosmicTask also includes a number of additional scripting languages.</span></p>
<p class="p2"><span class="s1">So let’s have a go at creating a task!</span></p>
<p class="p3"><span class="s1">Creating a Task</span></p>
<p class="p4"><span class="s1">The objective of our task is to save an iWork 09 Pages document as HTML. The current version of Pages can export documents as PDF, Word, rich text, plain text and ePub but not as HTML.</span></p>
<p class="p4"><span class="s1">A bit of searching on the Internet reveals that a workable solution is to save the Pages document as a rich text (RTF) file and convert the RTF document to HTML using the <b>textutil</b> OS X command. Now we don't know anything about the <b>textutil</b> command but an Internet search for "textutil" leads us to the <a href="http://developer.apple.com/library/mac/%23documentation/Darwin/Reference/ManPages/man1/textutil.1.html"><span class="s5">Apple manual page</span></a> for this command. Here we can see what options are available for our command (we can also get to the manual page by typing "man textutil" into the Terminal app).</span></p>
<p class="p4"><span class="s1">We want to convert a file so our basic command looks something like:</span></p>
<p class="p15"><span class="s1">textutil -convert html "/Users/Jonathan/Documents/My Pages document.rtf"</span></p>
<p class="p4"><span class="s1">Note that our file name contains a space. Hence we need to enclose it in quote marks.</span></p>
<p class="p4"><span class="s1">Now that we know what we are doing it's time to create our task:</span></p>
<ul>
  <li class="li11"><span class="s1">First <a href="http://www.mugginsoft.com/download/KosmicTask.zip"><span class="s5">download</span></a> and install KosmicTask.</span></li>
  <li class="li11"><span class="s1">Open the application and click the <b>Admin</b> button.</span></li>
  <li class="li4"><span class="s1">Click the <b>New</b> button in the toolbar (or menu item <b>File</b> - <b>New Task</b> <b>⌘N</b>).</span></li>
</ul>
<p class="p4"><span class="s1">A task edit window will open to allow us to define, edit and test our task.<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">In general we need to enter at least 4 pieces of information to define our task:</span></p>
<ul>
  <li class="li11"><span class="s1">A Name. "Convert My Text File" sounds good to me.</span></li>
  <li class="li11"><span class="s1">A Script type. In this case we want to select <b>Bash shell</b>.</span></li>
  <li class="li11"><span class="s1">A Group to put our task in. I chose "My File Utilities<b>"</b>.</span></li>
  <li class="li4"><span class="s1">A Short Description. Something like "Convert a text file to HTML".</span></li>
</ul>
<p class="p2"><span class="s1">That's it. Time to enter our script.</span></p>
<p class="p3"><span class="s1">Editing the Task Script</span></p>
<p class="p4"><span class="s1">To edit the script for our task click the <b>Edit</b> button in the toolbar. A list of script templates will be displayed.</span></p>
<p class="p4"><span class="s1">KosmicTask includes templates for a wide range of scripting languages. These templates serve as starting points for basic task activities. Because we previously selected <b>Bash shell</b> as our script type we are presented with a list of suitable Bash templates. The simplest of these is called <b>Hello Kosmos</b>. Select it and click OK.</span></p>
<p class="p4"><span class="s1">The selected template contains some comments at the top and a single command which says:</span></p>
<p class="p15"><span class="s1"># send result to stdout<br>
echo "Hello, kosmos!"</span></p>
<p class="p4"><span class="s1">Note: Every line that starts with a # is a comment and won't be interpreted as a command.</span></p>
<p class="p4"><span class="s1">Delete these two lines and replace them with our command like so:</span></p>
<p class="p15"><span class="s1"># convert file to html<br>
textutil -convert html "/Users/Jonathan/Documents/My Pages document.rtf"</span></p>
<p class="p4"><span class="s1">Now, your username probably won't be Jonathan so edit this to replace Jonathan with your username. It will normally be displayed in the top right hand corner of your screen. Alternatively you can open up the finder and navigate to your Documents folder. The Path Bar at the bottom will show the full path to your Documents folder.</span></p>
<p class="p4"><span class="s1">So now our script should look like:</span></p>
<p class="p15"><span class="s1"># convert file to html<br>
textutil -convert html "/Users/&lt; MY USERNAME HERE ! &gt;/Documents/My Pages document.rtf"</span></p>
<p class="p2"><span class="s1">That's it. Our script is ready to go!</span></p>
<p class="p3"><span class="s1">Testing Our Task</span></p>
<p class="p4"><span class="s1">To test out our new task click the square <b>Run</b> button.</span></p>
<p class="p4"><span class="s1">Now our task expects to find a file named "My Pages document.rtf" in our Documents folder. So let's create one (if you don't have Pages installed either download the <a href="http://www.apple.com/iwork/download-trial/"><span class="s5">iWork trial</span></a></span><span class="s7"> </span><span class="s1">or see below).</span></p>
<ol class="ol1">
  <li class="li4"><span class="s1">Open Pages and create a new document.</span></li>
  <li class="li4"><span class="s1">Type "I once was a Pages document!".</span></li>
  <li class="li4"><span class="s1">Select the text and change the font size to 24 and the colour to green (I chose the Fern crayon).</span></li>
  <li class="li4"><span class="s1">Save the document to your Documents folder as "My Pages Document".</span></li>
  <li class="li4"><span class="s1">Select menu <b>File</b> - <b>Export</b> and export as RTF to your Documents folder.</span></li>
</ol>
<p class="p4"><span class="s1">To run the task click the <b>Play</b> button in the toolbar or the large blue <b>Play</b> icon.<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">If you see something like the following then the task cannot find the required file:</span></p>
<p class="p15"><span class="s1">STDERR output:<br>
Error reading /Users/Jonathan/Documents/My Pages Document.rtf. The file doesn’t exist.</span></p>
<p class="p4"><span class="s1">If the above occurs use the Finder to verify that the file is named correctly and is in the Documents folder. Then try and run the task again.</span></p>
<p class="p4"><span class="s1">If you don't get an error message but simply a blank result in the right hand panel then the task succeeded. Open the Finder and navigate to you Documents folder. Double click on "My Pages document.html" to open the file in your browser.</span></p>
<p class="p2"><span class="s1">Okay, our task works so we better save it. Select menu <b>File</b> - <b>Save</b> <b>⌘S</b>.</span></p>
<p class="p3"><span class="s1">Improving Our Task<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">So we have achieved our basic goal but things are not as good as they could be. For instance it would be a lot better if a successful task execution produced a better output than a blank screen.</span></p>
<p class="p4"><span class="s1">So we will edit our task script to display a message when the task succeeds. Click the <b>Edit</b> button to go back to the edit view and change our script to read:</span></p>
<p class="p15"><span class="s1"># convert file to html<br>
textutil -convert html "/Users/Jonathan/Documents/My Pages Document.rtf"<br>
echo "HTML file saved to Documents folder"</span></p>
<p class="p4"><span class="s1">Remember, change Jonathan to your username in the above example!</span></p>
<p class="p4"><span class="s1">Our improvement is to simply to print a helpful message. To do this we use the bash "echo" command. By Default KosmicTask returns all a task's printed output as part of the task results. So to return text to the user, in any of the supported scripting languages, all we do is print the text to the screen (or to be precise, send the text to stdout).</span></p>
<p class="p4"><span class="s1">Now run the task again. Instead of a blank screen we now get a message informing us that the converted file is available in our Documents folder. This is definitely an improvement.</span></p>
<p class="p2"><span class="s1">However there are still some problems. Notable amongst these are that we are only able to convert a single named file within our Documents folder. It would be much better if we could specify which file we wanted to convert when the file was run. That way we can use our task to convert any RTF file to HTML. This will be our next improvement.</span></p>
<p class="p3"><span class="s1">Defining a Task Input</span></p>
<p class="p4"><span class="s1">To define a task input first click the Task button to display the task input view. Then click the <b>+</b> button labelled <b>Task Inputs</b>. A new task input pane will appear.</span></p>
<p class="p4"><span class="s1">A task can accept a number of inputs of various types. When the task is run the inputs' values are passed to the task and can be accessed by the task script. The input types that are supported include Text, Numbers, List items, Dates and File Contents.</span></p>
<p class="p4"><span class="s1">To create an input we need to define at least two or three things:</span></p>
<ul>
  <li class="li11"><span class="s1">A Name. I chose "Text file".</span></li>
  <li class="li11"><span class="s1">An input Type. In this case we want to select <b>File Contents</b>.</span></li>
  <li class="li4"><span class="s1">A Description. Something like "Text file to be converted" will do.</span></li>
</ul>
<p class="p4"><span class="s1">That's it for the input. Now we need to adjust the task script so click the <b>Edit</b> button and change the script to the following:</span></p>
<p class="p15"><span class="s1"># convert file to html<br>
textutil -convert html "$1"<br>
echo "HTML file saved to Documents folder"</span></p>
<p class="p4"><span class="s1">Now enter the Run edit view again. Note that this time the left panel contains a file input panel. Click the <b>Select</b> button and choose our test RTF file again. Now when the task is run whatever RTF file we select gets converted to HTML.</span></p>
<p class="p4"><span class="s1">We have modified our script to convert a file called $1. When a bash script is run it can can accept a list of N inputs which are numbered $1 to $N. KosmicTask takes our input file name and passes it into the script as $1. All of the scripting languages supported by KosmicTask can accept task inputs. Each of them accesses arguments in their own way but the principle is always the same.</span></p>
<p class="p2"><span class="s1">Now we can convert RTF files of any type to HTML. This is apparently another improvement. However, there is a problem! If we delete the existing converted HTML file from our Documents folder and run the task we will find that even though the task succeeds the converted file does not appear. In order to understand why we need to think a bit more about how KosmicTask handles files as inputs and results.</span></p>
<p class="p3"><span class="s1">Handling Files</span></p>
<p class="p4"><span class="s1">As well as creating and running tasks KosmicTask allows us to share tasks. This means that we can allow other KosmicTask users to run tasks that we have created. This is a powerful idea. The task that I create to convert Pages documents to HTML can now be used by any other KosmicTask user on the local network to convert their Pages documents to HTML too.</span></p>
<p class="p4"><span class="s1">So lets say that Barbara wants to convert a file using a task on Alice's computer. The contents of the file will obviously have to be sent to Alice's computer where they can be converted by Alice's task. There is no point just leaving the converted file on Alice's computer where Barbara cannot access it so Alice needs to return the converted file to Barbara. Barbara can then save the converted file on her own computer. The way that KosmicTask handles files has been designed to keep both Alice and Barbara happy.</span></p>
<p class="p4"><span class="s1">When we created our task input recall that the input was called <b>File Contents</b>. Even when we are just running a task that exists on our local computer this input sends the contents of the file, not its path, to the task. When the task receives the file contents it saves them temporarily and passes that temporary path into the script. We can demonstrate this by modifying our task script like so:</span></p>
<p class="p15"><span class="s1"># convert file to html<br>
textutil -convert html "$1"<br>
echo "file path = $1"</span></p>
<p class="p4"><span class="s1">If we run the task with this script we should see something like:</span></p>
<p class="p15"><span class="s1">file path = /Users/Jonathan/Library/Caches/com.mugginsoft.kosmictaskserver.files/xX4cVMVdKa-KosmicTempFile-.My Pages Document.rtf</span></p>
<p class="p4"><span class="s1">This reveals where our temporary copy of our input file is stored. This happens regardless of wether the input file already exists on the local computer or has been sent from another machine on the local network. It also explains why we don't see our converted file appearing in our Documents folder. By default the textutil command creates the converted file in the same folder as the input file. This is not what we want. What we want is to return the converted file to the task user. KosmicTask makes this easy.</span></p>
<p class="p4"><span class="s1">To return the converted file as a task result we modify the task script like so:</span></p>
<p class="p16"><span class="s1"># convert file to html<br>
textutil -convert html -output result.html "$1"</span></p>
<p class="p15"><span class="s1">echo "---"<br>
echo "{KosmicFile: result.html}"</span></p>
<p class="p4"><span class="s1">See the next section for an explanation of how this works. Note that we have an extra option to the textutil command to save our converted file as result.html.</span></p>
<p class="p2"><span class="s1">Now when we run the task and select our RTF document the task result consists of an HTML file icon. Double clicking the icon will display a preview of the file content. The file can be saved by selecting menu <b>File</b> - <b>Save "result.html" As...</b></span></p>
<p class="p3"><span class="s1">KosmicTask Result Handling</span></p>
<p class="p4"><span class="s1">Many tasks can return results simply by printing (or echo'ing in the case of out example). If the required result is simply a piece of text or a number then nothing further is required. In order to handle more complex results such as files and lists of objects KosmicTask uses a standard syntax to identify the structure of the result. The syntax used is called <a href="http://en.wikipedia.org/wiki/YAML"><span class="s8">YAML</span></a> and is easy for a task to generate and for you to read. You can read a lot more about result handling in the KosmicTask Guide.</span></p>
<p class="p4"><span class="s1">In order to return a structured result we simply need to print the the structure using our YAML syntax and make use of a number of keywords.</span></p>
<p class="p4"><span class="s1">When returning a structured result in this way we first print the YAML document marker:</span></p>
<p class="p15"><span class="s1">echo "---"</span></p>
<p class="p4"><span class="s1">This identifies the result as a structured result and KosmicTask will attempt to interpret the result so. If there is an error anywhere in the printed result then KosmicTask will simply return the result string and will not attempt to decode it further.</span></p>
<p class="p4"><span class="s1">Next we make use of the <b>KosmicFile</b> keyword. This informs KosmicTask that the value associated with the keyword is a file to be returned as part of the task result.</span></p>
<p class="p15"><span class="s1">echo "{KosmicFile: result.html}"</span></p>
<p class="p2"><span class="s1">The curly braces are YAML syntax for associating a value with a key. When KosmicTask scans such a result it notes the presence of the KosmicFile key and returns the contents of the indicated file as part of the task result.</span></p>
<p class="p3"><span class="s1">Result File Handling</span></p>
<p class="p4"><span class="s1">In our example we simply chose result.html as our file name and you might think, well, what happens if this file already exists? In this case KosmicTask has created a temporary, initially empty, working directory for us so we can confidently create new files without worrying about old files.</span></p>
<p class="p4"><span class="s1">Another question might be, well if I share my task over the network and everyone starts using it won't I soon accumulate lots of copies of their converted files? The answer is no. When a task completes KosmicTask deletes all the files that were created in the tasks working directory. All other files created by a task in other directories remain untouched.</span></p>
<p class="p4"><span class="s1">In fact the different scripting languages supported by KosmicTask handle the temporary files created by tasks in different ways depending on their requirements. The same principal applies that if the file is created in the recommended manner it will be automatically deleted when the task completes.</span></p>
<p class="p2"><span class="s1">For any particular scripting language the best way to find out how to create task result files is to open the Resource Browser (menu <b>Window</b> - <b>Resource Browser</b>). Each language defines a File template that demonstrates how to correctly create result files. In addition you can refer to the usage document that is included in the browser for each scripting language (select the <b>Documents</b> item for your scripting language with the Resource Browser left hand pane).<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1">Improving Our Task - Part 2</span></p>
<p class="p4"><span class="s1">Now our task is genuinely useful. We can convert a selected RTF file into HTML and we can even share our task over the network. However we still have to launch Pages, open our Pages document, export our document as RTF and then convert it using KosmicTask. It would certainly be better if our task could achieve all this too.</span></p>
<p class="p4"><span class="s1">Many applications on OS X are scriptable. This means that our task can send a scriptable application specific commands and queries. Using this approach we can construct a task that talks to Pages and converts our file as required.</span></p>
<p class="p4"><span class="s1">Not all applications are scriptable however. A simple way to determine if an application can be automated in this way is to search the Internet for examples. A more exact way is to open the <b>AppleScript Editor</b> application and choose menu <b>File</b> - <b>Open Dictionary... </b>to display a browsable list of scriptable applications.<b> </b>Each scriptable application maintains a dictionary of the commands that it responds to. If your target application appears in the displayed list then you can automate it. Pages does provide a command dictionary (or terminology as it is commonly known) and selecting it in the browser displays a list of all the commands that it accepts.</span></p>
<p class="p2"><span class="s1">Now all we have to do is figure out how to make Pages dance.</span></p>
<p class="p3"><span class="s1">Automation Basics</span></p>
<p class="p4"><span class="s1">There are number of ways that we can follow to automate Pages. Unfortunately none of them involve using a bash script! This means that we will have to adopt another scripting language in order to further enhance our script. This is a common occurrence when writing tasks. However, KosmicTask supports a wide range of scripting languages and this makes it easy to rework a task. In this case we will rework our task as an AppleScript powered task.</span></p>
<p class="p4"><span class="s7"><a href="http://en.wikipedia.org/wiki/AppleScript">AppleScript</a></span><span class="s1"> is an OS X scripting language that is ideally suited for automating applications. The commands sent to our application are composed of discrete packets of information known as <a href="http://en.wikipedia.org/wiki/AppleEvents"><span class="s5">AppleEvents</span></a> and AppleScript is one of the most popular ways of generating and sending these events. Note that there other ways of automating applications and we will explore these later.</span></p>
<p class="p2"><span class="s1">Rather than modifying our original bash task lets work on a copy. So close the edit window and save our task when prompted. In the main application window make sure our conversion task is selected and click the <b>Duplicate</b> button in the toolbar.</span></p>
<p class="p3"><span class="s1">Moving from Bash to AppleScript</span></p>
<p class="p4"><span class="s1">The first thing we need to do is to rework our bash script into AppleScript. The easiest way to accomplish this is to use one of the existing AppleScript templates. Select the script edit view and click the <b>Template</b> button in the toolbar. In the left hand resource browser select <b>AppleScript</b> - <b>Application</b> - <b>Templates</b> to display all the available AppleScript templates. Select the File template. Our bash script will be replaced and our script type changed to AppleScript.</span></p>
<p class="p4"><span class="s1">One notable difference between our bash script and AppleScript is that our AppleScript task will have to be built before we run it. Click the <b>Build</b> button in the toolbar. If there are any errors in the script you will have to fix them before the task can be run. For some supported scripting languages there is no build stage, for others it is optional and for some required.</span></p>
<p class="p4"><span class="s1">The default AppleScript File template we have selected looks something like this:</span></p>
<p class="p15"><span class="s1">on KosmicTask()<br>
??try<br>
????-- get a result file object from KosmicTask.<br>
????-- the file will be automatically deleted when the task ends.<br>
????tell application "KosmicTask"<br>
??????set resultFile to result file with name "capture.png"<br>
????end tell<br>
<br>
????-- the shell script below will expect a POSIX path<br>
????set picPosixPath to POSIX path of file resultFile<br>
<br>
????-- do screen capture via shell<br>
????do shell script "screencapture -t png " &amp; quoted form of picPosixPath<br>
<br>
????-- return file contents and message<br>
????return {kosmicFile:resultFile, kosmicInfo:"file returned"}<br>
??on error errorMessage number errorNumber<br>
????return {kosmicError:errorMessage}<br>
??end try<br>
end KosmicTask</span></p>
<p class="p4"><span class="s1">This script doesn't convert a file (it takes a screenshot instead) but it does execute an external command and it does return a file so it should serve as a good starting point for our conversion task. There are some things to note though before we proceed:</span></p>
<p class="p4"><span class="s1">Firstly the way we create a temporary result file is completely different.</span></p>
<p class="p15"><span class="s1">??-- get a result file object from KosmicTask.<br>
??-- the file will be automatically deleted when the task ends.<br>
??tell application "KosmicTask"<br>
????set resultFile to result file with name "capture.png"<br>
??end tell</span></p>
<p class="p4"><span class="s1">In this case we ask the KosmicTask application itself to create a file object us for us. KosmicTask will delete this file as we require when our task exists.</span></p>
<p class="p4"><span class="s1">Secondly the script makes use of some additional result keywords to send additional information back to the user. So if an error occurs we use the KosmicError keyword to return an error message:</span></p>
<p class="p17"><span class="s1">??on error errorMessage number errorNumber<br>
????return {kosmicError:errorMessage}<br>
??end try</span></p>
<p class="p3"><span class="s1">A First AppleScript Task</span></p>
<p class="p4"><span class="s1">Now that we have our template in place we can modify it to re-implement our RTF to HTML file conversion task.</span></p>
<p class="p16"><span class="s1">on KosmicTask(filePath)<br>
??try</span></p>
<p class="p15"><span class="s1"><br>
????-- get a result file object from KosmicTask.<br>
????-- the file will be automatically deleted when the task ends.<br>
????tell application "KosmicTask"<br>
??????set resultFile to result file with name "result.html"<br>
????end tell<br>
<br>
????-- the shell script below will expect a POSIX path<br>
????set posixPath to POSIX path of file resultFile<br>
<br>
????-- build our command<br>
????set command to "textutil -convert html -output " &amp; quoted form of posixPath<br>
????set command to command &amp; " " &amp; quoted form of filePath<br>
<br>
????-- do command via shell<br>
????do shell script command<br>
<br>
????-- return file contents and message<br>
????return {kosmicFile:resultFile, kosmicInfo:"file returned"}<br>
<br>
??on error errorMessage number errorNumber<br>
????return {kosmicError:errorMessage}<br>
??end try<br>
end KosmicTask</span></p>
<p class="p4"><span class="s1">This task behaves just like its bash based predecessor.</span></p>
<p class="p4"><span class="s1">The main point to note is that our task is implemented as a function called KosmicTask and that this function takes a single argument which is the path to our input file. Many of the supported scripting languages support the use of functions in this way while others (usually those derived from command line interfaces) do not.</span></p>
<p class="p4"><span class="s1">As ever, the Usage document that can be accessed in the Resource Browser is a good place to find out how various features are implemented in each of the supported languages.</span></p>
<p class="p2"><span class="s1">Now that we have our task implemented in AppleScript we can move on to automating Pages itself.</span></p>
<p class="p3"><span class="s1">Automating Pages</span></p>
<p class="p4"><span class="s1">So we know that Pages is scriptable and we can view its dictionary of commands in the AppleScript Editor dictionary browser. We want to export our document so we search the dictionary for "export" and find nothing. This might lead us to conclude that Pages does not allow us to automate the exporting of documents. However, the first rule of everything is don't give up just yet.</span></p>
<p class="p4"><span class="s1">The sorry truth is that the scripting dictionaries for many applications, even major ones like Pages, often lack the sort of informational detail that we really require. This can make them difficult to interpret. Anyhow, we are not alone and search the Internet for "iwork pages applescript export". In this case insight comes from a posting at <a href="http://macscripter.net"><span class="s8">macscripter.net</span></a> (which is a good source of user submitted AppleScript solutions). The insight is that the export functionality we seek is actually implemented by the application save command rather than an explicit export command.</span></p>
<p class="p4"><span class="s1">Armed with this insight we are able, after some experimentation, to produce the following function script:</span></p>
<p class="p16"><span class="s1">on KosmicTask(pagesDocFilePath)<br>
??try<br>
????-- we need a path to save our RTF document file into.<br>
????-- the easy way is simply to append .rtf to our existing file path<br>
????set rtfDocFilePath to pagesDocFilePath &amp; ".rtf"<br>
<br>
????-- save our pages document as RTF<br>
????tell application "Pages"<br>
??????set my doc to open pagesDocFilePath<br>
??????save myDoc as "SLDocumentTypeRichText" in rtfDocFilePath<br>
??????close myDoc saving no<br>
????end tell</span></p>
<p class="p15"><span class="s1"><br>
????-- get a result file object from KosmicTask.<br>
????-- the file will be automatically deleted when the task ends.<br>
????tell application "KosmicTask"<br>
??????set resultFile to result file with name "result.html"<br>
????end tell<br>
<br>
????-- the shell script below will expect a POSIX path<br>
????set posixPath to POSIX path of file resultFile<br>
<br>
????-- build our command<br>
????set command to "textutil -convert html -output " &amp; quoted form of posixPath<br>
????set command to command &amp; " " &amp; quoted form of rtfDocFilePath<br>
<br>
????-- do command via shell<br>
????do shell script command<br>
<br>
????-- return file contents and message<br>
????return {kosmicFile:resultFile, kosmicInfo:"file returned"}<br>
<br>
??on error errorMessage number errorNumber<br>
????return {kosmicError:errorMessage}<br>
??end try<br>
end KosmicTask</span></p>
<p class="p4"><span class="s1">The major change is telling Pages to open our document and save it as Rich Text. After that our script is pretty much as it was before.</span></p>
<p class="p15"><span class="s1">??-- save our pages document as RTF<br>
??tell application "Pages"<br>
????set myDoc to open pagesDocFilePath<br>
????save myDoc as "SLDocumentTypeRichText" in rtfDocFilePath<br>
????close myDoc saving no<br>
??end tell</span></p>
<p class="p4"><span class="s1">That's our task complete. If we build and run the task we can successfully convert any Pages document to HTML. Furthermore we can share this task over the network and let other users convert their Pages documents too.</span></p>
<p class="p2"><span class="s1">The only real problem that we might have with this task is the AppleScript language itself. AppleScript makes simple automation tasks relatively easy to accomplish but the syntax is entirely idiosyncratic and often non intuitive. The language is also rather dated and unsupported on other platforms. Indeed, programmers often used AppleScript despite its obvious deficiencies simple because it was the only way to achieve certain sorts of automation. Thankfully there are now other powerful ways of automating applications on the mac. So let's rework our task again, this time in something a lot more popular and contemporary, Ruby.</span></p>
<p class="p3"><span class="s1">Automation with Ruby</span></p>
<p class="p4"><span class="s1">OS X automation is achieved by sending AppleEvents to an application. A combination of technologies now makes application automation possible from a wide range of scripting languages (you can read more about these technologies - Cocoa bridging and the ScriptingBridge - in the KosmicTask guide).</span></p>
<p class="p4"><span class="s1">Ruby is a modern object orientated language that can also be used to power automation tasks. The KosmicTask Resource Browser contains a Ruby template, the <b>File</b> template, that demonstrates the basics of returning a file from a Ruby Task. Another Ruby template, the <b>Automate app with Scripting Bridge</b> template, demonstrates how to connect to an application in order to automate it. By combining these two templates we can quickly replicate our AppleScript powered Pages task as a Ruby powered task.</span></p>
<p class="p15"><span class="s1">require 'osx/cocoa'<br>
include OSX<br>
OSX.require_framework 'ScriptingBridge'<br>
<br>
# get application reference - see the Ruby Usage document for more info<br>
app = OSX::SBApplication.applicationWithBundleIdentifier_("com.apple.iWork.pages")<br>
pagesDocFilePath = ARGV[0]<br>
rtfDocFilePath = pagesDocFilePath + ".rtf"<br>
<br>
# open pages<br>
myDoc = app.open_(pagesDocFilePath)<br>
<br>
# save document<br>
myDoc.saveAs_in_("SLDocumentTypeRichText", rtfDocFilePath)<br>
<br>
# close document<br>
myDoc.closeSaving_savingIn(false, nil)<br>
<br>
# define our result file<br>
resultFile = "result.html"<br>
<br>
# convert our file<br>
system "textutil -convert html -output \"#{resultFile}\" \"#{rtfDocFilePath}\""<br>
<br>
# return our result file<br>
puts "---"<br>
puts "{kosmicFile: #{resultFile}, kosmicInfo: file returned}"</span></p>
<p class="p4"><span class="s1">There are quite a few details here that are worth noting.</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1">First we require the Cocoa, OS X and ScriptingBridge components to be loaded. This is essential.</span></p>
<p class="p4"><span class="s1">Secondly we connect to the application we wish to automate by using its bundle identifier, which is written in reverse-DNS notation (aka a back to front URL).<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">Thirdly we communicate with our target application using standard Ruby syntax to call the required methods. The method names used are obviously derived from their AppleScript equivalents.</span></p>
<p class="p2"><span class="s1">Apart from that its easy to see the correspondence between the AppleScript version and the Ruby implementation.</span></p>
<p class="p3"><span class="s1">Automation with Python</span></p>
<p class="p4"><span class="s1">Now that we have seen that automation is possible from Ruby there is going to be no stopping us.</span></p>
<p class="p4"><span class="s1">The following example implements our Pages task in Python. The approach is exactly the same as in the Ruby implementation.</span></p>
<p class="p15"><span class="s1">import ScriptingBridge<br>
import os<br>
import sys<br>
<br>
# get application - for more information see the Python Usage document<br>
app = ScriptingBridge.SBApplication.applicationWithBundleIdentifier_("com.apple.iWork.pages")<br>
<br>
pagesDocFilePath = sys.argv[1]<br>
rtfDocFilePath = pagesDocFilePath + ".rtf"<br>
<br>
# open pages<br>
myDoc = app.open_(pagesDocFilePath)<br>
<br>
# save document<br>
myDoc.saveAs_in_("SLDocumentTypeRichText", rtfDocFilePath)<br>
<br>
# close document<br>
myDoc.closeSaving_savingIn_(False, None)<br>
<br>
# define our result file<br>
resultFile = "result.html"<br>
<br>
# convert our file<br>
command = "textutil -convert html -output \"%s\" \"%s\"" % (resultFile, rtfDocFilePath)<br>
os.system(command)<br>
<br>
# return a YAML inline format dictionary with filename<br>
print "--- {kosmicFile: %s, kosmicInfo: file returned}" % resultFile</span></p>
<p class="p4"><span class="s1">This Python implementation performs just like all our other versions.</span></p>
<p class="p2"><span class="s1">Again, note that we explicitly import the ScriptingBridge.</span></p>
<p class="p3"><span class="s1">Automation with JavaScript Cocoa</span></p>
<p class="p4"><span class="s1">The Ruby and Python examples above make it clear that the ScriptingBridge framework is critical in allowing us to create a connection to the application that we wish to automate. What is less clear is the importance of the Cocoa bridge.</span></p>
<p class="p4"><span class="s1">The Cocoa bridge enables out scripts to communicate with the OS X Cocoa framework and its essential objects and methods. Indeed, it is only because the Cocoa bridge exists that we can get to the scripting bridge object, SBApplication, in the first place.</span></p>
<p class="p4"><span class="s1">This connection to the Cocoa bridge and what it entails becomes a bit clearer if we consider JavaScript. KosmicTask includes support for two variants of JavaScript, namely JavaScript itself and JavaScript Cocoa.</span></p>
<p class="p4"><span class="s1">The first variant, JavaScript, supports just the range of functionality that we would expect of the language. If we look at the list of available JavaScript templates in the Resource Browser we see that the selection is quite restrictive. We cannot return files as results, we cannot automate other applications and we cannot import other frameworks.</span></p>
<p class="p4"><span class="s1">The second variant, JavaScript Cocoa, is a Cocoa bridged version of JavaScript that greatly extends the capabilities of the language. With the bridge in place JavaScript powered tasks can now access all the capabilities of the Cocoa framework including access to the ScriptingBridge.</span></p>
<p class="p4"><span class="s1">So here is a JavaScript Cocoa implementation of our Pages task. As usual it behaves just like all our previous examples of this task.</span></p>
<p class="p16"><span class="s1">// load the ScriptingBridge framework<br>
loadFramework("ScriptingBridge")<br>
</span></p>
<p class="p15"><span class="s1">function kosmicTask(pagesDocFilePath)<br>
{<br>
??// use the ScriptingBridge framework to access the application<br>
??var app = SBApplication.applicationWithBundleIdentifier('com.apple.iWork.pages')<br>
<br>
??// rtf file path<br>
??var rtfDocFilePath = pagesDocFilePath + ".rtf"<br>
<br>
??// open pages<br>
??var myDoc = app.open(pagesDocFilePath)<br>
<br>
??// save document<br>
??myDoc.saveAs_in("SLDocumentTypeRichText", rtfDocFilePath)<br>
<br>
??// save document<br>
??myDoc.closeSaving_savingIn(false, null)<br>
<br>
??// form our file result path<br>
<span class="Apple-converted-space"> </span>??// this file will be automatically deleted when the task ends.<br>
??var resultFile = KosmicTaskController.resultFileWithName('result.html')<br>
<br>
??// run external task using a Cocoa NSTask object !<br>
??var args = ['-convert', 'html', '-output', resultFile, rtfDocFilePath]<br>
??var task = NSTask.launchedTaskWithLaunchPath_arguments('/usr/bin/textutil', args)<br>
??task.waitUntilExit;<br>
<br>
??// form result dictionary <br>
??return {kosmicFile: resultFile};<br>
}</span></p>
<p class="p4"><span class="s1">Note that the Cocoa bridge code has added a function, loadFramework(), that allows us to load in the ScriptingBridge framework that we need to get our automation object reference.</span></p>
<p class="p4"><span class="s1">Another standout feature is the use of NSTask, a Cocoa class, to run our external command. Native JavaScript, unlike all our previous examples, provides no way of initiating an external task (mainly to prevent malicious Internet browser scripts from wreaking havoc) . This example demonstrates clearly how a Cocoa bridge can enhance a language's overall functionality and usefulness.</span></p>
<p class="p2"><span class="s1">An additional detail is the use of the KosmicTaskController object to retrieve a result file path. This utility object is automatically made available to all JavaScript Cocoa tasks. In fact KosmicTask makes a KosmicTaskController object available for many of the languages that it supports. This provides a simple way for KosmicTask to expose utility and support functions to the task. See the usage documents in the Resource Browser for further details</span></p>
<p class="p3"><span class="s1">Automation with Lua Cocoa</span></p>
<p class="p4"><span class="s1">All of the previous examples were coded in scripting languages that ship as part of OS X. KosmicTask uses a plug-in architecture to implement its language support enabling it to encompass a wide range of different language types and configurations. In the case of those languages that are included as part of OS X the KosmicTask language plugin merely exposes the underlying language to the application. But KosmicTask also supports scripting in languages that come embedded in the language plug-in itself.</span></p>
<p class="p4"><span class="s7"><a href="http://en.wikipedia.org/wiki/Lua_(programming_language)">Lua</a></span><span class="s1"> is a powerful, fast, lightweight scripting language. As in the case of JavaScript KosmicTask includes support for two variants of Lua. In both of these cases language support is embedded in the relevant plug-in.</span></p>
<p class="p4"><span class="s1">The first variant, Lua, supports all the features of standard Lua and KosmicTask includes a standard range of useful templates.</span></p>
<p class="p4"><span class="s1">The second variant, LuaCocoa, is a Cocoa bridge. Hence we should be able to rework our Pages task in Lua.<span class="Apple-converted-space"> </span></span></p>
<p class="p15"><span class="s1">LuaCocoa.import("ScriptingBridge")<br>
<br>
function kosmicTask(pagesDocFilePath)<br>
<br>
??-- use the ScriptingBridge framework to access the application<br>
??local app = SBApplication:applicationWithBundleIdentifier_("com.apple.iWork.pages")<br>
??local rtfDocFilePath = pagesDocFilePath .. ".rtf"<br>
<br>
??-- open pages<br>
??local myDoc = app:open_(pagesDocFilePath)<br>
<br>
??-- save document<br>
??myDoc:saveAs_in_("SLDocumentTypeRichText", rtfDocFilePath)<br>
<br>
??-- close document<br>
??myDoc:closeSaving_savingIn_(false, nil)<br>
<br>
??-- get the kosmicTaskController class<br>
??local taskController = NSClassFromString("KosmicTaskController")<br>
<br>
??-- get our result file path<br>
<span class="Apple-converted-space"> </span>??-- this file will be automatically deleted when the task ends.<br>
??local resultFile = taskController:resultFileWithName_('result.html')<br>
??resultFile = tostring(resultFile) -- get a native lua string<br>
<br>
??-- convert our file<br>
??local cmd = string.format("textutil -convert html -output \"%s\" \"%s\"", resultFile, rtfDocFilePath)<br>
??os.execute(cmd)<br>
<br>
??-- return file content in native Lua dictionary<br>
??local result = {}<br>
??result.kosmicFile = resultFile<br>
<br>
??return result<br>
end</span></p>
<p class="p4"><span class="s1">As in the case of JavaScript Cocoa we use the KosmicTaskController to retrieve a result file name. The object is not automatically available but is retrieved using the Cocoa framework function NSClassFromString(). This approach is used in several of the Cocoa bridges and is demonstrated where appropriate in the usage documents and templates.</span></p>
<p class="p2"><span class="s1">This example also makes use of another feature of Cocoa bridging - the ability to return native scripting language objects as results. Previously we had either printed our YAML formatted results directly or returned them as the result of calling the task function. With the Cocoa bridge in place we can form our result in a native data structure, a dictionary in this case, and return that as our result. This means that the task can manipulate its result as an object which makes returning results with a complex structure easy.</span></p>
<p class="p3"><span class="s1">Automation with F-Script Cocoa</span></p>
<p class="p4"><span class="s1">Our previous examples have focussed on using the various Cocoa bridges support by KosmicTask. F-Script is not so much a Cocoa bridge as a Cocoa scripting language in its own right. It is written in Cocoa and its distinct syntax has been designed to allow quick and easy manipulation of Cocoa objects. If you want to create complex tasks that manipulate a lot of Cocoa objects then F-Script is a great choice.</span></p>
<p class="p4"><span class="s1">No surprise then that we can recompose our Pages task in F-Script.</span></p>
<p class="p15"><span class="s1">[:pagesDocFilePath |<br>
<br>
??"load the ScriptingBridge framework"<br>
??(NSBundle bundleWithPath:'/System/Library/Frameworks/ScriptingBridge.framework') load.<br>
<br>
??" use the ScriptingBridge framework to access the application "<br>
??app := SBApplication applicationWithBundleIdentifier:'com.apple.iWork.pages'.<br>
??rtfDocFilePath := pagesDocFilePath ++ '.rtf'.<br>
<br>
??"open pages"<br>
??myDoc := app open:pagesDocFilePath.<br>
<br>
??"save document"<br>
??myDoc saveAs:'SLDocumentTypeRichText' in:rtfDocFilePath.<br>
<br>
??"close document"<br>
??myDoc closeSaving:(NSNumber numberWithBool:NO) savingIn:nil.<br>
<br>
??" get our kosmicTaskController "<br>
??taskController := KosmicTaskController.<br>
<br>
<span class="Apple-converted-space"> </span>??" form our file result path"<br>
<span class="Apple-converted-space"> </span>??" this file will be automatically deleted when the task ends."<br>
??resultFile := taskController resultFileWithName: 'result.html'.<br>
<br>
??" convert our file "<br>
??args := {'-convert', 'html', '-output', resultFile, rtfDocFilePath}.<br>
??task := NSTask launchedTaskWithLaunchPath:'/usr/bin/textutil' arguments:args.<br>
??task waitUntilExit.<br>
<br>
??" return result dictionary "<br>
??#{'kosmicFile' -&gt; resultFile}.<br>
]</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1">F-Script executes blocks as opposed to functions. In the example our task block is defined by the enclosing square braces [ ... ]. This outermost block accepts a single argument - pagesDocFilePath.</span></p>
<p class="p4"><span class="s1">As in our other examples we start by loading the ScriptingBridge framework except this time we use the Cocoa NSBundle class as the loader.</span></p>
<p class="p4"><span class="s1">The KosmicTaskController object is also referenced in order to obtain our result file path.</span></p>
<p class="p2"><span class="s1">F-Script implements a shorthand literal notation for arrays and dictionaries. F-script functions return the value of the last </span><span class="s9">statement</span><span class="s1"> evaluated in the enclosing block. In this case its the literal dictionary returning our result file.<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1">Automation with AppleScript Cocoa</span></p>
<p class="p4"><span class="s1">We began our series of automation examples with AppleScript and this example:</span></p>
<p class="p16"><span class="s1">-- KosmicTask controller<br>
property taskController : class "KosmicTaskController"<br>
<br>
script KosmicTask<br>
??property parent : class "NSObject"<br>
??property NSTask : class "NSTask"<br>
<br>
??on KosmicTask(pagesDocFilePath)<br>
????try<br>
??????-- we need a path to save our RTF document file into.<br>
??????-- the easy way is simply to append .rtf to our existing file path<br>
??????set rtfDocFilePath to pagesDocFilePath &amp; ".rtf"<br>
<br>
??????-- save our pages document as RTF<br>
??????tell application "Pages"<br>
????????set myDoc to open pagesDocFilePath<br>
????????save myDoc as "SLDocumentTypeRichText" in rtfDocFilePath<br>
????????close myDoc saving no<br>
??????end tell<br>
<br>
??????-- get result file path<br>
??????set resultFile to (taskController's resultFileWithName_("result.html")) as string<br>
<br>
??????-- build our command<br>
??????set theArgs to {"-convert", "html", "-output", resultFile, rtfDocFilePath}<br>
<br>
??????-- run task<br>
??????set theTask to NSTask's launchedTaskWithLaunchPath_arguments_("/usr/bin/textutil", theArgs)<br>
??????theTask's waitUntilExit()<br>
</span></p>
<p class="p17"><span class="s1">??????-- return file result<br>
??????return {kosmicFile:resultFile, kosmicInfo:"file returned"}<br>
<br>
????on error errorMessage number errorNumber<br>
??????return {kosmicError:errorMessage}<br>
????end try<br>
??end KosmicTask<br>
end script</span></p>
<p class="p3"><span class="s1">Automation with AppScript</span></p>
<p class="p4"><span class="s1">So far we have automated our application with the help of AppleScript and the ScriptingBridge framework. KosmicTask also supports another very capable means of achieving automation - appscript. Appscript is supported by both Ruby and Python and makes a compelling alternative to the ScriptingBridge.<span class="Apple-converted-space"> </span></span></p>
<p class="p13"><span class="s10"><a href="http://www.cocoadev.com/index.pl?ScriptingBridgeCriticisms">http://www.cocoadev.com/index.pl?ScriptingBridgeCriticisms</a></span></p>
<p class="p4"><span class="s1">A good question would be why should I use appscript when the ScriptingBridge is already available? The simple answer is that appscript more accurately represents the un (). This often makes it easy to turn the terminology displayed in an applications's dictionary into a working script. The ScriptingBridge, though useful and moderately efficient, obscures some of the detail of () and this can make () more difficult.</span></p>
<p class="p4"><span class="s1">The obvious point about both Ruby appscript and Python appscript is that the () is much more closely aligned with AppleScript.<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">So here is our Ruby powered Pages task using rb-appscript for automation:</span></p>
<p class="p15"><span class="s1"># ruby<br>
require 'appscript'<br>
<br>
# get application - for more information see the Ruby Usage document<br>
app = Appscript.app('Pages')<br>
<br>
pagesDocFilePath = ARGV[0]<br>
rtfDocFilePath = pagesDocFilePath + ".rtf"<br>
<br>
# open pages<br>
myDoc = app.open(pagesDocFilePath)<br>
<br>
# save document<br>
app.save(myDoc, {:as =&gt; "SLDocumentTypeRichText", :in =&gt; rtfDocFilePath})<br>
<br>
# close document<br>
app.close(myDoc, {:saving =&gt; false})<br>
<br>
# define our result file<br>
resultFile = "result.html"<br>
<br>
# convert our file<br>
system "textutil -convert html -output \"#{resultFile}\" \"#{rtfDocFilePath}\""<br>
<br>
# return our result file<br>
puts "---"<br>
puts "{kosmicFile: #{resultFile}, kosmicInfo: file returned}"</span></p>
<p class="p4"><span class="s1">Each automation command we send is represented by a single Apple Event. These low level events take one default parameter and a number of often optional named parameters. When saving a document the document itself is the default parameter (aka the direct object). The required format (as) and the location (in) are the named parameters. In Ruby appscript exposes our command (save) as a function that takes a single object as the default parameter (myDoc document) and a hash of named parameters (as, in). Appscript requires that the named parameter hash keys be Ruby symbols rather than strings hence the colon prefixes to the key names.<span class="Apple-converted-space"> </span></span></p>
<p class="p15"><span class="s1"># ruby<br>
# save document<br>
app.save(myDoc, {:as =&gt; "SLDocumentTypeRichText", :in =&gt; rtfDocFilePath})</span></p>
<p class="p4"><span class="s1">And here is the Python powered variant using py-appscript:</span></p>
<p class="p15"><span class="s1"># python<br>
import os<br>
import sys<br>
import appscript<br>
<br>
# get application - for more information see the Python Usage document<br>
app = appscript.app('Pages')<br>
pagesDocFilePath = sys.argv[1]<br>
rtfDocFilePath = pagesDocFilePath + ".rtf"<br>
<br>
# open pages<br>
myDoc = app.open(pagesDocFilePath)<br>
<br>
# save document, note we use as_ and in_ to avoid keyword collision<br>
app.save(myDoc, as_="SLDocumentTypeRichText", in_=rtfDocFilePath)<br>
<br>
# close document<br>
app.close(myDoc, saving=False)<br>
<br>
# define our result file<br>
resultFile = "result.html"<br>
<br>
# convert our file<br>
command = "textutil -convert html -output \"%s\" \"%s\"" % (resultFile, rtfDocFilePath)<br>
os.system(command)<br>
<br>
# return a YAML inline format dictionary with filename<br>
print "--- {kosmicFile: %s, kosmicInfo: file returned}" % resultFile</span></p>
<p class="p4"><span class="s1">Note the following syntactical detail when saving our document:</span></p>
<p class="p15"><span class="s1"># python<br>
# save document, note we use as_ and in_ to avoid keyword collision<br>
app.save(myDoc, as_="SLDocumentTypeRichText", in_=rtfDocFilePath)</span></p>
<p class="p4"><span class="s1">As before () but this time we are able to make use of Pythons support for named optional arguments rather than using a dictionary.</span></p>
<p class="p4"><span class="s1">It turns out that 'as' and 'in' are both Python keywords and therefore cannot be used as named arguments. Hence appscript accepts 'as_' and 'in_' as equivalents.</span></p>
<p class="p18"><span class="s1">How KosmicTask Works</span></p>
<p class="p3"><span class="s1">Application Architecture</span></p>
<p class="p4"><span class="s1">KosmicTask is implemented using a multi tier architecture:</span></p>
<p class="p4"><span class="s11"><b>Tier 1:</b></span><span class="s1"> KosmicTask Client User Interface</span></p>
<p class="p4"><span class="s11"><b>Tier 2:</b></span><span class="s1"> KosmicTask Server</span></p>
<p class="p4"><span class="s11"><b>Tier 3:</b></span><span class="s1"> KosmicTask Task Runner</span></p>
<p class="p4"><span class="s11"><b>Tier 4:</b></span><span class="s1"> Script Language Executable</span></p>
<p class="p4"><span class="s1">The interaction between the tiers is as follows;</span></p>
<ul>
  <li class="li11"><span class="s1">Users interact with the application at <b>Tier 1</b> to create, edit and execute tasks.</span></li>
  <li class="li11"><span class="s1">The server in <b>Tier 2</b> receives requests from clients on <b>Tier 1</b> (both local and remote) to create and execute tasks.</span></li>
  <li class="li11"><span class="s1">Each supported scripting language has an associated Task Runner. When a task is executed the appropriate TaskRunner is launched along with a copy of the script to be executed. This behaviour ensures that each script runs in its own process in <b>Tier 3</b> and cannot bring down the server in <b>Tier 2</b>.</span></li>
  <li class="li4"><span class="s1">KosmicTask supports both in and out of process scripting. Those scripts that run in process (such as AppleScript and the Cocoa bridge components detailed below) are loaded and executed with the Task Runner in <b>Tier 3</b>. Scripts that are run out of process, such as the majority of the command line derived scripting components, are executed in <b>Tier 4</b> as instances of individual scripting subsystems.</span></li>
</ul>
<p class="p4"><span class="s1">When a task execution is requested information is passed down through the tiers, the task is executed in the relevant task runner, and the task results are then returned to the user.</span></p>
<p class="p2"><span class="s1">KosmicTask can be configured to load just the server component when a user logs in so that other network users always have access.</span></p>
<p class="p3"><span class="s1">Application Tasks and User Tasks</span></p>
<p class="p4"><span class="s1">KosmicTask comes preinstalled with a number of general utility tasks known as <b>Application Task</b>s. The majority of these are written in AppleScript. <b>Application Tasks</b> cannot be edited or deleted but they can be duplicated.</span></p>
<p class="p2"><span class="s1">Tasks created by the user are identified as <b>User Tasks</b>. These can be created, edited and deleted by the user.</span></p>
<p class="p3"><span class="s1">Resource Browser</span></p>
<p class="p4"><span class="s1">In KosmicTask each scripting language is implemented as a separate plug-in bundle. The application <b>Resource Browser</b> provides access to the resources supplied by each language plug-in. These resources include:</span></p>
<ul>
  <li class="li11"><span class="s1">A number of task templates (see below).</span></li>
  <li class="li11"><span class="s1">A number of informational documents.</span></li>
  <li class="li4"><span class="s1">A default list of property settings.</span></li>
</ul>
<p class="p4"><span class="s1">The informational documents generally provide links to web based sources of information for the represented language. A usage document provides an overview of how to accomplish basic tasks using the language. This document is intended to accompany and expand upon the information contained with the individual templates.<span class="Apple-converted-space"> </span></span></p>
<p class="p2"><span class="s1">Each language also defines a default set of property settings. Most of these are read only and define the specific properties of the language plug-in. Several read-write properties also exist, such as the path to OS X scripting subsystems and task function and class names. These read-write properties can be overridden for individual templates and tasks. Selecting a property from the property list will display a short explanation of its purpose below the list.</span></p>
<p class="p3"><span class="s1">Template Support</span></p>
<p class="p4"><span class="s1">In order to aid user task creation a number of task templates are available through the application Resource Browser. These templates serve to indicate the basic syntax required in each scripting language to achieve a particular objective. In general, all of the distinctive features of KosmicTask are available as a template in each scripting language. Each template includes the script code, the settings necessary to configure the script and an informational document.</span></p>
<p class="p4"><span class="s1">Often the best way to find out how to accomplish a particular task is to examine the available templates. The simplest template - Hello Kosmos - simple returns Hello Kosmos! to the user. Other templates indicate how to return complex objects and files as results while others detail features such as class creation and application automation.</span></p>
<p class="p2"><span class="s1">In addition to the templates that are supplied with the application (the Application Templates) the user may define any number of additional templates.</span></p>
<p class="p3"><span class="s1">Task Inputs</span></p>
<p class="p4"><span class="s1">KosmicTask provides a number of plugin based inputs that provide an effective means of acquiring the input to a task. Any number and selection of input types can be defined to provide the parameters for a given task.<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">The standard input types are:</span></p>
<p class="p4"><span class="s4"><b>Date</b></span><span class="s1">. TODO.</span></p>
<p class="p4"><span class="s4"><b>File</b></span><span class="s1">. TODO.</span></p>
<p class="p19"><span class="s1"><b>File Path</b></span><span class="s2">. TODO.</span></p>
<p class="p19"><span class="s1"><b>List Item</b></span><span class="s2">. TODO.</span></p>
<p class="p4"><span class="s4"><b>Number</b></span><span class="s1">. TODO</span></p>
<p class="p2"><span class="s4"><b>Text</b></span><span class="s1">. TODO</span></p>
<p class="p3"><span class="s1">Task Results</span></p>
<p class="p4"><span class="s1">When a task completes it may generate a result that is returned to the user. Task results may consist of simple object such as text string or a number. More complex results containing data such as arrays and dictionaries (aka associative arrays or hashes or maps) can also be returned.</span></p>
<p class="p4"><span class="s1">Complex results also permit the returning of the contents of a file or files as all or part of a result. Complex results retain their structure when presented to the user and thus can be navigated using an outline controller. More importantly, the results can be saved as external XML files or property lists that maintain the result content and structure.</span></p>
<p class="p2"><span class="s1">In addition, CSS based style commands can be embedded in complex results in order to provide result styling.</span></p>
<p class="p3"><span class="s1">Complex Task Results</span></p>
<p class="p4"><span class="s1">Complex task results are generally returned as YAML formatted strings. YAML (YAML Ain't Markup Language or Yet Another Markup Language) is a straight forward human readable way of representing complex data types containing strings, scalars, arrays and dictionaries. Its simple syntax makes it easy for traditional command line scripting languages like Bash to generate complex results simply by printing YAML formatted strings to their standard output.</span></p>
<p class="p4"><span class="s1">YAML is a popular method of representing data relationships and bindings exist for many scripting languages. KosmicTask makes use of these bindings for Java, JavaScript, Perl, Php, Python and Ruby within application defined controller objects. These controller objects handle the translation between the scripts native data structure and YAML. Thus the task produces its result as a native data structure and then passes it over to the controller for formatting. This YAML formatted result is then returned to the user.</span></p>
<p class="p2"><span class="s1">See below for the even simpler way in which Cocoa based tasks can return complex results.</span></p>
<p class="p3"><span class="s1">Application Defined Scripting Resources</span></p>
<p class="p4"><span class="s1">A scripting language plugin can define additional resources to assist with script building and task control.</span></p>
<p class="p4"><span class="s1">Most scripting languages provide some means of validating a script prior to its execution. This functionality is invoked by KosmicTask whenever a task build is requested. Some languages lack this integrated facility and rely on additional tools to provide external validation. A language plugin may optionally include such a tool and invoke it during the build stage.</span></p>
<p class="p4"><span class="s1">Scripts that run in-process with their task runner normally have access to a KosmicTask supplied controller object. This object is designed to allow the task to interface with the task runner. The controller is generally an object written in the target scripting language. In some cases the task will have to explicitly create a reference to or an instance of the controller object. In other cases the controller object will be pre -defined with the tasks scope.</span></p>
<p class="p2"><span class="s1">A language plugin can also provide access to additional scripting facilities. This is the case with appscript which is supplied with the Ruby and Python plug-ins to provide an additional automation interface.</span></p>
<p class="p3"><span class="s1">Task File Handling</span></p>
<p class="p4"><span class="s1">KosmicTask permits the contents of any number of files to be passed as inputs and/or returned as results. File contents are passed as inputs using the File Contents input type. When the task is executed the file contents are transferred to the target machine and temporarily stored. The path to this temporary file as passed as the actual task input parameter enabling the task to access the file data.</span></p>
<p class="p2"><span class="s1">File contents are returned as results by returning a dictionary type result that contains a kosmicFile key defining the file or files whose contents are to be returned to the user.</span></p>
<p class="p3"><span class="s1">Temporary File Handling</span></p>
<p class="p4"><span class="s1">A task may return the contents of a pre existing file as a result or it may wish to return the contents of a temporary file that has been generated by the task. To assist with this KosmicTask provides a number of ways of requesting temporary file storage. File storage allocated in these way will only exist for the lifetime of the task and will be deleted from the host machine when the task terminates.</span></p>
<p class="p4"><span class="s1">A path to a temporary file or files may be requested in three different ways dependent on the nature of the scripting language plugin.</span></p>
<ul>
  <li class="li11"><span class="s1">Command line based scripting languages simply need to create files in the task's initial working directory.</span></li>
  <li class="li11"><span class="s1">Most in process tasks can call the resultFileWithName function on a KosmicTask supplier controller object.</span></li>
  <li class="li4"><span class="s1">Scripts which send Apple events can send the "result file with name &lt;basename&gt;" command to the KosmicTask application object.</span></li>
</ul>
<p class="p2"><span class="s1">The easiest way to determine what method to use for a particular scripting language is to examine the 'file' or 'files' template or read the usage document in the Resource Browser.</span></p>
<p class="p3"><span class="s1">Scripting Language Support</span></p>
<p class="p4"><span class="s1">KosmicTask uses an extensible plug-in architecture to support a wide range of scripting languages. By design support is included for all the scripting languages that are present as part of a standard OS X 10.6 installation. When such a task is executed its script is passed to the local scripting subsystem for execution.</span></p>
<p class="p4"><span class="s1">In addition, KosmicTask includes a number of additional scripting languages. Support for these languages is wholly embedded in the application bundle and nothing is installed outside of the application itself.</span></p>
<p class="p4"><span class="s1">KosmicTask supports both interpreted scripting languages (such as Php and Perl) and those that are compiled (such as AppleScript and Java).</span></p>
<p class="p4"><span class="s1">Support is also included for a number of Cocoa bridges. These bridges are extremely powerful and enable scripts to access all the power and functionality of the OS X Cocoa framework.<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">KosmicTask supports the scripting of tasks in the following languages:</span></p>
<p class="p20"><br></p>
<p class="p20"><br></p>
<table cellspacing="0" cellpadding="0" class="t1">
  <tbody>
    <tr>
      <td valign="top" class="td1">
        <p class="p21"><span class="s1">Script</span></p>
      </td>
      <td valign="top" class="td2">
        <p class="p21"><span class="s1">Embedded</span></p>
      </td>
      <td valign="top" class="td3">
        <p class="p21"><span class="s1">Description</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td4">
        <p class="p4"><span class="s1"><b>AppleScript</b></span></p>
      </td>
      <td valign="top" class="td5">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td6">
        <p class="p4"><span class="s1">Apple event scripting component</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td7">
        <p class="p4"><span class="s1"><b>Bash shell</b></span></p>
      </td>
      <td valign="top" class="td8">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td9">
        <p class="p4"><span class="s1">OS X shell</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td10">
        <p class="p4"><span class="s1"><b>C shell</b></span></p>
      </td>
      <td valign="top" class="td11">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td12">
        <p class="p4"><span class="s1">OS X shell</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td7">
        <p class="p4"><span class="s1"><b>C</b></span></p>
      </td>
      <td valign="top" class="td8">
        <p class="p22"><span class="s1">yes</span></p>
      </td>
      <td valign="top" class="td9">
        <p class="p4"><span class="s1">Interpreter</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td10">
        <p class="p4"><span class="s1"><b>C++</b></span></p>
      </td>
      <td valign="top" class="td11">
        <p class="p22"><span class="s1">yes</span></p>
      </td>
      <td valign="top" class="td12">
        <p class="p4"><span class="s1">Interpreter</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td7">
        <p class="p4"><span class="s1"><b>Java</b></span></p>
      </td>
      <td valign="top" class="td8">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td9">
        <p class="p4"><span class="s1">Runtime</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td10">
        <p class="p4"><span class="s1"><b>Javascript</b></span></p>
      </td>
      <td valign="top" class="td11">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td12">
        <p class="p4"><span class="s1">Interpreter</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td7">
        <p class="p4"><span class="s1"><b>Perl</b></span></p>
      </td>
      <td valign="top" class="td8">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td9">
        <p class="p4"><span class="s1">OS X scripting component</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td10">
        <p class="p4"><span class="s1"><b>PHP</b></span></p>
      </td>
      <td valign="top" class="td11">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td12">
        <p class="p4"><span class="s1">OS X scripting component</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td7">
        <p class="p4"><span class="s1"><b>Python</b></span></p>
      </td>
      <td valign="top" class="td8">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td9">
        <p class="p4"><span class="s1">OS X scripting component</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td10">
        <p class="p4"><span class="s1"><b>Ruby</b></span></p>
      </td>
      <td valign="top" class="td11">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td12">
        <p class="p4"><span class="s1">OS X scripting component</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td7">
        <p class="p4"><span class="s1"><b>Tcl</b></span></p>
      </td>
      <td valign="top" class="td8">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td9">
        <p class="p4"><span class="s1">OS X scripting component</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td10">
        <p class="p4"><span class="s1"><b>Tenex C shell</b></span></p>
      </td>
      <td valign="top" class="td11">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td12">
        <p class="p4"><span class="s1">OS X shell</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td7">
        <p class="p4"><span class="s1"><b>Z shell</b></span></p>
      </td>
      <td valign="top" class="td8">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td9">
        <p class="p4"><span class="s1">OS X shell</span></p>
      </td>
    </tr>
  </tbody>
</table>
<p class="p20"><br></p>
<p class="p23"><span class="s1"><b></b></span><br></p>
<p class="p4"><span class="s1">C and C++ interpreted scripting support is provided by CINT</span></p>
<p class="p4"><span class="s1">KosmicTask supports Cocoa framework scripting using the following bridges and components:</span></p>
<p class="p20"><br></p>
<p class="p20"><br></p>
<table cellspacing="0" cellpadding="0" class="t1">
  <tbody>
    <tr>
      <td valign="top" class="td13">
        <p class="p21"><span class="s1">Script</span></p>
      </td>
      <td valign="top" class="td13">
        <p class="p21"><span class="s1">Embedded</span></p>
      </td>
      <td valign="top" class="td14">
        <p class="p21"><span class="s1">Description</span></p>
      </td>
      <td valign="top" class="td15">
        <p class="p21"><span class="s1">KosmicTask Alias</span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td16">
        <p class="p4"><span class="s1"><b>AppleScriptObjC</b></span></p>
      </td>
      <td valign="top" class="td16">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td17">
        <p class="p4"><span class="s1">AppleScript bridge</span></p>
      </td>
      <td valign="top" class="td18">
        <p class="p4"><span class="s1"><b>AppleScript Cocoa</b></span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td19">
        <p class="p4"><span class="s1"><b>F-Script</b></span></p>
      </td>
      <td valign="top" class="td19">
        <p class="p22"><span class="s1">yes</span></p>
      </td>
      <td valign="top" class="td20">
        <p class="p4"><span class="s1">F-Script Cocoa scripting environment</span></p>
      </td>
      <td valign="top" class="td21">
        <p class="p4"><span class="s1"><b>F-Script Cocoa</b></span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td22">
        <p class="p4"><span class="s1"><b>JSCocoa</b></span></p>
      </td>
      <td valign="top" class="td22">
        <p class="p22"><span class="s1">yes</span></p>
      </td>
      <td valign="top" class="td23">
        <p class="p4"><span class="s1">JavaScript bridge</span></p>
      </td>
      <td valign="top" class="td24">
        <p class="p4"><span class="s1"><b>JavaScript Cocoa</b></span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td25">
        <p class="p4"><span class="s1"><b>LuaCocoa</b></span></p>
      </td>
      <td valign="top" class="td25">
        <p class="p22"><span class="s1">yes</span></p>
      </td>
      <td valign="top" class="td26">
        <p class="p4"><span class="s1">Lua bridge</span></p>
      </td>
      <td valign="top" class="td27">
        <p class="p4"><span class="s1"><b>Lua Cocoa</b></span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td22">
        <p class="p4"><span class="s1"><b>PyObjC</b></span></p>
      </td>
      <td valign="top" class="td22">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td23">
        <p class="p4"><span class="s1">Python bridge</span></p>
      </td>
      <td valign="top" class="td24">
        <p class="p4"><span class="s1"><b>Python Cocoa</b></span></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td25">
        <p class="p4"><span class="s1"><b>RubyCocoa</b></span></p>
      </td>
      <td valign="top" class="td25">
        <p class="p22"><span class="s1">no</span></p>
      </td>
      <td valign="top" class="td26">
        <p class="p4"><span class="s1">Ruby bridge</span></p>
      </td>
      <td valign="top" class="td27">
        <p class="p4"><span class="s1"><b>Ruby Cocoa</b></span></p>
      </td>
    </tr>
  </tbody>
</table>
<p class="p20"><br></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">Within KosmicTask the various Cocoa components are identified by the alias given in the above table.<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1">Cocoa Based Tasks</span></p>
<p class="p4"><span class="s1">Cocoa based tasks have a great advantage when it comes to generating task results in that they can returned native data structures. KosmicTask will receive the result via the bridge and return it to the user.</span></p>
<p class="p2"><span class="s1">Thus, Cocoa based tasks can generate complex results using the relevant scripting language native data structures such as arrays and dictionaries. Native dictionaries can be used to provide a fast and efficient way of returning the contents of files as results.</span></p>
<p class="p3"><span class="s1">Cocoa Based Application Tasks</span></p>
<p class="p4"><span class="s1">Tasks which utilise the Cocoa framework are run as fully fledged Cocoa applications.<span class="Apple-converted-space"> </span></span></p>
<p class="p2"><span class="s1">Many Cocoa components require the existence of a run loop in order to be utilised to their full potential. Normally, application tasks exit when the function that launches them exists. Cocoa based tasks, however, can request that they be allowed to continue running in order to receive further input from runloop sources. When the task determines that it is complete it terminates itself and the task results are returned to the user.</span></p>
<p class="p3"><span class="s1">Comparing Standard and Cocoa Based Language Implementations</span></p>
<p class="p4"><span class="s1">The differences between the standard and Cocoa variants of any scripting language can be summarised as follows:</span></p>
<ul>
  <li class="li11"><span class="s1">Most standard scripting components run as external command line based process (though the likes of JavaScript does not).</span></li>
  <li class="li11"><span class="s1">The standard scripting components are less complex and will load faster than the Cocoa variants.</span></li>
  <li class="li11"><span class="s1">The Cocoa based scripting components run in process with their task runner.</span></li>
  <li class="li4"><span class="s1">The Cocoa based scripting components will generally use more system resources than the standard components.<span class="Apple-converted-space"> </span></span></li>
</ul>
<p class="p4"><span class="s1">We can take the examples of Ruby and RubyCocoa to illustrate the above points.</span></p>
<p class="p4"><span class="s1">When a standard Ruby task is executed an instance of the KosmicTaskRubyRunner program is launched (this will be visible in the Activity Monitor application). This program receives the task request from the KosmicTask server component and launches a separate instance of the Ruby command line system (also visible in the Activity Monitor). The task runner passes the task inputs to Ruby and waits for the task results to be returned. When the Ruby instance terminates the task runner formats the task results and returns them to the server component which then transfers them via the network to the user.</span></p>
<p class="p2"><span class="s1">When a RubyCocoa task is executed an instance of the KosmicTaskRubyCocoaRunner program is launched. This program executes as a fully fledged Cocoa application complete with runloop. Once successfully launched the task runner loads the Cocoa task into its own process space and executes the designated run function on the designated run class. When the initial run function returns the task runner checks the status of the KosmicTaskController keepTaskAlive property. If the task requests that it be kept alive then the task is allowed to continue executing until it calls the KosmicTaskController stopTask: method. If the task does not request to be kept alive then the task run loop is stopped immediately.</span></p>
<p class="p3"><span class="s1">Automation Support and System-wide Scripting</span></p>
<p class="p4"><span class="s1">OS X provides a powerful mechanism for automating and controlling system resources and applications using Apple events. AppleScript has been the traditional means of achieving this but now there are other powerful and more intuitive alternatives.</span></p>
<p class="p4"><span class="s1">OS X includes a technology called Scripting Bridge which allows Cocoa based applications to automate other services by sending Apple events. All of the Cocoa capable scripting components supported by KosmicTask can utilise this technology to achieve automation. Scripting Bridge therefore means that automation can be achieved by a much wider range of scripting languages than was previously possible.</span></p>
<p class="p4"><span class="s1">But there is another alternative…</span></p>
<p class="p2"><span class="s1">Apple events are complex and the desired interaction between the controlling script and the targeted application or service can sometimes be difficult to achieve. The appscript component, which is available to the Python and Ruby scripting components, provides an alternative means of generating, sending and interpreting Apple events.</span></p>
<p class="p3"><span class="s1">Security</span></p>
<p class="p4"><span class="s1">KosmicTask uses Transport Layer Security (the successor to SSL) to provide secure network communication. The OS X keychain is used for secure password storage and retrieval.</span></p>
<p class="p24"><span class="s2"></span><span class="s1">KosmicTask Help v1.0.1</span></p>
<p class="p3"><span class="s1">Main Window Layout</span></p>
<p class="p4"><span class="s1">The main KosmicTask window contains the toolbar and four distinct panes.</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p25"><span class="s1"></span><br></p>
<p class="p3"><span class="s1">Browser Pane - Top</span></p>
<p class="p4"><span class="s1">The browser mode control at the top of the pane determines the browser contents.</span></p>
<p class="p4"><span class="s4"><b>Browser hide</b></span><span class="s1">. Hides the browser pane.</span></p>
<p class="p4"><span class="s4"><b>Tasks</b></span><span class="s1">. Displays a list of available tasks</span></p>
<p class="p4"><span class="s4"><b>Search</b></span><span class="s1">. Displays a list of search results.</span></p>
<p class="p2"><span class="s4"><b>Sharing</b></span><span class="s1">. Displays network sharing information.</span></p>
<p class="p3"><span class="s1">Task Pane - Middle</span></p>
<p class="p4"><span class="s1">The task pane displays the current task and results.</span></p>
<p class="p5"><span class="s1">Tabs</span></p>
<p class="p4"><span class="s1">Each task has its own tab containing a task view. The task view displays task input on the left and results on the right.</span></p>
<ul>
  <li class="li11"><span class="s1">To create a new tab click the + button. To close click x.</span></li>
  <li class="li11"><span class="s1">To open a particular task in a new tab <b>command-click</b> the task in the browser.</span></li>
  <li class="li11"><span class="s1">To open a task in a new window use <b>alt-click</b>. Alternatively use the task browser context menu.</span></li>
  <li class="li26"><span class="s1">Drag the tabs to reorder.</span></li>
</ul>
<p class="p5"><span class="s1">Task Navigation Bar</span></p>
<p class="p4"><span class="s1">Provides navigation functionality within the task tab.</span></p>
<p class="p5"><span class="s1">Task View - Left</span></p>
<p class="p4"><span class="s1">Displays the detail of the currently selected task along with any inputs.</span></p>
<p class="p5"><span class="s1">Result View - Right</span></p>
<p class="p4"><span class="s1">Displays the results of task execution. If no task has been executed then the view will display "ready". When a task is executing the view will display "running".</span></p>
<p class="p5"><span class="s1">Task Status - Lower</span></p>
<p class="p4"><span class="s1">Displays the current execution status of the task. While a task is running it will display the elapsed time and network/file transfer activity. If an error occurs during task execution it will be reported here.</span></p>
<p class="p5"><span class="s1">Detail Pane - Bottom</span></p>
<p class="p4"><span class="s1">The detail mode buttons below the pane determine the browser contents.</span></p>
<p class="p5"><span class="s1">Hide</span></p>
<p class="p4"><span class="s1">Hides the detail panel.</span></p>
<p class="p5"><span class="s1">Task History</span></p>
<p class="p4"><span class="s1">Displays a history list of all past task execution requests. The history also retains the values of any task inputs.</span></p>
<p class="p5"><span class="s1">Task Script</span></p>
<p class="p2"><span class="s1">Displays the script associated with the selected task. The script will only be visible to trusted users.</span></p>
<p class="p3"><span class="s1">Sidebar - Left</span></p>
<p class="p4"><span class="s1">The sidebar displays a list of available instances of KosmicTask. You may hide or reveal the view using the <b>Sidebar</b> toolbar button.</span></p>
<p class="p5"><span class="s1">Home</span></p>
<p class="p4"><span class="s1">Represents the instance of KosmicTask on your local machine. It should always be available.</span></p>
<p class="p5"><span class="s1">Shared</span></p>
<p class="p4"><span class="s1">Lists the instances of KosmicTask available on the network. Local network instances will be discovered automatically. You may also connect manually to external networks.</span></p>
<p class="p27"><span class="s1">Getting Started</span></p>
<p class="p4"><span class="s1">KosmicTask uses a publishing idiom to control who has access to particular tasks. When a new task is created it is initially accessible only to trusted users. To make a task available to all users it must be published.</span></p>
<p class="p4"><span class="s1">KosmicTask operates in three different modes, selectable via the task mode control in the tool bar.</span></p>
<p class="p5"><span class="s1">Public Task Mode</span></p>
<p class="p4"><span class="s1">Allows access to published tasks. By default all instances of KosmicTask, both local and remote, can access public tasks. This is the default task mode.</span></p>
<p class="p5"><span class="s1">Trusted User Task Mode</span></p>
<p class="p4"><span class="s1">In order to access all tasks, on either a local or remote instance of KosmicTask, select the trusted user task mode. KosmicTask prompts for a valid username and password and on successful authentication provides access to all tasks.</span></p>
<p class="p5"><span class="s1">Configuration Mode</span></p>
<p class="p2"><span class="s1">In order to create, edit, delete, publish and unpublish tasks select the configuration task mode. As in the case of the trusted user mode you will be required to authenticate.</span></p>
<p class="p3"><span class="s1">Running a Task</span></p>
<p class="p4"><span class="s1">Select a task from the browser.</span></p>
<p class="p4"><span class="s1">If the task has inputs they will be displayed below the task name in the left task view. Enter any required values.</span></p>
<p class="p4"><span class="s1">Click the run toolbar button or select menu item <b>Task - Run</b> (command-R).</span></p>
<p class="p4"><span class="s1">The task will execute and the results will be displayed in the right task pane.</span></p>
<p class="p2"><span class="s1">The task may be paused or stopped prematurely as required.</span></p>
<p class="p3"><span class="s1">Viewing Task Results</span></p>
<p class="p4"><span class="s1">The results for a task will be displayed in the right hand task view. Results may be displayed in a number of different formats using the navigation bar format controls:</span></p>
<p class="p4"><span class="s4"><b>Document</b></span><span class="s1">. Displays results as a document. A popup control enables formatting as text, XML, or plist.</span></p>
<p class="p4"><span class="s4"><b>Icon</b></span><span class="s1">. Displays a representative image of file results. A QuickLook preview will often be available.</span></p>
<p class="p4"><span class="s4"><b>List.</b></span><span class="s1"> Displays results as a hierarchical list.</span></p>
<p class="p4"><span class="s4"><b>Script</b></span><span class="s1">. Displays results as returned by the script.</span></p>
<p class="p2"><span class="s1">It may not be possible to display some or all of a particular result set in every format. KosmicTask will display whatever portion of the results are compatible with the selected format.</span></p>
<p class="p3"><span class="s1">Saving Task Results</span></p>
<p class="p4"><span class="s1">Results may be saved to disk or sent directly to another application. Select the gear icon in the bottom left corner below the results view. Alternatively right (or ctrl-left) click in the results view to display the results menu.</span></p>
<p class="p4"><span class="s4"><b>Save Result</b></span><span class="s1">. Save the result text as plain text, PDF, RTF, property list or XML.</span></p>
<p class="p4"><span class="s4"><b>Save Result Files</b></span><span class="s1">. Save any files returned by the task.</span></p>
<p class="p4"><span class="s4"><b>Send Result To</b></span><span class="s1">. Send the result text to either Excel, Mail, Pages, TextEdit or Word.</span></p>
<p class="p2"><span class="s1">These results processing features are implemented as a series of extensible plug-ins.</span></p>
<p class="p3"><span class="s1">Publishing a Task</span></p>
<p class="p4"><span class="s1">You may publish a task to make it visible to all users or un-publish it to restrict access only to trusted users who can authenticate.</span></p>
<ul>
  <li class="li11"><span class="s1">Select the configuration task mode and enter password and user name if required.</span></li>
  <li class="li11"><span class="s1">In the task browser check the checkbox next to a task name to publish it.</span></li>
  <li class="li11"><span class="s1">Clear the checkbox to un-publish a task.</span></li>
  <li class="li11"><span class="s1">You may publish/un-publish groups of tasks using the Group table checkboxes.</span></li>
  <li class="li2"><span class="s1">Leave configuration mode by selecting either public or trusted user mode. You will be prompted to either save or discard your configuration changes.</span></li>
</ul>
<p class="p3"><span class="s1">Working with Tasks and Results</span></p>
<p class="p2"><span class="s1">KosmicTask provides flexible management of your tasks and results with the aim of providing an efficient workflow that makes it easy to manage multiple tasks and numerous result sets. Features are provided to enable the results of one task to be easily retrieved as input for another.</span></p>
<p class="p3"><span class="s1">Tasks</span></p>
<p class="p4"><span class="s1">A task runs within a tabbed instance of the task pane. You may run multiple tasks at once, either locally or remotely, and each task will run in its own tabbed task pane. Each tab also maintains a history of the tasks that were run within it and the results that were returned.</span></p>
<p class="p4"><span class="s1">When a task is selected in the task browser it will replace the task in the current task view except in the following cases:</span></p>
<p class="p4"><span class="s4"><b>Task already exists in another view</b></span><span class="s1">. The existing task will be selected.</span></p>
<p class="p19"><span class="s1"><b>Current task view is running a task</b></span><span class="s2">. A new task view will be created.</span></p>
<p class="p4"><span class="s4"><b>Current task view is pinned</b></span><span class="s1">. Pinning prevents a task from being replaced. A new task view will be created.</span></p>
<p class="p2"><span class="s1">The above behaviour may be modified using the task browser context menu. Alternatively use <b>command-click</b> to open the task in a new tab and <b>option-click</b> to open in a separate task window. A task window is merely a detached instance of a task view. You may also detach a task view as a separate window using the task navigation bar.</span></p>
<p class="p3"><span class="s1">Results</span></p>
<p class="p4"><span class="s1">Many tasks will produce displayable results though some may not. In these cases an informational message will be displayed.</span></p>
<p class="p4"><span class="s1">KosmicTask includes an integrated file transfer capability that it makes it easy to return the contents of a file as a result.</span></p>
<p class="p4"><span class="s1">Results may consist of two types of data: <b>textual data</b> and <b>file data</b></span></p>
<p class="p5"><span class="s1">Text result type</span></p>
<p class="p4"><span class="s1">The task returns data that can de displayed as text. The script may have returned a string, number, alias, list or record. KosmicTask will attempt to display all the available data as text.</span></p>
<p class="p5"><span class="s1">File result type</span></p>
<p class="p4"><span class="s1">The task returns data that is to be interpreted as the contents of a file. KosmicTask will display an icon representing the file contents in its icon view and use QuickLook to display the actual contents if possible.</span></p>
<p class="p2"><span class="s1">A script may return a result that contains both textual data and file data. In addition the script may return multiple instances of file data representing multiple files and file types.</span></p>
<p class="p3"><span class="s1">Navigation Bars</span></p>
<p class="p4"><span class="s1">The navigation bars appears along the top of each task view. There is one for the input view and one for the results view.</span></p>
<p class="p28"><span class="s1">Input View Navigation Bar</span></p>
<p class="p29"><span class="s1"></span><br></p>
<p class="p4"><span class="s4"><b>Pin task</b></span><span class="s1">. Keep task permanently in view. Task cannot be replaced by another.</span></p>
<p class="p4"><span class="s4"><b>Detach task view as window</b></span><span class="s1">. Detach the task view tab (inputs and results) and display as a window.</span></p>
<p class="p4"><span class="s4"><b>Task name and list</b></span><span class="s1">. Name of the currently displayed task. Click to display list of all tasks that have been run in the view. Select <b>ready</b> to clear existing results.</span></p>
<p class="p4"><span class="s4"><b>Prev/next task</b></span><span class="s1">. Select previous/next task in task name list.</span></p>
<p class="p4"><span class="s4"><b>Match results to task</b></span><span class="s1">. Match displayed results to current task. Result list will be displayed in red if results do not match.</span></p>
<p class="p4"><span class="s4"><b>Task number and count</b></span><span class="s1">. The current position of the task within the task list and the total number of tasks run.</span></p>
<p class="p2"><span class="s4"><b>Drag thumb</b></span><span class="s1">. Task split view drag thumb.</span></p>
<p class="p12"><span class="s1">Results View Navigation Bar</span></p>
<p class="p29"><span class="s1"></span><br></p>
<p class="p4"><span class="s4"><b>Pin results to task</b></span><span class="s1">. When pinned the task and results always correspond. Un-pin to allow independent display of tab tasks and results. This is useful when using the results of one task as input to another.</span></p>
<p class="p4"><span class="s4"><b>Detach results as window</b></span><span class="s1">. Detach a copy of the task results view and display as a window</span></p>
<p class="p4"><span class="s4"><b>Task results name list</b></span><span class="s1">. Name of the currently displayed task results. Click to display list of all results that have been obtained in the view. Select ready to clear.</span></p>
<p class="p4"><span class="s4"><b>Prev/next results</b></span><span class="s1">. Select previous/next results in the list.</span></p>
<p class="p4"><span class="s4"><b>Match task to results</b></span><span class="s1">. Match displayed task to current results. Results list will be displayed in red if displayed task does not match displayed results.</span></p>
<p class="p4"><span class="s4"><b>Results number and count</b></span><span class="s1">. The current position of the results within the results list and the total number of results obtained.</span></p>
<p class="p4"><span class="s4"><b>Document</b></span><span class="s1">. Format results as a text document.</span></p>
<p class="p4"><span class="s4"><b>Icon</b></span><span class="s1">. Format results as icon or image. Only applies to files returned within the results. If a QuickLook preview of the files contents is available then it will be displayed. Otherwise a generic icon will be used.</span></p>
<p class="p4"><span class="s4"><b>List</b></span><span class="s1">. Format results as a hierarchical list.</span></p>
<p class="p2"><span class="s4"><b>Script</b></span><span class="s1">. Format results as they were returned by the script. This is useful if you want to incorporate the results directly into another script.</span></p>
<p class="p3"><span class="s1">Task Status View</span></p>
<p class="p4"><span class="s1">The task status view displays the progress of the task's execution. Each task will progress through several stages:</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s4"><b>Ready</b></span><span class="s1">. The task has yet to be run.</span></p>
<p class="p4"><span class="s4"><b>Started</b></span><span class="s1">. The task has been requested to run.</span></p>
<p class="p4"><span class="s4"><b>Sending</b></span><span class="s1">. The task request is being sent along with its input data. If the input contains file data then the contents of the file(s) are sent. Transfer progress is displayed.</span></p>
<p class="p4"><span class="s4"><b>Sent</b></span><span class="s1">. The task request was successfully sent and acknowledged.</span></p>
<p class="p4"><span class="s4"><b>Running</b></span><span class="s1">. The task is currently running.</span></p>
<p class="p4"><span class="s4"><b>Run (complete)</b></span><span class="s1">. The task has finished running and will send back its results.</span></p>
<p class="p4"><span class="s4"><b>Receiving</b></span><span class="s1">. The task response is being received along with any results data. If the results contain file data then the contents of the file(s) are sent. Transfer progress is displayed.</span></p>
<p class="p4"><span class="s4"><b>Received</b></span><span class="s1">. The task results have been received.</span></p>
<p class="p4"><span class="s4"><b>Processing</b></span><span class="s1">. The task results are being processed.</span></p>
<p class="p4"><span class="s4"><b>Processed</b></span><span class="s1">. The task results have been processed.</span></p>
<p class="p4"><span class="s4"><b>Finished</b></span><span class="s1">. The task has finished without errors.</span></p>
<p class="p2"><span class="s1">If an error is encountered then a warning status alert will be displayed and the task will be stopped. To find out more about the error condition open the </span><span class="s12">console</span><span class="s1"> using menu item <b>Window - Console</b> (or Command-L).</span></p>
<p class="p3"><span class="s1">Task History View</span></p>
<p class="p4"><span class="s1">The task history displays a list of all the tasks that have been requested on both local and remote machines.</span></p>
<ul>
  <li class="li11"><span class="s1">To run a previous task select it from the history list.</span></li>
  <li class="li11"><span class="s1">If the task has inputs they will also be retrieved from the history.</span></li>
  <li class="li11"><span class="s1">Results are not saved into the history.</span></li>
  <li class="li2"><span class="s1">Tasks that were requested on machines that are not currently available will display a greyed out icon</span></li>
</ul>
<p class="p3"><span class="s1">Task Script View</span></p>
<p class="p4"><span class="s1">The task script view displays the actual script text that will be executed for a given task.</span></p>
<ul>
  <li class="li11"><span class="s1">Script text will only be displayed for trusted users. Enter </span><span class="s12">trusted user task mode</span><span class="s1"> in order to enable script viewing.</span></li>
  <li class="li2"><span class="s1">Scripts are read only. To modify the script enter </span><span class="s12">configuration task mode</span><span class="s1"> and select <b>edit</b> from the toolbar.</span></li>
</ul>
<p class="p3"><span class="s1">Searching</span></p>
<p class="p4"><span class="s1">Spotlight powered task searching is available for both local and remote instances of KosmicTask. Enter a search term into the Search toolbar control and press <b>Enter</b> to begin the search. The browser pane will display the task search results view. To run a task select it from the search results.</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1">Search view options:</span></p>
<p class="p4"><span class="s4"><b>This Mac</b></span><span class="s1">. Search the local machine only.</span></p>
<p class="p4"><span class="s4"><b>Machine 1, Machine 2, ..</b></span><span class="s1">. Search a named remote machine.</span></p>
<p class="p4"><span class="s4"><b>Shared</b></span><span class="s1">. Search all remote machines.</span></p>
<p class="p4"><span class="s4"><b>Contents</b></span><span class="s1">. Search all the contents of the task.</span></p>
<p class="p4"><span class="s4"><b>Script</b></span><span class="s1">. Search for script keywords only in the task.</span></p>
<p class="p4"><span class="s1">The search facility depends upon Spotlight being enabled on all machines. Searching on Internet connected machines is fully supported.</span></p>
<p class="p2"><span class="s1">The returned search results always correspond to the prevailing task mode. So only publicly available task matches will be returned when public task mode is selected. If more matches are available in trusted user mode then a <b>+</b> will be appended to the reported number of search results found. So <b>0 Found +</b> means that 0 public task matches were found but that some matches were found for trusted user mode.</span></p>
<p class="p3"><span class="s1">Networking and Communications</span></p>
<p class="p4"><span class="s1">Tasks are utilised and managed on remote instances of KosmicTask in the same way as local tasks. The sidebar lists:</span></p>
<ul>
  <li class="li11"><span class="s1">All the currently reachable instances of KosmicTask.</span></li>
  <li class="li11"><span class="s1">The current task mode (displays task mode icon except for public mode which is left blank).</span></li>
  <li class="li11"><span class="s1">The number of available tasks (colour coded to the task mode).</span></li>
  <li class="li2"><span class="s1">Connectivity problems. Alert symbol displayed. See the application </span><span class="s12">console log</span><span class="s1"> for detail.</span></li>
</ul>
<p class="p3"><span class="s1">Managing Connections</span></p>
<p class="p4"><span class="s1">Bonjour is used to achieve automatic discovery of local network instances of KosmicTask. Should you wish to connect to a local instance that does not have Bonjour configured or to a remote IP or Internet based instance then click the + button at the foot of the sidebar.</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s4"><b>Connect to</b></span><span class="s1">. Domain name or IP address to connect to. Connection will only succeed if the target machine is accessible at the port specified below and is running a copy of KosmicTask.</span></p>
<p class="p4"><span class="s4"><b>Port number</b></span><span class="s1">. KosmicTask defaults to using registered TCP port number 7742.</span></p>
<p class="p4"><span class="s4"><b>Display name</b></span><span class="s1">. Friendly name for IP connections.</span></p>
<p class="p4"><span class="s4"><b>Secure connection (SSL)</b></span><span class="s1">. The connection uses secure transport. Selection must match setting on connection target machine.</span></p>
<p class="p4"><span class="s4"><b>Reconnect on start-up</b></span><span class="s1">. The manual connection will be reinstated on start-up if the connection is added to the favourites list.</span></p>
<p class="p4"><span class="s4"><b>Favorite Kosmic Task Locations</b></span><span class="s1">. A persistent list of favorite locations.</span></p>
<p class="p2"><span class="s1">To disconnect from a manually established connection click the - button at the foot of the sidebar</span></p>
<p class="p3"><span class="s1">Internet Sharing</span></p>
<p class="p4"><span class="s1">An integrated port mapper is included to facilitate easy access to KosmicTask from the Internet. By default Internet sharing is disabled. The current Internet sharing status is displayed in the bottom right hand corner of the application window.</span></p>
<p class="p4"><span class="s1">When enabling Internet sharing you should be aware that all public scripts will be available to any user who connects via the Internet. If in doubt about this un-publish all of your tasks so that users are forced to authenticate. Always ensure that SSL encryption is selected when enabling Internet sharing (see application Preferences - Security).</span></p>
<p class="p4"><span class="s1">To enable Internet sharing click the Internet status display or select the <b>Internet</b> tab in the preferences panel at <b>KosmicTask - Preferences</b>. Note that the automatic sharing facility requires a UPnP or NAT-PMP compliant router. In the absence of this a manual router configuration will be required in order to accept incoming external requests.</span></p>
<p class="p30"><span class="s1"></span><br></p>
<p class="p4"><span class="s4"><b>Allow other users to connect via the Internet</b></span><span class="s1">. Enable external users to connect via the Internet. Click <b>Start</b> to begin sharing and <b>Stop</b> to end. If the operation is successful the sharing indicator will turn green. Otherwise an error condition will be reported.</span></p>
<p class="p4"><span class="s4"><b>External port number</b></span><span class="s1">. The TCP port number on which the router should accept external connections. By default all instances of KosmicTask use this port for local and remote network communication.</span></p>
<p class="p4"><span class="s4"><b>External IP address</b></span><span class="s1">. The external IP address of your router. Remote KosmicTask users wishing to connect should enter this IP address into the <b>Connect to</b> field of the </span><span class="s12">connections panel</span><span class="s1">.</span></p>
<p class="p4"><span class="s4"><b>Gateway name</b></span><span class="s1">. Router/gateway name as reported by router.</span></p>
<p class="p4"><span class="s4"><b>Automatically start Internet sharing</b></span><span class="s1">. Internet sharing will start automatically whenever KosmicTask is launched. Defaults to off</span></p>
<p class="p2"><span class="s4"><b>Manual Router Configuration</b></span><span class="s1">. Consult your router documentation to determine how to open an external port (7742) and direct it to the local IP of your machine on port 7742. Should you need to obtain your local network IP address you can consult <b>System Preferences-Network</b> (select the connected interface - Airport, Built-in Ethernet etc).</span></p>
<p class="p3"><span class="s1">Security</span></p>
<p class="p4"><span class="s1">By default all communications to and from KosmicTask are encrypted using SSL (TLS v1) to ensure privacy. This applies to local, remote and Internet based communication. If the application is being used in a single user or trusted environment then the encryption can be disabled if performance/network throughput has to be maximised. A closed padlock icon in the top right of the application windows indicates that a secure connection is currently in use.</span></p>
<p class="p4"><span class="s1"><b>Note: </b>A KosmicTask hosted script has the capability to obtain data from many application and operating system sources. This data may be of a personal or sensitive nature. It is therefore important that the SSL encryption remains enabled so that data transmitted over public networks cannot be observed. Only disable the encryption if you are using KosmicTask in a private or secure network environment.</span></p>
<p class="p4"><span class="s1">Security settings can be found on the <b>Preferences - Security</b> tab.</span></p>
<p class="p31"><span class="s1"></span><br></p>
<p class="p32"><span class="s1"><b>Disclose your username to other KosmicTask users</b></span></p>
<p class="p33"><span class="s1">By default your user name will not be visible to other KosmicTask users in the sharing information browser view. You may optionally disclose your user name only to local users or to all users. When logging in to remote instances of KosmicTask a valid user name and password combination may be required.</span></p>
<p class="p32"><span class="s1"><b>Keep your information secure</b></span></p>
<p class="p33"><span class="s1">SSL encryption is enabled by default and is the recommended configuration.</span></p>
<p class="p32"><span class="s1"><b>Show SSL Certificate</b></span></p>
<p class="p33"><span class="s1">SSL encryption requires a digital certificate in order to establish a secure connection and to maintain the integrity of that connection. By default KosmicTask will generate a suitable self signed root certificate and store it in the Keychain for future use. The fact that the certificate reports "This root certificate is not trusted" is not indicative of an error or problem. It merely highlights the fact that the certificate is a self signed root and was not issued by a root authority such as Thawte, VeriSign or Comodo. KosmicTask uses the certificate solely to enable encryption not to establish a trust relationship.</span></p>
<p class="p32"><span class="s1"><b>Password Security</b></span></p>
<p class="p2"><span class="s1">All entered user passwords, for either the local or remote instances of KosmicTask, may be saved into the system Keychain for secure storage and easy retrieval. KosmicTask relies upon SSL encryption being enabled in order to maintain password security over the network. If you disable the default encryption then your password may be retrievable from the network data stream.</span></p>
<p class="p3"><span class="s1">Managing Tasks</span></p>
<p class="p4"><span class="s1">Enter </span><span class="s12">configuration mode</span><span class="s1"> in order to create, edit and manage tasks. You may configure and manage both local and remote instances of KosmicTask in the same manner.</span></p>
<p class="p4"><span class="s1">Configuration mode functionality:</span></p>
<ul>
  <li class="li11"><span class="s1">Publish a task</span></li>
  <li class="li11"><span class="s1">Un-publish a task</span></li>
  <li class="li11"><span class="s1">Create a task</span></li>
  <li class="li11"><span class="s1">Edit, compile and test a task</span></li>
  <li class="li11"><span class="s1">Duplicate a task</span></li>
  <li class="li11"><span class="s1">Delete a task</span></li>
  <li class="li11"><span class="s1">Manage task groups</span></li>
  <li class="li11"><span class="s1">Assign task ratings</span></li>
  <li class="li2"><span class="s1">Assign task labels</span></li>
</ul>
<p class="p3"><span class="s1">Task Types</span></p>
<p class="p4"><span class="s1">There are two types of tasks:</span></p>
<p class="p4"><span class="s4"><b>Applications Tasks</b></span><span class="s1">. Tasks provided by default and intended to serve as example material and as templates for user tasks. Application tasks cannot be directly edited or deleted. Duplicate an application task to create an editable user copy.</span></p>
<p class="p4"><span class="s4"><b>User Tasks</b></span><span class="s1">. User defined and created tasks.</span></p>
<p class="p2"><span class="s1">The task type icon precedes the task name in the task browser.</span></p>
<p class="p12"><span class="s1">Task Operations</span></p>
<p class="p30"><span class="s1"></span><br></p>
<p class="p4"><span class="s4"><b>Create a task</b></span><span class="s1">. Select <b>New</b> from the tool bar or menu item <b>File - New</b> (command-N). The </span><span class="s12">task edit window</span><span class="s1"> will open.</span></p>
<p class="p4"><span class="s4"><b>Edit a task</b></span><span class="s1">. Select <b>Edit</b> from the tool bar or menu item <b>File - Edit...</b> (command-E). The task edit window will open. A duplication prompt sheet will be displayed if an application task is selected for editing.</span></p>
<p class="p4"><span class="s4"><b>Duplicate a task</b></span><span class="s1">. Select <b>Duplicate</b> from the tool bar or menu item <b>File - Duplicate</b> (command-D). The Task edit window will open containing a mutable copy of the selected task.</span></p>
<p class="p2"><span class="s4"><b>Delete a task</b></span><span class="s1">. Select <b>Delete</b> from the tool bar or menu item <b>File - Duplicate</b> (command-delete).</span></p>
<p class="p3"><span class="s1">Task Names and Groups</span></p>
<p class="p4"><span class="s1">Tasks may be assigned to groups for easy management and browsing. To assign or modify the icon associated with a group right click on the group name and select <b>Group Icon...</b> from the context menu. Groups may be published and unpublished as a whole.</span></p>
<p class="p2"><span class="s1">Each task requires a name but there is no requirement that this name be unique throughout the application. When a task is duplicated an identifying tag is appended to the task name. The duplicated task name can be modified as required.</span></p>
<p class="p3"><span class="s1">Task Ratings and Labels</span></p>
<p class="p4"><span class="s1">Tasks may be rated and labelled to assist with classification and identification. Right click in the task browser to display the context menu.</span></p>
<p class="p4"><span class="s4"><b>Rating</b></span><span class="s1">. A value from none to 5 stars.</span></p>
<p class="p2"><span class="s4"><b>Label</b></span><span class="s1">. A finder style coloured label.</span></p>
<p class="p3"><span class="s1">How Task Scripting Works</span></p>
<p class="p4"><span class="s1">KosmicTask subdivides the process of creating and editing tasks into three different stages.</span></p>
<ul>
  <li class="li11"><span class="s1">Defining the task's configuration and parameters.</span></li>
  <li class="li11"><span class="s1">Editing and compiling the task.</span></li>
  <li class="li4"><span class="s1">Testing the task.</span></li>
</ul>
<p class="p2"><span class="s1">Once you have finished defining, editing and testing your task you will be prompted to save it, at which point it will be added to the task browser list. You can create, edit, compile and test tasks on both the local and remote machines.</span></p>
<p class="p3"><span class="s1">Defining the Task</span></p>
<p class="p4"><span class="s1">Create or edit an existing task. The </span><span class="s12">task edit window</span><span class="s1"> will open.</span></p>
<p class="p4"><span class="s1"><b>Task Detail</b>: the left hand view.</span></p>
<p class="p4"><span class="s1">Your task needs to have a name and it needs to belong to a group. Note that the task name does not have to be unique. You may also enter a short and long description for your task. This information will be visible to the user when the task is run. You may also enter additional information about the task's author.</span></p>
<p class="p4"><span class="s1"><b>Script Detail</b>: the right hand view.</span></p>
<p class="p4"><span class="s1">Each task has an associated script. When the task is run a routine (or handler) within the script is called. KosmicTask supports 4 handler definitions:</span></p>
<p class="p4"><span class="s4"><b>run script</b></span><span class="s1">. Calls the implicit run handler or explicit run handler of the form <b>on run</b>. This definition does not support parameters.</span></p>
<p class="p4"><span class="s4"><b>run script with parameters</b></span><span class="s1">. Calls the explicit run handler of the form <b>on run{}</b>. This definition supports optional parameters. Note the use of { }.</span></p>
<p class="p4"><span class="s4"><b>call default handler</b></span><span class="s1">. Calls the default application handler of the form <b>on kosmicTask()</b>. This definition supports optional parameters.</span></p>
<p class="p4"><span class="s4"><b>call user defined handler</b></span><span class="s1">. Calls a user defined handler. This definition supports optional parameters.</span></p>
<p class="p4"><span class="s1">Simple scripts, such as the following, may make use of the implicit run handler when no script parameters are required. In this case no actual entry handler is defined within the script and execution begins at the outermost statement.</span></p>
<p class="p15"><span class="s1">display dialog "Implicit run handler called"</span></p>
<p class="p4"><span class="s1">You may alternatively define an explicit run handler with optional arguments:</span></p>
<p class="p15"><span class="s1">on run{}<br>
????display dialog "Explicit run handler called"<br>
end run</span></p>
<p class="p4"><span class="s1">KosmicTask defaults to using a handler named <b>kosmicTask</b>. The use of this handler makes it explicit within the script where KosmicTask execution will begin.</span></p>
<p class="p15"><span class="s1">on kosmicTask()<br>
??display dialog "Default run handler called"<br>
end kosmicTask</span></p>
<p class="p4"><span class="s1">Lastly you may define a custom handler.</span></p>
<p class="p15"><span class="s1">on myHandler()<br>
????display dialog "Custom run handler called"<br>
end myHandler</span></p>
<p class="p4"><span class="s1">Some tasks do not require any additional user input. For example, a task to empty the trash may not need any additional input information. But a task that is going to merge two images together certainly will.</span></p>
<p class="p4"><span class="s1">To add or remove input parameters to your task select the + and - buttons.</span></p>
<p class="p4"><span class="s1">Each input requires a name and a description. Again, this information is used to provide feedback to the user when the task is run.</span></p>
<p class="p4"><span class="s1">Each input also requires a type. KosmicTask provides support for the following input parameter types:</span></p>
<ul>
  <li class="li11"><span class="s1">Text - sends text to your task.</span></li>
  <li class="li11"><span class="s1">Number - sends a number to your task.</span></li>
  <li class="li11"><span class="s1">Date - sends a date to your task.</span></li>
  <li class="li11"><span class="s1">List - select an item from a list and send it to your task.</span></li>
  <li class="li4"><span class="s1">File - select a file and send its content to your task.</span></li>
</ul>
<p class="p4"><span class="s1">You may add as many inputs of whatever type to your task as you required. Each input can be generally configured with an initial value. KosmicTask implements these inputs as loadable bundles so that different input types can be added as required.</span></p>
<p class="p4"><span class="s1">Once the task handler and parameters have been defined enter your script in the Edit Task Script view. In order for the script to be callable by the task it must contain the handler routine that you previously defined.</span></p>
<p class="p4"><span class="s1">Once you have edited you script text click the compile button. You should be aware that you can readily edit and compile your scripts from another networked machine. In such a case your script is sent over the network, compiled and the result returned. You do not need to target the remote machine in your script as the script will be executed remotely. Once the script is complete and compiles correctly you can test it in the Run Task view.</span></p>
<p class="p2"><span class="s1">Note that although you can run and test your task in the Run Task view like any other script it has not yet been saved and will not display in the task browser. To save the task select menu item <b>File - Save</b> (command-S) or close the edit window.</span></p>
<p class="p3"><span class="s1">Task Results</span></p>
<p class="p4"><span class="s1">Your task script may return one of the following AppleScript data types and KosmicTask will display it appropriately.</span></p>
<ul>
  <li class="li11"><span class="s1">Boolean</span></li>
  <li class="li11"><span class="s1">Integer</span></li>
  <li class="li11"><span class="s1">Real</span></li>
  <li class="li11"><span class="s1">Date</span></li>
  <li class="li11"><span class="s1">String</span></li>
  <li class="li11"><span class="s1">File</span></li>
  <li class="li11"><span class="s1">List</span></li>
  <li class="li4"><span class="s1">Record</span></li>
</ul>
<p class="p4"><span class="s1">If you need to return more than one value use either a list or record.</span></p>
<p class="p15"><span class="s1">return {message:"done", time:1.5}Returning the Contents of a File</span></p>
<p class="p4"><span class="s1">In some situations you may wish to return the actual contents of a file rather than a string data containing a file path name. This can be achieved by returning a record type containing an item named <b>kosmicFile</b>. So if you have a file whose path is stored as myFilePath you can simply return the contents of that file with:</span></p>
<p class="p15"><span class="s1">return { kosmicFile:myFilePath}</span></p>
<p class="p4"><span class="s1">If you want to return the contents of more than one file simply return a list of file paths:</span></p>
<p class="p15"><span class="s1">return { kosmicFile:{myFilePath, anotherFilePath}}</span></p>
<p class="p4"><span class="s1">If you want to return value data along with the file contents then simple define other record items:</span></p>
<p class="p17"><span class="s1">return { kosmicFile:{myFilePath, anotherFilePath}, info:"2 files"}</span></p>
<p class="p3"><span class="s1">Styling Results</span></p>
<p class="p4"><span class="s1">KosmicTask supports the styling of results using standard CSS properties and values. We identify the data to be styled using the <b>kosmicData</b> record name and define the CSS styling string using the <b>kosmicStyle</b> record name.</span></p>
<p class="p15"><span class="s1">return {kosmicData:"Make me big and red", kosmicStyle:"color:red;font-size:120%"}</span></p>
<p class="p4"><span class="s1">Which will result in:</span></p>
<p class="p34"><span class="s1">Make me big and red</span></p>
<p class="p4"><span class="s1">Styling can be applied to all data types. In the case of lists and records the styling will cascade down to any enclosed types unless it is overridden by another <b>kosmicStyle</b> item.</span></p>
<p class="p15"><span class="s1">set theRebel to {kosmicData:"Not me, I want to be red", kosmicStyle:"color:red"}<br>
<br>
set myResult to {"I want to be blue", "Me too", "True blue", theRebel}<br>
<br>
return {kosmicData:myResult, kosmicStyle:"color:blue"}</span></p>
<p class="p4"><span class="s1">Which will result in:</span></p>
<p class="p35"><span class="s1">I want to be blue</span></p>
<p class="p35"><span class="s1">Me too</span></p>
<p class="p35"><span class="s1">True blue</span></p>
<p class="p36"><span class="s1">Not me, I want to be red</span></p>
<p class="p2"><span class="s1">To view all tasks that use styling enter "kosmicStyle" into the application search field.</span></p>
<p class="p12"><span class="s1">CSS Styling Properties</span></p>
<p class="p37"><span class="s1">The following CSS properties and values are supported within <b>kosmicStyle</b> named value strings:</span></p>
<p class="p4"><span class="s4"><b>color, background-color</b></span><span class="s1">. named colors (white, black, aqua, blue, gray, green, fuchsia, lime, maroon, navy, olive, purple, red, silver, teal, yellow), color hex eg: #FFFFFF, color rgb eg: rgb(255,255,255)</span></p>
<p class="p19"><span class="s1"><b>font-size, line-height</b></span><span class="s2">. pt, px, em, %</span></p>
<p class="p4"><span class="s4"><b>font-weight</b></span><span class="s1">. normal, bold.</span></p>
<p class="p4"><span class="s4"><b>font-style</b></span><span class="s1">. normal, italic.</span></p>
<p class="p2"><span class="s4"><b>text-decoration</b></span><span class="s1">. none, underline.</span></p>
<p class="p3"><span class="s1">Creating and Editing Tasks</span></p>
<p class="p4"><span class="s1">Task edit window layout:</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1">The task edit window supports three different views as selected by the edit workflow control.</span></p>
<p class="p4"><span class="s4"><b>Configure Task</b></span><span class="s1">. Configure the task detail and define the script handler and any required input parameters.</span></p>
<p class="p4"><span class="s4"><b>Edit Task Script</b></span><span class="s1">. Edit and compile the task script.</span></p>
<p class="p4"><span class="s4"><b>Run Task</b></span><span class="s1">. Run and test the task.</span></p>
<p class="p38"><span class="s1"></span><br></p>
<p class="p3"><span class="s1">Configure Task Detail</span></p>
<p class="p4"><span class="s1">Configure task definition and descriptive information.</span></p>
<p class="p39"><span class="s1">Definition</span></p>
<ul>
  <li class="li11"><span class="s1"><b>Name</b>: the task name as displayed in the task browser.</span></li>
  <li class="li11"><span class="s1"><b>Type</b>: the script type. Currently AppleScript only.</span></li>
  <li class="li26"><span class="s1"><b>Group</b>: the task's container group. Select an existing group or enter a new group name.</span></li>
</ul>
<p class="p39"><span class="s1">Description</span></p>
<ul>
  <li class="li11"><span class="s1"><b>Short Description</b>: short description as displayed in task view.</span></li>
  <li class="li26"><span class="s1"><b>Long Description</b>: long description. Supports attributed text. Images may be dragged and dropped. Useful for more complex tasks were comprehensive instruction needs to be provided to the user.</span></li>
</ul>
<p class="p39"><span class="s1">Info</span></p>
<ul>
  <li class="li11"><span class="s1"><b>Author</b>: Task author.</span></li>
  <li class="li11"><span class="s1"><b>Note</b>: Author note. Original script source, references etc.</span></li>
  <li class="li11"><span class="s1"><b>Created</b>: Task created date.</span></li>
  <li class="li11"><span class="s1"><b>Modified</b>: Task modified date.</span></li>
  <li class="li26"><span class="s1"><b>Version</b>: Task version. Can increment automatically with each save.</span></li>
</ul>
<p class="p39"><span class="s1">Options</span></p>
<ul>
  <li class="li2"><span class="s1"><b>Task must complete in specified time</b>: Set task timeout. If task does not complete in specified time it will be automatically terminated.</span></li>
</ul>
<p class="p3"><span class="s1">Configure Script Detail</span></p>
<p class="p4"><span class="s1">Configure script handler and optional parameters.</span></p>
<p class="p39"><span class="s1">Script Handler</span></p>
<ul>
  <li class="li11"><span class="s1"><b>On run task</b>: the name of the script subroutine or handler to be called when the task is run.</span></li>
  <li class="li11"><span class="s1"><b>Script handler name</b>: the name selected above.</span></li>
  <li class="li11"><span class="s1"><b>Script parameters</b>: the number of parameters to be passed to the script.</span></li>
  <li class="li26"><span class="s1"><b>Copy</b>: copy the script name and parameter list. This can be pasted directly into the script.</span></li>
</ul>
<p class="p5"><span class="s1">Script Parameters</span></p>
<p class="p2"><span class="s1">A list of defined parameters, types and defaults. Use the <b>+</b> and <b>-</b> buttons to add and remove parameters. Parameters may also be deleted using the <b>x</b> button in the parameter title bar.</span></p>
<p class="p3"><span class="s1">Edit Task Script</span></p>
<p class="p4"><span class="s1">Edit task script window layout:</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s4"><b>Compile</b></span><span class="s1">. Compile the script. Scripts for remote machines will be dispatched for compilation on the remote machine.</span></p>
<p class="p4"><span class="s4"><b>Dictionary</b></span><span class="s1">. Display dictionaries for applications on the local machine. Dictionaries for remote machines are not available.</span></p>
<p class="p5"><span class="s1">Run Task</span></p>
<p class="p2"><span class="s1">A task view in which to run and test the task.</span></p>
<p class="p3"><span class="s1">Preferences, Feedback and the Console</span></p>
<p class="p4"><span class="s1">To display the preferences panel select the application menu item <b>KosmicTask - Preferences...</b></span></p>
<p class="p5"><span class="s1">General Preferences</span></p>
<p class="p4"><span class="s4"><b>Publish my tasks when I log in</b></span><span class="s1">. The KosmicTask server agent will start as soon as you log in so that your tasks become available over the network. The main KosmicTask application and window will not start.</span></p>
<p class="p4"><span class="s4"><b>Check for application updates at startup</b></span><span class="s1">. The application will check for updates at startup. If an update is found you will be prompted to install it. You may check for updates manually using the application menu item <b>KosmicTask - Check for Updates...</b></span></p>
<p class="p5"><span class="s1">Tabs Preferences</span></p>
<p class="p4"><span class="s4"><b>Command-click opens a task in a new tab</b></span><span class="s1">. Enables click opening of tasks in new tabs.</span></p>
<p class="p4"><span class="s4"><b>Alt-click opens a task in a new tab</b></span><span class="s1">. Enables click opening of tasks in new windows.</span></p>
<p class="p19"><span class="s1"><b>Confirm when closing multiple tabs</b></span><span class="s2">. Enable confirmation message.</span></p>
<p class="p2"><span class="s1">The Security and Internet preferences are discussed in the sections above</span><span class="s12">.</span></p>
<p class="p3"><span class="s1">Feedback and Support</span></p>
<p class="p4"><span class="s1">We welcome all feedback and comments with regard to KosmicTask. Good or bad, we would like to know!</span></p>
<p class="p4"><span class="s1">To display the feedback panel select the blue feedback icon in the top right hand corner of the title bar or select the application menu item <b>KosmicTask - Feedback and support...</b></span></p>
<p class="p4"><span class="s1">Using the feedback panel you can:</span></p>
<ul>
  <li class="li11"><span class="s1">Ask a support question.</span></li>
  <li class="li11"><span class="s1">Send us an application feature request.</span></li>
  <li class="li4"><span class="s1">Send us a bug report.</span></li>
</ul>
<p class="p2"><span class="s1">You may optionally include your email address if you require a reply. The feedback is sent directly to Mugginsoft and does not utilise email.</span></p>
<p class="p3"><span class="s1">The Console</span></p>
<p class="p4"><span class="s1">To display the console window select menu item <b>Window - Console</b> or keyboard shortcut <b>command-L</b>.</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s4"><b>Errors</b></span><span class="s1">. Displays a list of application errors including the error source and code. More information on a particular error may be available in the log.</span></p>
<p class="p4"><span class="s4"><b>Log</b></span><span class="s1">. Displays a real time log of informational, diagnostic and error messages relating to KosmicTask.</span></p>
<p class="p4"><span class="s4"><b>Clear</b></span><span class="s1">. Clears both the error list and the log.</span></p>
<p class="p2"><span class="s4"><b>Send</b></span><span class="s1">. Sends the contents of the console window to Mugginsoft support via email. Use this facility to report bugs and problems. Alternatively copy and paste the log contents into the </span><span class="s12">feedback panel</span><span class="s1">.</span></p>
<p class="p3"><span class="s1">Licensing</span></p>
<p class="p4"><span class="s1">To display the Licences panel click application menu item <b>KosmicTask</b> - <b>Licences</b>...</span></p>
<p class="p4"><span class="s1">KosmicTask ships with a default trial licence file that provides limited functionality for application appraisal purposes. A full licence must be installed to enable all application features.</span></p>
<p class="p4"><span class="s4"><b>Available Licences</b></span><span class="s1">. Lists the currently installed licences.</span></p>
<p class="p4"><span class="s4"><b>Licence Details</b></span><span class="s1">. Lists the information contained within the licence.</span></p>
<p class="p4"><span class="s4"><b>Buy Licences</b></span><span class="s1">. Buy licences from the Mugginsoft website.</span></p>
<p class="p4"><span class="s4"><b>Remove Licence</b></span><span class="s1">. Remove selected licence. If all full licences are removed the application will revert to trial functionality.</span></p>
<p class="p4"><span class="s4"><b>Add Licence</b></span><span class="s1">. Select a licence file to install it. KosmicTask licence files end with the extension .ktlic. Aternatively, you may install a licence by double clicking the licence file in the finder.</span></p>
<p class="p20"><br></p>
<p class="p40"><span class="s1">99</span></p>
<p class="p41"><span class="s1">KosmicTask Guide</span></p>
<p class="p42"><span class="s13">KosmicTask Guide</span><span class="s1">MugginsoftMugginsoftMugginsoft</span><span class="s14">mugginsoft</span></p>
<p class="p43"><span class="s1"></span><br></p>
<p class="p44"><span class="s1">MugginsoftMugginsoft</span></p>
</body>
</html>
