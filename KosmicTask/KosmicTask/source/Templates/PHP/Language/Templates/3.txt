<?php
#
# Created by {{ author }} on {% now | date_format: "dd MMM yyyy HH:mm:ss" %}
#
# Credits:
#
# Notes: 
#
# the number of task arguments is:
# $numArgs = $argc;
# or
# $numArgs = $_SERVER['argc'] - 1;
#
# task arguments are accessed as:
# $argv[1] .. $argv[$argc]
# or
# $_SERVER['argv'][1] .. $_SERVER['argv'][$numArgs]
#

try {
	# capture screen image to file
	# files create in the current directory will be deleted when the task ends
	$file="capture.png";
	
	# define command
	$command = 'screencapture';
	
	# log command
	fprintf(STDERR, "Running $command command...\n");
	
	# execute command
	system("$command -t png $file", $status);
	if ($status <> 0) {
		throw new Exception("Error running $command");
	}
	
	# return a YAML inline format dictionary with filename
	echo "--- {kosmicFile: $file, kosmicInfo: file returned}";

} catch(Exception $e) {
	# return error
	$error = $e->getMessage();
	echo "--- {kosmicError: '$error'}";
}

?>		